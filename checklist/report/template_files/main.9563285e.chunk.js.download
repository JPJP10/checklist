(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[7],{167:function(e,t,a){"use strict";var n=a(12),s=a(13),r=a(15),i=a(14),l=a(0),c=a(1),o=a.n(c),d=a(69),u=a(200),h=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(){window.MathJax&&window.MathJax.typeset&&window.MathJax.typeset()}},{key:"render",value:function(){var e=this.props,t=e.githubRepo,a=e.paper,n=e.thumbnail,s=e.displayProceeding,r=e.mainAuthorFullName,i=new Date(a.publishedDate),c=i.getDate(),h=i.toLocaleString("default",{month:"short"}),b=i.getFullYear(),j="".concat(c," ").concat(h," ").concat(b);return Object(l.jsxs)("div",{className:"pgr-card paper-github-repo item w-100 mb-0",children:[Object(l.jsx)(d.a,{lg:3,className:"item-image-col",children:"video"===n.type?Object(l.jsx)("iframe",{title:"video",width:"100%",src:n.source,frameBorder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0}):Object(l.jsx)("a",{href:a.link,children:Object(l.jsx)("div",{className:"item-image",style:{backgroundImage:"url('".concat(n.source,"')")}})})}),Object(l.jsx)(d.a,{lg:9,className:"item-col",children:Object(l.jsxs)(u.a,{children:[Object(l.jsxs)(d.a,{lg:9,className:"item-content",children:[Object(l.jsx)("h1",{children:Object(l.jsx)("a",{href:a.link,children:a.title})}),Object(l.jsxs)("p",{className:"author-section",style:{paddingTop:"2px"},children:[s&&a.proceeding&&Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("span",{className:"item-conference-link",children:Object(l.jsx)("a",{href:a.proceeding.link,children:a.proceeding.name})})}),r&&Object(l.jsxs)(l.Fragment,{children:[s&&a.proceeding&&Object(l.jsx)(l.Fragment,{children:" \u2022 "}),Object(l.jsxs)("span",{className:"author-name-text",children:[r.split(" ").pop()," et al"]})]}),t&&Object(l.jsxs)(l.Fragment,{children:[" ","\u2022"," ",Object(l.jsx)("span",{className:"item-github-link",children:Object(l.jsx)("a",{href:t.link,style:{fontSize:"13px"},children:t.fullName})}),t.frameworkImageUrl&&Object(l.jsxs)(l.Fragment,{children:[" ","\u2022"," ",Object(l.jsx)("span",{children:Object(l.jsx)("img",{src:t.frameworkImageUrl,alt:"framework"})})]})]})]}),Object(l.jsx)("p",{className:"item-strip-abstract",children:a.shortDescription}),a.bestRank&&Object(l.jsx)("div",{className:"sota",children:Object(l.jsxs)("p",{children:["\xa0",1===a.bestRank.rank?Object(l.jsx)(l.Fragment,{children:"Ranked #1 on"}):Object(l.jsxs)(l.Fragment,{children:["Ranked #",a.bestRank.rank," on"]}),"\xa0",Object(l.jsxs)("a",{href:a.bestRank.benchmark.url,children:[a.bestRank.benchmark.name,"on ",a.bestRank.dataset]}),"\xa0",a.bestRank.description]})}),Object(l.jsx)("p",{children:a.tasks&&a.tasks.map((function(e){return Object(l.jsxs)(o.a.Fragment,{children:[Object(l.jsx)("a",{href:e.url,children:Object(l.jsxs)("span",{className:"badge badge-primary",children:[Object(l.jsx)("img",{style:{marginRight:"0px"},src:e.thumbnail}),Object(l.jsx)("span",{children:e.name})]})})," "]},e.slug)}))})]}),Object(l.jsxs)(d.a,{lg:3,className:"item-interact text-center",children:[Object(l.jsxs)("div",{className:"entity-stars",children:[t?Object(l.jsxs)("span",{className:"badge badge-secondary",children:[Object(l.jsx)("ion-icon",{name:"star"})," ",t.stars.toLocaleString()]}):Object(l.jsx)("span",{className:"badge badge-secondary",style:{border:"none",backgroundColor:"transparent"},children:"\xa0"}),j&&Object(l.jsx)("div",{className:"stars-accumulated text-center",children:j})]}),Object(l.jsxs)("div",{className:"entity",style:{marginBottom:"20px"},children:[Object(l.jsxs)("a",{href:a.link,className:"badge badge-light",children:[Object(l.jsx)("ion-icon",{name:"document"})," Paper"]}),Object(l.jsx)("br",{}),Object(l.jsxs)("a",{href:a.link+"#code",className:"badge badge-dark ".concat(t?"":"badge-nocode"),children:[Object(l.jsx)("ion-icon",{name:t?"logo-github":"add"})," ",t?" Code":"Add Code"]})]})]})]})})]})}}]),a}(o.a.Component);h.defaultProps={displayProceeding:!1},t.a=h},208:function(e,t,a){},209:function(e,t,a){!function(){window.$=window.jQuery=a(70);var e=a(210);a(211),a(157),a(212),a(213),a(214),a(215),a(216),a(218),window.Sentry=a(202),window.Highcharts=a(154),a(219)(window.Highcharts),window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}};var t=document.createElement("script");t.src="https://delta-assets.paperswithcode.com/static/js/mathjax/tex-chtml.js",t.onload=function(){window.MathJax.typeset()},document.head.appendChild(t),e.option({resizeDuration:0,fadeDuration:400}),window.frontend={ReactDOM:a(17),React:a(1),AuthorPage:a(361).default,RecentChangesPage:a(359).default,ReviewPage:a(360).default,EditPaperPage:a(279).default,SotaPage:a(358).default},a(357),window.run_after_frontend_loaded=window.run_after_frontend_loaded||[],window.run_after_frontend_loaded.forEach((function(e){return e()}))}()},279:function(e,t,a){"use strict";a.r(t),a.d(t,"ImageUploadWithPreview",(function(){return q}));var n=a(74),s=a(21),r=a(5),i=a(8),l=a(12),c=a(13),o=a(15),d=a(14),u=a(0),h=a(19),b=a.n(h),j=a(1),p=a.n(j),m=a(105),f=a.n(m),g=a(44),v=a(22),O=a(200),x=a(69),y=a(37),w=a(153),k=a(54),N=a(65),C=a(87),_=a(150),S=a(16),D=a(9),R=a.n(D),M=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={loading:!0,isSaving:!1,isDirty:!1,paper:{},authorPapers:[],filledRepo:"",filledAuthor:null,filledPapers:null,filledUsername:null,filledEmail:null,filledPassword:null,filledPasswordConfirmation:null,canAttachDatasets:!1,register:!1,loggedIn:!1,error:null},e.fetchPaper=function(){var t=e.props.paperSlug;e.setState({loading:!0},(function(){return b.a.get("/api/v0/papers",{params:{slug:t}}).then((function(t){e.setState({loading:!1,isDirty:!1,paper:t.data,filledRepo:t.data.officialGithubrepo?t.data.officialGithubrepo.link:"",filledAuthor:t.data.authors.length?t.data.authors[0].id:null,canAttachDatasets:t.data.canAttachDatasets})}))}))},e.fetchMe=function(){b.a.get("/api/v0/me").then((function(t){e.setState({loggedIn:t.data.loggedIn})}))},e.loadingScreen=function(){return Object(u.jsx)("div",{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(u.jsx)("p",{className:"text-center",children:Object(u.jsx)("span",{className:"spinner-border text-primary",style:{width:"4rem",height:"4rem"}})})})},e.fetchAuthorPapers=function(){var t=e.state.filledAuthor;e.setState({loading:!0},(function(){b.a.get("/api/v0/papers/by-author/",{params:{author_id:t}}).then((function(t){e.setState({loading:!1,authorPapers:t.data,filledPapers:new Set(t.data.map((function(e){return e.id}))),screen:"selectPapersScreen"})}))}))},e.editRepo=function(t){var a=e.state,n=a.filledRepo,s=a.paper;e.setState({isSaving:!0},(function(){b.a.post("/api/v0/papers/add-official-implementation/",{paper_id:s.id,implementation:n}).then((function(a){e.setState({isSaving:!1,error:null},(function(){t.push("edited-official-implementation"),e.fetchPaper()}))})).catch((function(t){t.response&&400===t.response.status?e.setState({isSaving:!1,error:t.response.data.error}):e.setState({isSaving:!1,screen:"errorScreen"})}))}))},e.removeRepo=function(t){var a=e.state.paper;e.setState({loading:!0},(function(){b.a.post("/api/v0/papers/remove-official-implementation/",{paper_id:a.id}).then((function(a){e.setState({loading:!1,error:null},(function(){t.push("removed-official-implementation"),e.fetchPaper()}))})).catch((function(t){t.response&&400===t.response.status?e.setState({loading:!1,error:t.response.data.error}):e.setState({loading:!1,screen:"errorScreen"})}))}))},e.errorScreen=function(){e.state.paper;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Error"}),Object(u.jsx)("p",{children:"We encountered an unexpected error and our team is investigating the problem. Please try again later."})]})},e.successScreen=function(){var t=e.state.paper;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Success"}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:Object(u.jsx)("a",{href:t.link,className:"badge badge-metadata clickable",children:"See Paper"})})})]})},e.claimPapers=function(){var t=e.state,a=t.filledAuthor,n=t.filledPapers,s=t.filledUsername,r=t.filledEmail,l=t.filledPassword,c=t.filledPasswordConfirmation,o=t.register;e.setState({loading:!0},(function(){b.a.post("/api/v0/papers/claim/",{author_id:a,paper_ids:Object(i.a)(n),username:s,email:r,password:l,password_confirmation:c,register:o}).then((function(t){e.setState({loading:!1,screen:"successScreen"})}))}))},e.loginAndRegisterScreen=function(){var t=e.state.register;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Create Account"}),Object(u.jsx)("p",{children:"Your PwC account can be used to:"}),Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"Manage code for your papers on arXiv"}),Object(u.jsx)("li",{children:"Manage your results published on benchmarks"})]}),Object(u.jsx)("p",{children:"To complete the process, register below."}),Object(u.jsx)(O.a,{className:"justify-content-md-center mt-4",children:Object(u.jsxs)(x.a,{md:8,children:[Object(u.jsxs)(y.a.Group,{children:[Object(u.jsx)(y.a.Label,{children:"Username"}),Object(u.jsx)(y.a.Control,{type:"text",maxLength:"150",required:!0,onChange:function(t){return e.setState({filledUsername:t.target.value})}})]}),t&&Object(u.jsxs)(y.a.Group,{children:[Object(u.jsx)(y.a.Label,{children:"Email"}),Object(u.jsx)(y.a.Control,{type:"email",maxLength:"254",required:!0,onChange:function(t){return e.setState({filledEmail:t.target.value})}})]}),Object(u.jsxs)(y.a.Group,{children:[Object(u.jsx)(y.a.Label,{children:"Password"}),Object(u.jsx)(y.a.Control,{type:"password",required:!0,onChange:function(t){return e.setState({filledPassword:t.target.value})}})]}),t&&Object(u.jsxs)(y.a.Group,{children:[Object(u.jsx)(y.a.Label,{children:"Confirm Password"}),Object(u.jsx)(y.a.Control,{type:"password",required:!0,onChange:function(t){return e.setState({filledPasswordConfirmation:t.target.value})}})]}),Object(u.jsxs)("div",{className:"mt-5 text-center",children:[Object(u.jsx)("span",{className:"badge badge-metadata clickable mr-2",onClick:e.claimPapers,children:t?"Sign Up":"Log In"}),"or",Object(u.jsx)("span",{className:"text-primary clickable ml-2",style:{textDecoration:"underline"},onClick:function(){return e.setState({register:!t})},children:t?"login with existing account":"register a new account"})]})]})})]})},e.togglePaper=function(t){var a=e.state.filledPapers,n=parseInt(t.getAttribute("data-paper-id"));t.checked?a.add(n):a.delete(n),e.setState({filledPapers:new Set(Object(i.a)(a))})},e.selectPapersScreen=function(){var t=e.state,a=t.authorPapers,n=t.filledPapers,s=t.loggedIn;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Select Papers"}),Object(u.jsx)("p",{children:"Are these papers yours? Untick if we've matched incorrectly."}),Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{children:"TITLE"}),Object(u.jsx)("th",{className:"text-center",children:"YEAR"}),Object(u.jsx)("th",{className:"text-center"})]}),a.map((function(t){return Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[Object(u.jsx)("a",{href:t.link,children:t.title}),Object(u.jsx)("br",{}),Object(u.jsx)("span",{className:"author-span",children:e.intersperse(t.authors.map((function(e){return Object(u.jsx)("a",{href:e.link,children:e.fullName},e.id)}))," \u2022 ")})]}),Object(u.jsx)("td",{className:"text-center",children:t.year}),Object(u.jsx)("td",{className:"text-center",children:Object(u.jsx)("input",{type:"checkbox","data-paper-id":t.id,checked:n.has(t.id),onChange:function(t){return e.togglePaper(t.target)}})})]},t.id)}))]})}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:Object(u.jsx)("span",{onClick:s?e.claimPapers:function(){return e.setState({screen:"loginAndRegisterScreen"})},className:"badge badge-metadata clickable",children:"Claim My Papers"})})})]})},e.claimPageScreen=function(){var t=e.state.paper;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Claim Page"}),Object(u.jsx)("p",{children:"Which author are you?"}),Object(u.jsx)("select",{className:"code-input",name:"authors",id:"authors",onChange:function(t){return e.setState({filledAuthor:t.target.value})},children:t.authors.filter((function(e){return e.isPlaceholder})).map((function(e){return Object(u.jsx)("option",{value:e.id,children:e.fullName},e.id)}))}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:Object(u.jsx)("span",{onClick:e.fetchAuthorPapers,className:"badge badge-metadata clickable",children:"That's Me!"})})})]})},e.codeEditedScreen=function(){var t,a=e.state,n=a.paper,s=a.canAttachDatasets;return t=s?Object(u.jsx)(g.b,{to:"attach-datasets",className:"badge badge-metadata clickable",children:"Attach Datasets"}):Object(u.jsx)("a",{href:n.link,className:"badge badge-metadata clickable",children:"View Paper"}),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Code Attached"}),Object(u.jsxs)("p",{children:[s?"":"Done. ","Official code now shows on ",Object(u.jsx)("a",{href:n.link,target:"_blank",children:"Papers with Code"})," and on ",Object(u.jsx)("a",{href:"https://arxiv.org/abs/"+n.arxiv_id,target:"_blank",children:"arXiv"}),"."]}),s&&Object(u.jsx)("p",{children:"As a next step, you can link datasets introduced and used in your paper."}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:t})})]})},e.datasetsEditedScreen=function(){var t=e.state.paper;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"\ud83c\udf89 Datasets Updated"}),Object(u.jsxs)("p",{children:["Done. You can now see the datasets on ",Object(u.jsx)("a",{href:"".concat(t.link,"#datasets"),children:"Papers with Code"})," and also on ",Object(u.jsx)("a",{href:"https://arxiv.org/abs/"+t.arxiv_id,children:"arXiv"}),"."]}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:Object(u.jsx)("a",{href:t.link,className:"badge badge-metadata clickable",children:"View Paper"})})})]})},e.codeRemovedScreen=function(){var t,a=e.state,n=a.paper,s=a.canAttachDatasets;return t=s?Object(u.jsx)(g.b,{to:"attach-datasets",className:"badge badge-metadata clickable",children:"Attach Datasets"}):Object(u.jsx)("a",{href:n.link,className:"badge badge-metadata clickable",children:"View Paper"}),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Official code removed"}),Object(u.jsxs)("p",{children:["Done. We've removed the official code, you can see your paper on ",Object(u.jsx)("a",{href:n.link,children:"Papers with Code"})," and also on ",Object(u.jsx)("a",{href:"https://arxiv.org/abs/"+n.arxiv_id,children:"arXiv"}),"."]}),s&&Object(u.jsx)("p",{children:"As a next step, you can link datasets introduced and used in your paper."}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:t})})]})},e.welcomeScreen=function(){var t=e.state,a=t.paper,n=t.canAttachDatasets,s=0!==a.mentionedDatasets.length||0!==a.introducedDatasets.length;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("h1",{children:["Link Your Code ",n?" & Datasets":""]}),Object(u.jsxs)("p",{children:["Link code",n?" and datasets":""," to your paper so it shows to readers on arXiv. This is the open data record of your paper:"]}),Object(u.jsxs)("div",{className:"row status-paper",children:[Object(u.jsx)("div",{className:"col-lg-4 status-paper-image",children:Object(u.jsx)("a",{href:a.link,children:"video"===a.thumbnail.type?Object(u.jsx)("iframe",{width:"100%",src:a.thumbnail.source,frameBorder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0}):Object(u.jsx)("img",{src:a.thumbnail.source})})}),Object(u.jsx)("div",{className:"col-lg-8 status-paper-description",children:Object(u.jsxs)("div",{className:"row",children:[Object(u.jsx)("h1",{children:Object(u.jsx)("a",{href:a.link,children:a.title})}),Object(u.jsx)("span",{className:"author-span",children:e.intersperse(a.authors.map((function(e){return Object(u.jsx)("a",{href:e.link,children:e.fullName},e.id)}))," \u2022 ")}),Object(u.jsxs)("div",{className:"artefact-links",children:[Object(u.jsxs)("a",{href:a.link,className:"badge badge-artefact badge-paper",target:"_blank",children:[Object(u.jsx)("ion-icon",{name:"document"})," Paper"]}),Object(u.jsxs)("a",{href:a.link+"#code",target:"_blank",className:"badge badge-artefact ".concat(a.officialGithubrepo?"":"badge-artefact-disabled"," badge-code"),children:[Object(u.jsx)("ion-icon",{name:"logo-github"})," Code"]}),n&&Object(u.jsxs)("a",{href:a.link+"#datasets",target:"_blank",className:"badge badge-artefact ".concat(s?"":"badge-artefact-disabled"," badge-datasets"),children:[Object(u.jsx)("ion-icon",{name:"images-outline"})," Datasets"]}),Object(u.jsxs)("a",{href:a.link+"#evaluation",className:"badge badge-artefact ".concat(a.hasResults?"":"badge-artefact-disabled"," badge-results"),target:"_blank",children:[Object(u.jsx)("ion-icon",{name:"barcode-outline"})," Results"]})]})]})})]}),a.officialGithubrepo&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("p",{children:"Our records have the following official repository. If it is incorrect you can change it."}),Object(u.jsxs)("div",{className:"code-preview",children:[Object(u.jsx)("ion-icon",{name:"logo-".concat(a.officialGithubrepo.hosting)}),Object(u.jsx)("a",{href:a.officialGithubrepo.link,children:a.officialGithubrepo.link})]})]}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:a.officialGithubrepo?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(g.b,{to:"/edit_paper/".concat(a.slug,"/edit-official-implementation"),className:"badge badge-metadata",id:"arxiv-change-code",children:"Change Repo"}),n&&Object(u.jsx)(g.b,{to:"/edit_paper/".concat(a.slug,"/attach-datasets"),className:"badge badge-metadata clickable",children:"Link Datasets"})]}):Object(u.jsxs)(g.b,{to:"/edit_paper/".concat(a.slug,"/edit-official-implementation"),className:"badge badge-metadata",id:"arxiv-add-code",children:["Add Code ",n&&Object(u.jsx)(u.Fragment,{children:"& Datasets"})]})})})]})},e.onUnload=function(t){var a=e.state,n=a.isDirty,s=a.screen;if(n&&"errorScreen"!==s)return t.preventDefault(),t.returnValue="Do you want to discard unsaved changes?"},e}return Object(c.a)(a,[{key:"intersperse",value:function(e,t){return 0===e.length?[]:e.slice(1).reduce((function(e,a,n){return e.concat([t,a])}),[e[0]])}},{key:"componentDidMount",value:function(){b.a.defaults.headers.common["X-CSRFToken"]=this.props.csrfToken,this.fetchPaper(),this.fetchMe(),window.addEventListener("beforeunload",this.onUnload)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.onUnload)}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.screen,n=e.paper,s=e.error,r=e.isSaving,i=e.canAttachDatasets;if(t)return this.loadingScreen();if("errorScreen"===a)return this.errorScreen();var l,c=[{title:"Your Paper",path:"/edit_paper/".concat(n.slug),icon:Object(u.jsx)("ion-icon",{name:"document"})},{title:"Official Code",path:"/edit_paper/".concat(n.slug,"/edit-official-implementation"),icon:Object(u.jsx)("ion-icon",{name:"code-outline"})}];return i&&(c.push({title:"Datasets",path:"/edit_paper/".concat(n.slug,"/attach-datasets"),icon:Object(u.jsx)("ion-icon",{name:"images-outline"})}),l=[Object(u.jsxs)(v.a,{path:"/edit_paper/:paperId/attach-datasets",children:[Object(u.jsx)(T,{activeStep:3,steps:c}),Object(u.jsx)(J,{paper:n,error:s,page:this,introduced:!0},"attach-datasets")]}),Object(u.jsxs)(v.a,{path:"/edit_paper/:paperId/attached-datasets",children:[Object(u.jsx)(T,{activeStep:3,steps:c}),this.datasetsEditedScreen()]})]),Object(u.jsx)(g.a,{children:Object(u.jsx)(x.a,{lg:8,className:"edit-paper",children:Object(u.jsx)("div",{className:"edit-paper-box",children:Object(u.jsxs)(v.c,{children:[Object(u.jsxs)(v.a,{path:"/edit_paper/:paperId/edit-official-implementation",children:[i&&Object(u.jsx)(T,{activeStep:2,steps:c}),Object(u.jsx)(E,{paper:n,error:s,page:this,isSaving:r,canAttachDatasets:i})]}),Object(u.jsxs)(v.a,{path:"/edit_paper/:paperId/edited-official-implementation",children:[i&&Object(u.jsx)(T,{activeStep:2,steps:c}),this.codeEditedScreen()]}),Object(u.jsxs)(v.a,{path:"/edit_paper/:paperId/removed-official-implementation",children:[i&&Object(u.jsx)(T,{activeStep:2,steps:c}),this.codeRemovedScreen()]}),l,Object(u.jsxs)(v.a,{path:"/edit_paper/:paperId",children:[i&&Object(u.jsx)(T,{activeStep:1,steps:c}),this.welcomeScreen()]})]})})})})}}]),a}(p.a.Component);function T(e){var t=e.activeStep,a=e.steps,n=100/a.length,s=100-n,r=s*(t-1)/(a.length-1);return Object(u.jsxs)("div",{className:"d-flex justify-content-around mb-4",style:{position:"relative"},children:[Object(u.jsx)("div",{className:"edit-paper-step-bar",style:{width:"".concat(s,"%"),height:"4px",left:"".concat(n/2,"%"),position:"absolute",top:"21px",zIndex:-2}}),Object(u.jsx)("div",{className:"edit-paper-step-bar active",style:{width:"".concat(r,"%"),height:"4px",left:"".concat(n/2,"%"),position:"absolute",top:"21px",zIndex:-1}}),a.map((function(e,a){var s=e.title,r=e.path,i=e.icon,l=a+1===t?"active":a<t?"done":"";return Object(u.jsxs)(g.b,{to:r,className:"edit-paper-step ".concat(l),style:{width:"".concat(n,"%")},children:[Object(u.jsx)("span",{className:"bullet",children:i}),Object(u.jsxs)("span",{className:"step-title",children:[a+1,". ",s]})]},a)}))]})}var I=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).inputRef=p.a.createRef(),n}return Object(c.a)(a,[{key:"onChange",value:function(e){var t=this.props.onChange;t(e)}},{key:"componentDidMount",value:function(){var e=this;$(this.inputRef.current).datepicker({format:"yyyy-mm-dd",autoclose:!0}).on("changeDate",(function(t){e.onChange(t.target.value)})).on("hide",(function(t){e.onChange(t.format())}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.value,n=t.error,s=void 0===n?null:n,r=t.placeholder,i=void 0===r?null:r;return Object(u.jsx)("input",{ref:this.inputRef,className:"form-control ".concat(s?"is-invalid":""),value:a,onChange:function(t){return e.onChange(t.target.value)},type:"text",placeholder:i,style:{width:"100%",fontSize:"14px",height:"30px",backgroundColor:"#fff"}})}}]),a}(p.a.Component);function E(e){var t=e.paper,a=e.error,n=e.page,s=e.isSaving,r=e.canAttachDatasets,i=Object(v.f)();return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{style:{opacity:s?.5:null},children:[Object(u.jsx)("h1",{children:"Link Your Code"}),Object(u.jsx)("p",{children:"Paste your GitHub/GitLab/BitBucket repository below and you're all set. This will mark this repository as the official repository for your paper."}),Object(u.jsxs)("div",{className:"author-code",children:[Object(u.jsxs)("div",{className:"row",children:[Object(u.jsx)("div",{className:"col-md-3 github-text",children:"Repository URL"}),Object(u.jsx)("div",{className:"col-md-9",children:Object(u.jsx)("input",{defaultValue:t.officialGithubrepo?t.officialGithubrepo.link:"",onChange:function(e){return n.setState({filledRepo:e.target.value})},onKeyPress:function(e){"Enter"===e.key&&n.editRepo(i)},name:"q",className:"form-control code-input ".concat(a?"is-invalid":""),id:"arxiv-add-code-input",type:"text",placeholder:"e.g. http://www.github.com/name/resnet"})})]}),Object(u.jsxs)("div",{className:"row",children:[Object(u.jsx)("div",{className:"col-md-3"}),Object(u.jsxs)("div",{className:"col-md-9 invalid-feedback d-block",children:[a,"\xa0"]})]})]}),Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsxs)("div",{className:"col-lg-12 text-center",children:[Object(u.jsx)("div",{children:Object(u.jsx)("span",{onClick:function(){return n.editRepo(i)},className:"badge badge-metadata clickable",id:"arxiv-add-code-attach-button",children:"Attach Code"})}),t.officialGithubrepo&&Object(u.jsxs)("div",{className:"remove-code-div",children:["or\xa0",Object(u.jsx)("span",{onClick:function(){return n.removeRepo(i)},className:"remove-code-link clickable",id:"arxiv-remove-official-code",children:"Remove the official repository"})]}),r&&Object(u.jsx)("div",{className:"skip-code-step",children:Object(u.jsx)(g.b,{to:"attach-datasets",className:"clickable",children:"skip this step"})})]})})]}),s&&n.loadingScreen()]})}var P=function(e){var t,a=e.data,n=a.name,s=a.fullName,r=a.image,i=a.icon,l=a.description,c=a.url,o=a.isNew,d=s!==n&&""!==s?"".concat(n," (").concat(s,")"):n;t=r?Object(u.jsx)("img",{src:r,style:{width:"40px",height:"40px"}}):Object(u.jsx)("div",{style:{width:"40px",height:"40px"},children:Object(u.jsx)("i",{className:"fad fa-".concat(i," dataset-img-icon"),style:{color:"#00b16c"}})});var h=o?Object(u.jsx)(f.a,{children:l}):l;return Object(u.jsxs)("div",{className:"media",children:[Object(u.jsx)("div",{className:"mr-3",children:t}),Object(u.jsxs)("div",{className:"media-body",children:[Object(u.jsx)("a",{href:c,target:c&&"#"===c[0]?null:"_blank",className:"name",style:{fontSize:"14px",color:"#333"},children:d}),Object(u.jsx)("div",{style:{height:"16px",overflowY:"hidden",color:"#888",fontWeight:"normal"},children:h})]})]})},A=function(e){var t,a,n=e.dataset,s=n.name,r=n.fullName,i=n.image,l=n.icon,c=n.description,o=n.isNew,d=e.editPrompt,h=void 0===d?null:d;t=""!==s?Object(u.jsx)("span",{className:"dataset-name",children:r!==s&&""!==r?"".concat(s," (").concat(r,")"):s}):Object(u.jsx)("span",{className:"dataset-name dataset-name-placeholder",children:"New Dataset"}),a=i?Object(u.jsx)("img",{className:"dataset-image",src:i}):Object(u.jsx)("div",{className:"dataset-image",children:Object(u.jsx)("i",{className:"fad fa-".concat(l," dataset-img-icon")})});var b=o?Object(u.jsx)(f.a,{children:c}):c;return Object(u.jsxs)("div",{className:"media basic-dataset-card",children:[Object(u.jsx)("div",{className:"mr-3",children:a}),Object(u.jsxs)("div",{className:"media-body",children:[t,Object(u.jsx)("div",{className:"dataset-description",children:b}),h]})]})},L=function(e){var t=e.data;return Object(u.jsx)(S.f.Option,Object(r.a)(Object(r.a)({},e),{},{children:Object(u.jsx)(A,{dataset:t})}))},q=function(e){var t=Object(j.useState)(e.url),a=Object(s.a)(t,2),n=a[0],r=a[1],i=Object(j.useState)(e.url),l=Object(s.a)(i,2),c=l[0],o=l[1],d=p.a.useRef(null);Object(j.useEffect)((function(){if("string"!==typeof n){if(n){var t=URL.createObjectURL(n);return o(t),function(){return URL.revokeObjectURL(t)}}o(e.initialImage)}else o(n)}),[n]);var h=p.a.useRef(!0);e.onChange&&Object(j.useEffect)((function(){h.current?h.current=!1:e.onChange(n,c)}),[c]);return Object(u.jsxs)("div",{className:"upload-image-preview",style:{position:"relative",textAlign:"center",overflow:"hidden"},children:[Object(u.jsx)("input",{type:"file",ref:d,onChange:function(e){e.target.files&&0!==e.target.files.length?r(e.target.files[0]):r(void 0)},style:{display:"none"}}),c&&Object(u.jsx)("img",{style:{width:"120px",height:"120px",objectFit:"cover"},src:c}),Object(u.jsxs)("button",{className:"edit-preview-button",style:{},onClick:function(e){d.current.click()},children:[Object(u.jsx)("i",{className:"fas fa-edit"}),"\xa0Edit Image"]})]})},F=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.url,a=e.isMulti,s=e.forwardParams,i=e.value,l=e.onChange,c=Object(n.a)(e,["url","isMulti","forwardParams","value","onChange"]);return Object(u.jsx)(C.a,Object(r.a)(Object(r.a)({loadOptions:function(e,a,n){var r=n.page;return b.a.get(t,{params:{q:e,page:r,forward:s}}).then((function(e){return{options:e.data.results.map((function(e){return{value:e.id,label:e.text}})),hasMore:e.data.pagination.more,additional:{page:r+1}}}))},value:i,onChange:l,isMulti:a,additional:{page:1}},c),{},{isClearable:!1,components:{IndicatorSeparator:null,DropdownIndicator:null},className:"react-dal-select",debounceTimeout:75,styles:{valueContainer:function(e){return Object(r.a)(Object(r.a)({},e),{},{padding:"0px"})},input:function(e){return Object(r.a)(Object(r.a)({},e),{},{padding:"0px",margin:"0px 2px"})},control:function(e){return Object(r.a)(Object(r.a)({},e),{},{minHeight:"30px",border:"1px solid #ddd",backgroundColor:"#fff"})},multiValue:function(e,t){return t.data.hasOwnProperty("isFixed")&&t.data.isFixed?Object(r.a)(Object(r.a)({},e),{},{backgroundColor:"#f9f9f9",border:"1px solid #ddd"}):e},multiValueRemove:function(e,t){return t.data.hasOwnProperty("isFixed")&&t.data.isFixed?Object(r.a)(Object(r.a)({},e),{},{display:"none"}):e}}}))}}]),a}(p.a.Component);F.defaultProps={isMulti:!1,forwardParams:{}};var B=function(e){var t=e.label,a=e.children,n=e.optional,s=void 0===n||n,r=e.icon,i=e.error,l=void 0===i?null:i,c=s?t:Object(u.jsxs)(u.Fragment,{children:[t,"*"]}),o=Object(u.jsxs)("div",{className:"inline-form-error",style:{fontSize:"14px",color:"#dc3545"},children:[null!=l?l:null,"\xa0"]});return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{style:{fontSize:"14px",color:"#495057"},children:[r&&Object(u.jsxs)(u.Fragment,{children:[r,"\xa0"]}),c]}),a,o]})},U=function(e){var t,a=e.label,n=e.value,s=e.onChange,r=e.className,i=void 0===r?"":r,l=e.error,c=void 0===l?null:l,o=e.multiline,d=void 0!==o&&o,h=e.optional,b=void 0===h||h,j=e.icon,p=void 0===j?null:j,m=e.placeholder,f=void 0===m?"edit":m,g=d?"textarea":"input",v={width:"100%",fontSize:"14px",height:d?null:"30px",backgroundColor:"#fff"},O=d?8:null;return t=Object(u.jsx)(g,{className:"form-control ".concat(c?"is-invalid":""),type:"text",value:n,style:v,onChange:function(e){return s(e.target.value)},placeholder:f,rows:O}),d&&(t=Object(u.jsx)("div",{children:t})),Object(u.jsx)("div",{className:"mb-1 ".concat(i),children:Object(u.jsx)(B,{label:a,icon:p,optional:b,error:c,children:t})})},H=function(e){var t,a=e.paper,n=e.dataset,s=e.errors,i=e.introducedByIsEditable,l=function(t){e.onChange(Object(r.a)(Object(r.a)({},n),t))},c=function(e){return s.hasOwnProperty(e)?s[e]:null},o=Object(u.jsx)("a",{href:"/datasets/license",target:"_blank",className:"datasets-license-info",children:Object(u.jsx)("ion-icon",{name:"information-circle-outline"})});i&&(t=Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(B,{label:"First introduced by",icon:Object(u.jsx)("ion-icon",{name:"document-outline"}),error:c("introducedBy"),children:Object(u.jsx)(F,{url:"/sota/autocomplete/paper/",width:"200px",value:n.introducedBy,style:{width:"100%"},onChange:function(e){return l({introducedBy:e,introduced:e.value===a.id})}})})}));var d=c("image");return Object(u.jsxs)("div",{id:"new-dataset".concat(e.sectionId),className:"container",style:{padding:"8px",fontSize:"14px"},children:[Object(u.jsxs)("div",{className:"row mb-3",children:[Object(u.jsxs)("div",{className:"col-12 col-md-4",children:[Object(u.jsx)("div",{style:{border:"1px solid",borderColor:d?"#dc3545":"#ccc",borderRadius:"4px",padding:"3px"},children:Object(u.jsx)(q,{url:n.image,onChange:function(e,t){return l({image:t,imageFile:e})},initialImage:n.initialImage})}),Object(u.jsxs)("div",{className:"inline-form-error",style:{fontSize:"14px",color:"#dc3545"},children:[d||null,"\xa0"]})]}),Object(u.jsxs)("div",{className:"col-12 col-md-8",children:[Object(u.jsx)(U,{name:"name",label:"Name",value:n.name,optional:!1,error:c("name"),placeholder:"Dataset Name",onChange:function(e){return l({name:e,label:e})}}),Object(u.jsx)(U,{label:"Full Name",value:n.fullName,error:c("fullName"),onChange:function(e){return l({fullName:e})},placeholder:"Optional Full Name"})]})]}),Object(u.jsx)("div",{className:"row",children:Object(u.jsxs)("div",{className:"col-12",children:[Object(u.jsx)(U,{label:"Description",multiline:!0,value:n.description,optional:!1,error:c("description"),onChange:function(e){return l({description:e})}}),Object(u.jsxs)("div",{className:"row mb-1",children:[t,Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(B,{label:"Introduction date",icon:Object(u.jsx)("ion-icon",{name:"calendar-outline"}),error:c("introducedDate"),children:Object(u.jsx)(I,{value:n.introducedDate,onChange:function(e){return l({introducedDate:e})},error:c("introducedDate"),placeholder:"edit"})})})]}),Object(u.jsx)("div",{className:"row",children:Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(U,{label:"Homepage",value:n.homepageUrl,error:c("homepageUrl"),onChange:function(e){return l({homepageUrl:e})},icon:Object(u.jsx)("ion-icon",{name:"link-outline"})})})}),Object(u.jsxs)("div",{className:"row",children:[Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(U,{label:Object(u.jsxs)(u.Fragment,{children:["License",o]}),value:n.licenseName,error:c("licenseName"),onChange:function(e){return l({licenseName:e})},icon:Object(u.jsx)("i",{className:"fab fa-creative-commons-by"})})}),Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(U,{label:"URL to license terms",value:n.licenseUrl,error:c("licenseUrl"),onChange:function(e){return l({licenseUrl:e})}})})]}),Object(u.jsx)("div",{className:"row mb-1",children:Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(B,{label:"Modalities",icon:Object(u.jsx)("ion-icon",{name:"shapes-outline"}),error:c("modalities"),children:Object(u.jsx)(F,{url:"/dataset-collection-autocomplete/",isMulti:!0,width:"200px",value:n.modalities,onChange:function(e){return l({modalities:e})},forwardParams:{area_name:"Modalities"}})})})}),Object(u.jsx)("div",{className:"row mb-1",children:Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(B,{label:"Languages",icon:Object(u.jsx)("ion-icon",{name:"language-outline"}),error:c("languages"),children:Object(u.jsx)(F,{url:"/dataset-collection-autocomplete/",isMulti:!0,width:"200px",value:n.languages,onChange:function(e){return l({languages:e})},forwardParams:{area_name:"Languages"}})})})}),Object(u.jsx)("div",{className:"row mb-1",children:Object(u.jsx)("div",{className:"col-12 col-md-6",children:Object(u.jsx)(B,{label:"Tasks",icon:Object(u.jsx)("ion-icon",{name:"cog-outline"}),error:c("tasks"),children:Object(u.jsx)(F,{url:"/task-autocomplete/",isMulti:!0,width:"200px",value:n.tasks,onChange:function(e){return l({tasks:e})}})})})})]})})]})},V=Object(C.b)(_.a);function z(e){var t=p.a.useRef(null),a=e.getNewOptionData,i=e.datasets,l=e.onChange,c=e.onCreate,o=Object(j.useState)(1),d=Object(s.a)(o,2),h=d[0],m=d[1];return Object(u.jsx)("div",{children:Object(u.jsx)(V,{selectRef:t,SelectComponent:_.a,getNewOptionData:a,onCreateOption:function(e){var n=Object(r.a)(Object(r.a)({},a(e,e)),{},{value:-h,url:"#new-dataset".concat(-h)});c(n),m(h+1),t.current.select.blur()},formatCreateLabel:function(e){return Object(u.jsxs)(u.Fragment,{children:['Add a new dataset "',Object(u.jsx)("strong",{children:e}),'"']})},loadOptions:function(e,t,a){var s=a.page;return b.a.get("/detailed-dataset-autocomplete/",{params:{q:e,page:s,forward:{canonical_only:!0,disable_create_option:!0}}}).then((function(e){return{options:e.data.results.map((function(e){var t=e.id,a=e.text,s=e.full_name,i=e.image,l=Object(n.a)(e,["id","text","full_name","image"]);return Object(r.a)({id:t,value:t,label:a,fullName:s,image:i?"/".concat(i):null},l)})),hasMore:e.data.pagination.more,additional:{page:s+1}}}))},backspaceRemovesValue:!1,className:"react-datasets-select",classNamePrefix:"react-datasets-select",components:{DropdownIndicator:null,LoadingIndicator:null,MultiValueLabel:P,Option:L},styles:{multiValue:function(e,t){var a=t.data,n=a.introduced?"#f0f8ff":"#f9f9f9",s=a.introduced?"#c0e8ff":"#e0e0e0";return Object(r.a)(Object(r.a)({},e),{},{backgroundColor:n,borderColor:s})}},closeMenuOnSelect:!1,isClearable:!1,isMulti:!0,loadOptionsOnMenuOpen:!0,debounceTimeout:150,additional:{page:1},value:i,cacheUniqs:[h],onChange:l,placeholder:"Search for datasets..."})})}function G(e){var t=e.dataset,a=e.onChange,n=e.onRemove,i=e.paper,l=e.introducedByIsEditable,c=Object(j.useState)(t.id>=0),o=Object(s.a)(c,2),d=o[0],h=o[1],b=R.a.some(t.errors,(function(e,t){return null!=e&&e.length>0})),p=Object(u.jsxs)("div",{className:"container d-flex justify-content-between dataset-card-large",style:{padding:"8px",fontSize:"14px",cursor:"pointer",backgroundColor:b?"#fee":"#f9f9f9",borderRadius:d?"6px":"6px 6px 0px 0px"},onClick:function(){return h(!d)},children:[Object(u.jsx)(A,{dataset:Object(r.a)(Object(r.a)({},t),{},{isNew:!0}),editPrompt:Object(u.jsxs)("div",{style:{fontSize:"12px",color:"#666",textAlign:"right",display:"inline-block"},children:[Object(u.jsx)("i",{className:"fas fa-edit"}),"Edit"]})}),Object(u.jsx)("button",{onClick:function(e){e.stopPropagation(),n()},className:"btn btn-sm p-3",style:{width:"40px",textAlign:"center",fontSize:"18px",padding:"0px"},children:"\xd7"})]}),m=Object(u.jsx)(H,{sectionId:t.value,dataset:t,onChange:a,introducedByIsEditable:l,paper:i,errors:t.errors}),f=b?"#dc3545":"#ccc";return Object(u.jsxs)("div",{className:"mt-3 editable-dataset",style:{borderRadius:"6px",border:"1px solid ".concat(f),boxShadow:"1px 1px 8px #ddd"},children:[p,Object(u.jsx)(w.a,{in:!d,className:"editable-dataset-content",children:Object(u.jsxs)("div",{children:[Object(u.jsx)("hr",{className:"mt-0"}),m]})})]})}function W(e){var t,a=e.datasets,n=e.onChange,l=e.getNewOptionData,c=e.introducedByIsEditable,o=void 0===c||c,d=e.paper,h=void 0===d?null:d,b=e.initialIntroducedDate,p=void 0===b?null:b,m=e.disableCreation,f=void 0!==m&&m,g=function(e,t){var s=a||[],r=R.a.findIndex(s,{value:t});if(-1!==r){var l=Object(i.a)(s);l[r]=e,n(l)}},v=function(e){var t=a||[],s=R.a.findIndex(t,{value:e});-1!==s&&n([].concat(Object(i.a)(t.slice(0,s)),Object(i.a)(t.slice(s+1))))},O=Object(j.useState)(1),x=Object(s.a)(O,2),y=x[0],w=x[1],C=function(){var e=a||[],t=Object(r.a)(Object(r.a)({},l(null,"")),{},{value:-y});null!=p&&(t.introducedDate=p),n([].concat(Object(i.a)(e),[t])),w(y+1)},_=(a||[]).map((function(e){return Object(u.jsx)(G,{dataset:e,onChange:function(t){return g(t,e.value)},onRemove:function(){return S(e.value)},introducedByIsEditable:o,paper:h},e.value)})),S=function(e){var t=R.a.find(a||[],{value:e});"undefined"!==typeof t&&(t.isNew&&function(e){var t=l(null,"");return null!=p&&(t.introducedDate=p),!R.a.isEqual(R.a.omit(e,"value","imageFile"),R.a.omit(t,"imageFile"))}(t)?(I(t),L(!0)):v(e))},D=Object(j.useState)({}),M=Object(s.a)(D,2),T=M[0],I=M[1],E=Object(j.useState)(!1),P=Object(s.a)(E,2),A=P[0],L=P[1];return f||(t=Object(u.jsx)("div",{style:{paddingTop:"4px"},children:Object(u.jsxs)("button",{onClick:function(){return C()},className:"btn btn-sm btn-outline-primary",children:[Object(u.jsx)("i",{className:"fas fa-plus-circle"}),"\xa0",a&&a.length>0?"Add more datasets":"Add a new dataset"]})})),Object(u.jsxs)(u.Fragment,{children:[_,Object(u.jsx)("div",{style:{display:"inline-block",paddingBottom:"15px",paddingTop:"15px",fontSize:"14px"},children:t}),Object(u.jsxs)(k.a,{show:A,onHide:function(){return L(!1)},centered:!0,children:[Object(u.jsx)(k.a.Header,{closeButton:!0,children:Object(u.jsxs)(k.a.Title,{children:["Are you sure you want to remove ",T.name?Object(u.jsx)("strong",{children:T.name}):"this dataset","?"]})}),Object(u.jsxs)(k.a.Body,{children:["The details you provided for ",T.name?T.name:"this dataset"," will be lost."]}),Object(u.jsxs)(k.a.Footer,{children:[Object(u.jsx)(N.a,{variant:"secondary",onClick:function(){return L(!1)},children:"Cancel"}),Object(u.jsx)(N.a,{variant:"primary",onClick:function(){return e=T.value,v(e),void L(!1);var e},children:"Remove"})]})]})]})}function J(e){var t=e.paper,a=(e.error,e.page),l=Object(v.f)(),c=Object(j.useState)(!1),o=Object(s.a)(c,2),d=o[0],h=o[1],m=Object(j.useState)(!1),f=Object(s.a)(m,2),g=f[0],O=f[1],x=p.a.useRef();p.a.useEffect((function(){var e=l.block((function(t,n){return!a.state.isDirty||(x.current=function(){e(),a.setState({isDirty:!1}),O(!1),"PUSH"===n?l.push(t):l.goBack()},O(!0),!1)}));return function(){e()}}),[]);var C,_=function(e){var t=e.id,a=e.image,s=e.introduced_by,i=e.introduced_date,l=e.homepage_url,c=e.license_name,o=e.license_url,d=e.modalities,u=e.languages,h=e.tasks,b=Object(n.a)(e,["id","image","introduced_by","introduced_date","homepage_url","license_name","license_url","modalities","languages","tasks"]);return Object(r.a)({value:t,id:t,isNew:!1,image:a?"/".concat(a):"/media/datasets/default.gif",initialImage:a?"/".concat(a):"/media/datasets/default.gif",introducedBy:{value:s.id,label:s.title},introducedDate:i,homepageUrl:l,licenseName:c,licenseUrl:o,modalities:d.map((function(e){return{value:e.id,label:e.name}})),languages:u.map((function(e){return{value:e.id,label:e.name}})),tasks:h.map((function(e){return{value:e.id,label:e.name,isFixed:e.locked}}))},b)},S=Object(j.useState)(t.introducedDatasets.map((function(e){return Object(r.a)({introduced:!0,errors:[]},e)})).map(_)),D=Object(s.a)(S,2),R=D[0],M=D[1],T=function(e){return a.setState({isDirty:!0},(function(){return M(e)}))},I=Object(j.useState)(t.mentionedDatasets.map((function(e){return Object(r.a)({introduced:!1},e)})).map(_)),E=Object(s.a)(I,2),P=E[0],A=E[1],L=Object(j.useState)([]),q=Object(s.a)(L,2),F=q[0],B=q[1],U=function(e){return a.setState({isDirty:!0},(function(){return B(e)}))},H=function(){var e=function(e,t){var a=new FormData;a.append("form-TOTAL_FORMS",e.length.toString()),a.append("form-INITIAL_FORMS",e.filter((function(e){return"undefined"!==typeof e.id})).length.toString()),a.append("form-MAX_NUM_FORMS",""),e.forEach((function(e,t){var n=e.id,s=e.name,r=e.fullName,i=e.description,l=e.introducedBy,c=e.introducedDate,o=e.homepageUrl,d=e.licenseName,u=e.licenseUrl,h=e.imageFile,b=e.modalities,j=e.languages,p=e.tasks,m="form-".concat(t,"-");"undefined"!==typeof n&&a.append(m+"id",n),a.append(m+"name",s),a.append(m+"full_name",r),a.append(m+"description",i),a.append(m+"paper",null!=l?l.value.toString():""),a.append(m+"introduced_date",c),a.append(m+"url",o),a.append(m+"license_name",d),a.append(m+"license_url",u),a.append(m+"image",h),(b||[]).forEach((function(e){var t=e.value;return a.append(m+"modalities",t)})),(j||[]).forEach((function(e){var t=e.value;return a.append(m+"languages",t)})),(p||[]).forEach((function(e){var t=e.value;return a.append(m+"tasks",t)}))}));var n=JSON.stringify((t||[]).map((function(e){return e.id})));return a.append("mentioned_datasets_ids",n),a}([].concat(Object(i.a)(J?R:[]),Object(i.a)(K?F:[])),K?P:[]);e.append("paper_id",t.id),h(!0),b.a.post("/api/v0/papers/attach-datasets/",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){a.setState({isDirty:!1}),l.push("attached-datasets"),a.fetchPaper()})).catch((function(e){if(e.response&&400===e.response.status)if("Validation errors"===e.response.data.error){var t=e.response.data.forms_errors.map((function(e){var t=e.name,a=e.__all__,s=e.full_name,i=e.license_name,l=e.license_url,c=e.url,o=e.paper,d=e.introduced_date,u=Object(n.a)(e,["name","__all__","full_name","license_name","license_url","url","paper","introduced_date"]);return"undefined"!==typeof a&&(t=["Repeated dataset Name."]),Object(r.a)({name:t,fullName:s,homepageUrl:c,introducedBy:o,introducedDate:d,licenseName:i,licenseUrl:l},u)}));J&&T(R.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{errors:t.shift()})}))),K&&U(F.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{errors:t.shift()})}))),h(!1)}else a.setState({loading:!1,error:e.response.data.error});else a.setState({loading:!1,screen:"errorScreen"})}))},V=Object(j.useState)(0!==t.introducedDatasets.length),G=Object(s.a)(V,2),J=G[0],Y=G[1],$=function(e){0===t.introducedDatasets.length||e||a.setState({isDirty:!0}),Y(e)},X=Object(j.useState)(0!==t.mentionedDatasets.length),Q=Object(s.a)(X,2),K=Q[0],Z=Q[1],ee=function(e){0===t.mentionedDatasets.length||e||a.setState({isDirty:!0}),Z(e)},te=function(e,t){return{label:t,name:t,isNew:!0,fullName:"",description:"Click to add a brief description of the dataset (Markdown and LaTeX enabled).\n\nProvide:\n\n* a high-level explanation of the dataset characteristics\n* explain motivations and summary of its content\n* potential use cases of the dataset\n",homepageUrl:"",licenseName:"",licenseUrl:"",introducedBy:null,introducedDate:"",introduced:!1,modalities:[],languages:[],tasks:[],image:"/media/datasets/default.gif",imageFile:null,initialImage:"/media/datasets/default.gif",errors:{}}},ae=Object(u.jsx)(w.a,{in:J,children:Object(u.jsx)("div",{children:Object(u.jsx)(W,{datasets:R,onChange:T,getNewOptionData:function(e,a){return Object(r.a)(Object(r.a)({},te(0,a)),{},{introducedBy:{value:t.id,label:t.title}})},introducedByIsEditable:!1,initialIntroducedDate:null!=t?t.published:null})})}),ne=Object(u.jsx)(w.a,{in:K,children:Object(u.jsxs)("div",{children:[Object(u.jsx)(z,{datasets:P,onChange:function(e){return a.setState({isDirty:!0},(function(){return A(e)}))},onCreate:function(e){return U([].concat(Object(i.a)(F),[e]))},getNewOptionData:te}),Object(u.jsx)(W,{datasets:F,onChange:U,getNewOptionData:te,disableCreation:!0,paper:t})]})});return d&&(C=a.loadingScreen()),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)(k.a,{show:g,onHide:function(){return O(!1)},centered:!0,children:[Object(u.jsx)(k.a.Header,{closeButton:!0,children:Object(u.jsx)(k.a.Title,{children:"Are you sure you want to leave this step?"})}),Object(u.jsx)(k.a.Body,{children:"Your changes from this step are not saved."}),Object(u.jsxs)(k.a.Footer,{children:[Object(u.jsx)(N.a,{variant:"secondary",onClick:function(){return O(!1)},children:"Cancel"}),Object(u.jsx)(N.a,{variant:"danger",onClick:function(){return x.current()},children:"Discard Changes"})]})]}),Object(u.jsxs)("div",{style:{opacity:d?.5:null},children:[Object(u.jsx)("h1",{children:"Link Datasets"}),Object(u.jsxs)("div",{className:"paper-page-edit-dataset-modal",children:[Object(u.jsx)("h5",{children:"1. Does your paper introduce a new dataset?"}),Object(u.jsxs)("div",{className:"pb-3",children:[Object(u.jsx)(y.a.Check,{className:"mr-5",inline:!0,label:"Yes",type:"radio",checked:J,onChange:function(){return $(!0)}}),Object(u.jsx)(y.a.Check,{inline:!0,label:"No",type:"radio",checked:!J,onChange:function(){return $(!1)}})]}),ae,Object(u.jsx)("h5",{className:"mt-4",children:"2. Does your paper use a dataset from another paper?"}),Object(u.jsxs)("div",{className:"pb-3",children:[Object(u.jsx)(y.a.Check,{className:"mr-5",inline:!0,label:"Yes",type:"radio",checked:K,onChange:function(){return ee(!0)}}),Object(u.jsx)(y.a.Check,{inline:!0,label:"No",type:"radio",checked:!K,onChange:function(){return ee(!1)}})]}),ne,Object(u.jsx)("div",{className:"row call-to-action",children:Object(u.jsx)("div",{className:"col-lg-12 text-center",children:Object(u.jsx)("span",{onClick:function(){return H()},className:"badge badge-metadata clickable",children:"Attach Datasets"})})})]})]}),C]})}t.default=M},357:function(e,t){window.$(document).ready((function(){if($("#official-pgr-form").length){var e=$("#official-pgr-ids"),t=$(".radios-version-element"),a=$(".checkboxes-version-element"),n=$("#official-pgr-multiple-switch"),s=$(".official-pgr-checkbox"),r=$(".official-pgr-radio");s.filter(":checked").length>1?i():l(),s.on("change",c),r.on("change",o),n.on("change",(function(e){return e.target.checked?i():l()}))}function i(){t.hide(),a.show(),n.prop("checked",!0),c()}function l(){t.show(),a.hide(),n.prop("checked",!1),o()}function c(){e.val(s.filter(":checked").map((function(e,t){return t.value})).get().join(","))}function o(){e.val(r.filter(":checked").val())}}))},358:function(e,t,a){"use strict";a.r(t);var n=a(5),s=a(26),r=a(12),i=a(13),l=a(15),c=a(14),o=a(0),d=a(1),u=a.n(d),h=a(17),b=a.n(h),j=a(21),p=a(18),m=a(8),f=a(73),g=a(37),v=u.a.lazy((function(){return Promise.all([a.e(1),a.e(15),a.e(4)]).then(a.bind(null,573))})),O=u.a.lazy((function(){return Promise.all([a.e(1),a.e(14),a.e(12)]).then(a.bind(null,578))}));function x(e){var t=e.row;if(0!==Object.keys(t.mlmodel).length){var a=t.mlmodeldetails?Object(o.jsxs)(o.Fragment,{children:[t.mlmodel_short,Object(o.jsx)("br",{}),Object(o.jsxs)("span",{className:"small",children:["(",t.mlmodeldetails,")"]})]}):t.mlmodel_short,n=null;null!==t.external_source_url?n=t.external_source_url:null!==t.mlmodel.url&&(n=t.mlmodel.url);var s=n?Object(o.jsx)("a",{href:n,children:a}):a;return Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"paper-title method-name",children:s})})}return t.paper.id&&t.method_details?Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"paper-title method-name",children:Object(o.jsxs)("a",{style:{fontSize:"1rem"},href:t.paper.url,children:[t.method_short,Object(o.jsx)("br",{}),Object(o.jsxs)("span",{className:"small",children:["(",t.method_details,")"]})]})})}):t.paper.id&&!t.method_details?Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"paper-title method-name",children:Object(o.jsx)("a",{style:{fontSize:"1rem"},href:t.paper.url,children:t.method_short})})}):!t.paper.id&&t.method_details?Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"paper-title method-name",children:Object(o.jsxs)("a",{style:{fontSize:"1rem"},href:t.paper.url,children:[t.method_short,Object(o.jsx)("br",{}),Object(o.jsxs)("span",{className:"small",children:["(",t.method_details,")"]})]})})}):Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"paper-title method-name",children:t.method_short})})}function y(e){var t=e.row;return t.paper.id?Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"meta-information",children:Object(o.jsx)("a",{href:t.paper.url,children:t.paper.title})})}):Object(o.jsx)("td",{})}var w=a(76),k=a.n(w),N=a(107),C=a(19),S=a.n(C),D=a(54),R=a(374),M=a(372),T=a(65),I=a(87),E=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={key:0,modalShow:!1,nextRow:null,showEdit:!1,showCreateTagForm:!1,createTagName:"",createTagColor:"#2771D3"},e.manageTags=function(){USER_IS_AUTHENTICATED?e.setState({modalShow:!0}):$("#loginModal").modal("show")},e.endManageTags=function(){e.setState({modalShow:!1})},e.deleteRowTag=function(t,a){S.a.delete("/api/internal/evaluation-table-row-tags/",{params:{row_id:t,tag_id:a}}),e.props.onDeleteRowTag&&e.props.onDeleteRowTag(t,a),e.setState({key:e.state.key+1})},e.linkRowTag=function(t,a){S.a.post("/api/internal/evaluation-table-row-tags/",{row_id:t,tag_id:a.id}),e.props.onLinkRowTag&&e.props.onLinkRowTag(t,a),e.setState({key:e.state.key+1})},e.createAndLinkRowTag=function(){var t=e.state,a=t.createTagName,n=t.createTagColor;S.a.post("/api/internal/tags/",{name:a,color:n}).then((function(t){e.linkRowTag(e.props.row.row_id,t.data)})),e.setState({showCreateTagForm:!1})},e.searchTag=function(){var t=Object(N.a)(k.a.mark((function t(a,n){var s,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.length/10+1,t.next=3,S.a.get("/api/internal/tags/search/",{params:{q:a,page:s}});case 3:return r=t.sent,t.abrupt("return",{options:r.data.results.filter((function(t){return!e.state.nextRow.tags.find((function(e){return e.id===t.id}))})).map((function(e){return{value:e,label:e.name}})),hasMore:r.data.has_more});case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.showEdit=function(){e.setState({showEdit:!0})},e.hideEdit=function(){e.setState({showCreateTagForm:!1,showEdit:!1})},e.openCreateTagForm=function(t){t.preventDefault(),e.setState({showCreateTagForm:!0})},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.setState({nextRow:this.props.row}),S.a.defaults.headers.common["X-CSRFToken"]=CSRF_TOKEN}},{key:"render",value:function(){var e=this,t=this.props,a=t.row,n=t.toggleTags,s=this.state,r=s.modalShow,i=s.nextRow,l=(s.showEdit,s.showCreateTagForm),c=s.createTagName,d=s.createTagColor,u=a.tags,h=this.props.tagEditEnabled?"show-edit":"",b=u.length?"":"show-edit-center";return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("td",{className:"sota-row-tags-cell text-center ".concat(h," ").concat(b),onMouseEnter:this.showEdit,onMouseLeave:this.hideEdit,children:[0!==u.length&&u.map((function(t){return Object(o.jsx)("span",{className:"badge sota-row-tags",style:{backgroundColor:t.color},onClick:function(){return n&&e.props.toggleTags(t.id)},children:t.name},t.id)})),Object(o.jsx)("span",{className:"edit-tags",onClick:function(){return e.manageTags()},children:Object(o.jsx)("ion-icon",{name:"add-circle-outline"})})]}),Object(o.jsxs)(D.a,{className:"sota-row-tags-modal",show:r,onHide:this.endManageTags,children:[Object(o.jsx)(D.a.Header,{closeButton:!0,children:Object(o.jsx)("h5",{className:"modal-title",children:"Manage tags"})}),Object(o.jsxs)(D.a.Body,{children:[i&&Object(o.jsx)(R.a,{className:"mb-3",children:i.tags.map((function(t){return Object(o.jsxs)(M.a,{className:"mr-2 mb-2",children:[Object(o.jsx)(T.a,{className:"text-nowrap",variant:"secondary",style:{backgroundColor:t.color,opacity:.7},children:t.name}),Object(o.jsx)(T.a,{variant:"secondary",onClick:function(){return e.deleteRowTag(i.row_id,t.id)},children:Object(o.jsx)("i",{className:"fa fa-trash-alt"})})]},t.id)}))}),!l&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h6",{className:"mb-3",children:"Link existing tag"}),Object(o.jsx)(I.a,{loadOptions:this.searchTag,onChange:function(t){var a=t.value;return e.linkRowTag(i.row_id,a)},className:"mb-3"},this.state.key)]}),!l&&Object(o.jsxs)("div",{className:"modal-help-text",children:["Not in the list?",Object(o.jsx)("br",{}),Object(o.jsxs)("a",{href:"add-tag",onClick:this.openCreateTagForm,children:[Object(o.jsx)("ion-icon",{name:"add"}),"Create a new tag"]})]}),l&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h6",{children:"Create new tag"}),Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)("div",{className:"col m-0 pt-0 pb-0 pl-3 pr-3",children:Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{className:"col-form-label",children:"Name:"}),Object(o.jsx)("input",{value:c,onChange:function(t){return e.setState({createTagName:t.target.value})},maxLength:"32",className:"textinput textInput form-control"})]})}),Object(o.jsx)("div",{className:"col m-0 pt-0 pb-0 pl-3 pr-3",children:Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{className:"col-form-label",children:"Color:"}),Object(o.jsx)("input",{value:d,onChange:function(t){return e.setState({createTagColor:t.target.value})},type:"color",className:"form-control"})]})})]}),Object(o.jsxs)("div",{className:"text-right",children:[Object(o.jsx)(T.a,{className:"border-0",variant:"secondary",onClick:function(){return e.setState({showCreateTagForm:!1})},children:"Cancel"})," ",Object(o.jsx)(T.a,{className:"border-0",variant:"primary",onClick:this.createAndLinkRowTag,children:"Create"})]})]})]})]})]})}}]),a}(u.a.Component);function P(e){var t=e.row;if(t.paper.id||null!==t.external_source_url){var a="";if(null!==t.external_source_url){var n=Object(o.jsx)("ion-icon",{name:"enter-outline"});(t.external_source_url.includes("eval.ai")||t.external_source_url.includes("evalai.cloudcv.org"))&&(n=Object(o.jsx)("img",{src:"/static/evalai-logo-single.png",height:"14",width:"14"})),a=Object(o.jsx)("a",{href:t.external_source_url,target:"_blank",children:n})}else a=null!==t.paper.review_url?Object(o.jsx)("a",{href:t.paper.review_url,target:"_blank",children:Object(o.jsx)("ion-icon",{name:"enter-outline"})}):Object(o.jsx)("a",{href:t.paper.url+"#results",target:"_blank",children:Object(o.jsx)("ion-icon",{name:"enter-outline"})});return Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"paper",children:a})})}return Object(o.jsx)("td",{})}function A(e){var t=e.row;return t.paper.code?Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"github",children:Object(o.jsx)("a",{href:t.paper.url+"#code",children:Object(o.jsx)("ion-icon",{name:"logo-github"})})})}):Object(o.jsx)("td",{})}var L=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=b.a.findDOMNode(this);b.a.unmountComponentAtNode(e),e.outerHTML=this.createComment()}},{key:"createComment",value:function(){var e=this.props.text;return this.props.trim&&(e=e.trim()),"\x3c!-- ".concat(e," --\x3e")}},{key:"render",value:function(){return Object(o.jsx)("td",{})}}]),a}(u.a.Component);function q(e){var t=e.row,a="",n=Object(o.jsx)("ion-icon",{name:"layers-outline"});if(null!==t.external_source_url)(t.external_source_url.includes("eval.ai")||t.external_source_url.includes("evalai.cloudcv.org"))&&(n=Object(o.jsx)("img",{src:"/static/evalai-logo-single.png",height:"14",width:"14"})),a=Object(o.jsx)("a",{href:t.external_source_url,target:"_blank",children:n});else{if(0===Object.keys(t.mlmodel).length||!t.mlmodel.url)return Object(o.jsx)("td",{});a=Object(o.jsx)("a",{href:t.mlmodel.url,children:n})}return Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"paper",children:a})})}L.defaultProps={trim:!0};var F=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={tagEditEnabled:!1},e.highligh=function(t){return e.props.highlight&&e.props.highlight.id===t.paper.id?"row-highlight":""},e.toggleEditVisibility=function(){e.setState({tagEditEnabled:!e.state.tagEditEnabled})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props.alwaysShowPaperColumn||_.some(this.props.data,"paper.title");return Object(o.jsx)("div",{className:"view-sota-table",children:Object(o.jsxs)("table",{className:"table-striped",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{style:{textAlign:"center"},children:"Rank"}),Object(o.jsx)("th",{style:{width:"30%"},children:"Model"}),this.props.metrics.map((function(t){return Object(o.jsx)("th",{className:"text-center",onClick:e.props.selectMetric.bind(null,t.name),children:Object(o.jsxs)("span",{className:"metric-column-header-text",style:{fontWeight:e.props.selectedMetric===t.name?"bold":""},children:[t.name,Object(o.jsx)("i",{className:"sort-arrow fas ".concat(e.props.selectedMetric===t.name?"metric-highest"===e.props.selectedMetricDirection?"fa-arrow-alt-up":"fa-arrow-alt-down":"")})]})},t.name)})),this.props.showUsesColumn&&Object(o.jsx)("th",{style:{textAlign:"center"},children:"Extra Training Data"}),t&&Object(o.jsx)("th",{style:{width:"38%"},children:"Paper"}),this.props.showCodeColumn&&Object(o.jsx)("th",{className:"text-center",children:"Code"}),this.props.showResultColumn&&Object(o.jsx)("th",{className:"text-center",children:"Result"}),this.props.showModelDetailsColumn&&Object(o.jsx)("th",{className:"text-center",children:"Details"}),Object(o.jsx)("th",{className:"text-center",children:"Year"}),this.props.showTagsColumn&&Object(o.jsxs)("th",{className:"text-center",children:["Tags",Object(o.jsx)("span",{className:"tags-header-edit",onClick:function(){return e.toggleEditVisibility()},children:Object(o.jsx)("i",{className:"fas fa-edit"})})]})]})}),Object(o.jsx)("tbody",{children:this.props.data.map((function(a,n){return Object(o.jsxs)("tr",{className:e.highligh(a),children:[Object(o.jsx)(L,{text:"".concat(a.row_id)}),Object(o.jsx)("td",{className:"text-center",children:n+1}),Object(o.jsx)(x,{row:a}),e.props.metrics.map((function(e){return Object(o.jsx)("td",{className:"metric-report text-center",children:a.metrics[e.name]},e.name)})),e.props.showUsesColumn&&Object(o.jsx)("td",{style:{textAlign:"center"},children:Object(o.jsx)("ion-icon",{name:a.uses_additional_data?"checkmark":"close"})}),t&&Object(o.jsx)(y,{row:a}),e.props.showCodeColumn&&Object(o.jsx)(A,{row:a}),e.props.showResultColumn&&Object(o.jsx)(P,{row:a}),e.props.showModelDetailsColumn&&Object(o.jsx)(q,{row:a}),Object(o.jsx)("td",{children:Object(o.jsx)("div",{className:"meta-information date",children:a.evaluation_date?new Date(a.evaluation_date).getFullYear():""})}),e.props.showTagsColumn&&Object(o.jsx)(E,{row:a,onDeleteRowTag:e.props.onDeleteRowTag,onLinkRowTag:e.props.onLinkRowTag,toggleTags:e.props.toggleTags,tagEditEnabled:e.state.tagEditEnabled})]},a.row_id)}))})]})})}}]),a}(u.a.Component);function B(){return Object(o.jsx)("div",{className:"text-center",children:Object(o.jsx)("img",{src:"/static/spin-1s-32px.gif"})})}var U=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var i;Object(r.a)(this,a),(i=t.call(this,e)).clearFilter=function(e){e.preventDefault(),i.setState({metric:i.props.tableMetrics[0].name,dimension:"date",filter:"all",tagFilter:new Set},(function(){i.updateData(),i.updateUrl()}))},i.highlightTag=function(e,t){$(".highcharts-point.tag-".concat(e)).css("fill","#0297b1")},i.unhighlightTag=function(e){$(".highcharts-point.tag-".concat(e)).css("fill","")},i.onDeleteRowTag=function(e,t){var a=i.props.tableData.find((function(t){return t.row_id===e})),n=a.tags.findIndex((function(e){return e.id===t}));a.tags.splice(n,1),i.updateData()},i.onLinkRowTag=function(e,t){var a=i.props.tableData.find((function(t){return t.row_id===e}));-1===a.tags.findIndex((function(e){return e.id===t.id}))&&a.tags.push(t),i.updateData()},i.toggleTagFilter=function(e){var t=i.state.tagFilter;t.has(e)?t.delete(e):t.add(e),i.setState({tagFilter:new Set(Object(m.a)(t))},(function(){i.updateData(),i.updateUrl()}))},i.showUsesAdditionalDataColumn=function(e){for(var t=0;t<e.length;t++)if(e[t].uses_additional_data)return!0;return!1},i.onConfigChange=function(e){var t=e.target,a=t.name,n=t.value;"metric"===a&&n===i.state.dimension?i.setState({metric:n,dimension:"date"},(function(){i.updateUrl(),i.updateData()})):i.setState(Object(s.a)({},a,n),(function(){"metric"!==a&&"dimension"!==a||i.updateUrl(a),i.updateData()}))};var l={all:i.convertChartData(e.chartData.all),no_additional_data:i.convertChartData(e.chartData.no_additional_data),uses_additional_data:i.convertChartData(e.chartData.uses_additional_data)},c=e.tableData.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{evaluationDateObject:e.evaluation_date&&new Date(e.evaluation_date)})})),o=new URLSearchParams(window.location.search),d=o.get("metric"),h=d&&e.tableMetrics.find((function(e){return e.name===d}))?d:e.tableMetrics[0].name,b=o.get("dimension"),j="date";b&&e.tableMetrics.find((function(e){return e.name===b}))&&b!==h&&(j=b),i.state={state:"view",chartData:l,tableMetrics:e.tableMetrics,tableData:c,saveSpinner:"off",showUsesColumn:i.showUsesAdditionalDataColumn(e.tableData),filter:"all",metric:h,metricDirection:i.getMetricDirection(e.tableMetrics[0].name),dimension:j,competition:"all",hasCompetition:e.hasCompetition,tagFilter:new Set,allTags:new Set};var g,v=Object(p.a)(i.props.tableData);try{for(v.s();!(g=v.n()).done;){var O,x=g.value,y=Object(p.a)(x.tags);try{for(y.s();!(O=y.n()).done;){var w=O.value;i.state.allTags.add(w.id)}}catch(D){y.e(D)}finally{y.f()}}}catch(D){v.e(D)}finally{v.f()}var k,N=o.get("tag_filter"),C=N?N.split(",").map((function(e){return parseInt(e)})):[],_=Object(p.a)(C);try{for(_.s();!(k=_.n()).done;){var S=k.value;i.state.tagFilter.add(S)}}catch(D){_.e(D)}finally{_.f()}return i.state.allTags.add(0),i.editTableRef=u.a.createRef(),i.state.filteredChartData=i.computeChartData(),i.state.filteredTableData=i.computeTableData(),i.selectMetric=i.selectMetric.bind(Object(f.a)(i)),i.updateData=i.updateData.bind(Object(f.a)(i)),i}return Object(i.a)(a,[{key:"selectMetric",value:function(e){this.setState({metric:e},this.updateData)}},{key:"getMetricDirection",value:function(e){return this.props.tableMetrics.find((function(t){return t.name===e})).is_loss?"metric-lowest":"metric-highest"}},{key:"convertChartData",value:function(e){return{yAxis:e.yAxis,data:{trend:Object(n.a)(Object(n.a)({},e.data.trend),{},{click:this.onClick,dataPoints:e.data.trend.dataPoints.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{x:new Date(e.x)})}))}),other:Object(n.a)(Object(n.a)({},e.data.other),{},{click:this.onClick,dataPoints:e.data.other.dataPoints.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{x:new Date(e.x)})}))})}}}},{key:"updateUrl",value:function(){var e={};this.state.metric!==this.props.tableMetrics[0].name&&(e.metric=this.state.metric),"date"!==this.state.dimension&&(e.dimension=this.state.dimension),this.state.tagFilter.size&&(e.tag_filter=Object(m.a)(this.state.tagFilter).join(","));var t=Object.entries(e).map((function(e){var t=Object(j.a)(e,2),a=t[0],n=t[1];return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(n))})).join("&");t=t?"?"+t:window.location.pathname,window.history.pushState("","",t)}},{key:"updateData",value:function(){this.setState({filteredChartData:this.computeChartData(),filteredTableData:this.computeTableData(),metricDirection:this.getMetricDirection(this.state.metric)})}},{key:"hasAnyFilter",value:function(){return"all"!==this.state.filter||this.state.metric!==this.props.tableMetrics[0].name||"date"!==this.state.dimension||0!==this.state.tagFilter.size}},{key:"filteredTableData",value:function(){var e=this.state,t=e.tableData,a=e.filter,n=e.tagFilter,s=e.allTags,r=e.competition,i=e.hasCompetition,l=e.metric,c=e.dimension;if(t=t.slice(),"all"!==a){var o="with-data"===a;t=t.filter((function(e){return e.uses_additional_data===o}))}return this.hasAnyFilter()&&(t=t.filter((function(e){var t=e.raw_metrics[l],a="date"===c?e.evaluationDateObject:e.raw_metrics[c];return t&&a}))),n.size&&n.size<s.size+1&&(t=t.filter((function(e){var t=new Set(Object(m.a)(e.tags.map((function(e){return e.id}))));return 0===t.size&&(t=new Set([0])),new Set(Object(m.a)(n).filter((function(e){return t.has(e)}))).size}))),i&&"published"===r&&(t=t.filter((function(e){return null!==e.paper.id}))),t}},{key:"sortedTableData",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.getMetricDirection(t),s="metric-lowest"===n?1:-1;a&&(s*=-1);var r="metric-highest"===n?-1/0:1/0;return Object(m.a)(e).sort((function(e,a){var n=e.raw_metrics[t];n=null!==n?n:r;var i=a.raw_metrics[t];return(n-(i=null!==i?i:r))*s}))}},{key:"computeTableData",value:function(){var e=this.state.metric,t=this.filteredTableData();return this.sortedTableData(t,e)}},{key:"computeChartData",value:function(){var e=this.state,t=e.metric,a=e.dimension,s=this.props.sotaColor,r=this.getMetricDirection(t),i=this.filteredTableData();"date"===a?i.sort((function(e,t){return e.evaluationDateObject-t.evaluationDateObject})):(i=this.sortedTableData(i,a,!0),a.includes("param")||i.reverse());var l={click:void 0,markerSize:10,showInLegend:!0,toolTipContent:"{name}: {y}",yValueFormatString:"#.#     %"},c={data:{other:Object(n.a)(Object(n.a)({},l),{},{color:"#ddd",name:"Other models",type:"scatter",dataPoints:[]}),trend:Object(n.a)(Object(n.a)({},l),{},{color:s,type:"line",dataPoints:[]})},yAxis:{title:t,includeZero:!1,gridColor:"#ddd"},xAxis:{title:"date"===a?"":a}};c.xAxis.type="date"===a?"datetime":"linear";var o="metric-highest"===r?"highest":"lowest";c.data.trend.name="Top 1 Accuracy"===t&&"metric-highest"===r?"State-of-the-art models":"Models with ".concat(o," ").concat(t),"date"!==a&&(c.data.trend.name="Pareto frontier");var d,u=1/0,h=-1/0,b=Object(p.a)(i);try{for(b.s();!(d=b.n()).done;){var j=d.value,m=j.raw_metrics[t],f="date"===a?j.evaluationDateObject:j.raw_metrics[a];if(m&&f){var g={name:j.method,url:j.paper.url,x:f,y:m,className:j.tags.length?j.tags.map((function(e){return"tag-".concat(e.id)})).join(" "):"tag-0"};"metric-highest"===r&&m>h||"metric-lowest"===r&&m<u?c.data.trend.dataPoints.push(g):c.data.other.dataPoints.push(g),u=Math.min(u,m),h=Math.max(h,m)}}}catch(O){b.e(O)}finally{b.f()}var v=h-u;return c.yAxis.minimum=u-.1*v,c.yAxis.maximum=h+.1*v,c}},{key:"renderEditButton",value:function(){var e=this,t=this.props,a=t.loginRequired;return t.editable?a?Object(o.jsx)("button",{id:"evaluation-table-edit-button",className:"badge badge-edit-sota",type:"button","data-toggle":"modal","data-cy":"edit-sota-table","data-target":"#loginModal",children:"Edit Leaderboard"}):Object(o.jsx)("button",{id:"evaluation-table-edit-button",className:"badge badge-edit-sota","data-cy":"edit-sota-table",type:"button",onClick:function(){e.setState({state:"edit"})},children:"Edit Leaderboard"}):null}},{key:"renderMirrorUrl",value:function(){return""}},{key:"renderView",value:function(){var e=this,t=this.props,a=t.tabId,n=t.isFirstTab,s=t.isCommunity,r=t.tableData,i=this.state.metric,l=Object(o.jsx)("div",{className:"col-auto",children:Object(o.jsx)(g.a.Control,{as:"select",name:"metric",value:i,onChange:this.onConfigChange,style:{height:"initial",marginBottom:"10px"},children:this.state.tableMetrics.map((function(e){var t=e.name;return Object(o.jsx)("option",{value:t,children:t},t)}))})}),c=Object(o.jsx)("div",{className:"col-auto",children:Object(o.jsxs)(g.a.Control,{as:"select",name:"dimension",value:this.state.dimension,onChange:this.onConfigChange,style:{height:"initial",marginBottom:"10px"},children:[Object(o.jsx)("option",{value:"date",children:"Date"},"date"),this.state.tableMetrics.filter((function(e){return e.name!==i})).map((function(e){var t=e.name;return Object(o.jsx)("option",{value:t,children:t},t)}))]})}),u="";this.state.showUsesColumn&&(u=Object(o.jsx)("div",{className:"col-auto",children:Object(o.jsxs)(g.a.Control,{id:"select-filter",as:"select",name:"filter",onChange:this.onConfigChange,style:{height:"initial",marginBottom:"10px"},value:this.state.filter,children:[Object(o.jsx)("option",{value:"all",children:"All models"}),Object(o.jsx)("option",{value:"without-data",children:"Models not using extra training data"}),Object(o.jsx)("option",{value:"with-data",children:"Models using extra training data"})]})}));var h="";this.state.hasCompetition&&(h=Object(o.jsx)("div",{className:"col-auto",children:Object(o.jsxs)(g.a.Control,{id:"select-filter",as:"select",name:"competition",onChange:this.onConfigChange,style:{height:"initial",marginBottom:"10px"},children:[Object(o.jsx)("option",{value:"all",children:"All competition entries"}),Object(o.jsx)("option",{value:"published",children:"Published models only"})]})}));var b,j=n?" active":"",m={},f=[],O=Object(p.a)(this.props.tableData);try{for(O.s();!(b=O.n()).done;){var x,y=b.value,w=Object(p.a)(y.tags);try{for(w.s();!(x=w.n()).done;){var k=x.value;void 0===m[k.id]?(f.push(k),m[k.id]=1):m[k.id]++}}catch(N){w.e(N)}finally{w.f()}}}catch(N){O.e(N)}finally{O.f()}return f.sort((function(e,t){return m[t.id]-m[e.id]})),f.push({id:0,name:"untagged",color:"#bbbbbb"}),Object(o.jsxs)("div",{className:"tab-pane fade show".concat(j),id:a,role:"tabpanel","aria-labelledby":"leaderboard",children:[Object(o.jsx)("div",{className:"row",id:"evaluation-chart-div",children:Object(o.jsxs)("div",{className:"col-md-12",style:{marginBottom:"10px"},children:[Object(o.jsx)("div",{className:"row",children:Object(o.jsxs)("div",{className:"sota-select col-md-12",id:"edit",children:[Object(o.jsx)("div",{className:"float-left",children:Object(o.jsx)("div",{className:"dropdown edit-button"})}),Object(o.jsx)("div",{className:"float-right pull-right text-right",children:Object(o.jsxs)("div",{style:{marginBottom:"20px"},className:"form-row align-items-center",children:[Object(o.jsx)("label",{className:"col-auto",style:{marginBottom:"10px"},children:"View"}),l,Object(o.jsxs)("label",{className:"col-auto",style:{marginBottom:"10px"},children:[" ","by"," "]}),c,u&&Object(o.jsx)("label",{className:"col-auto",style:{marginBottom:"10px"},children:"for"}),u,h]})})]})}),Object(o.jsx)("div",{className:"sota-chart-container",id:"evaluation-chart-container",children:Object(o.jsx)(d.Suspense,{fallback:Object(o.jsx)(B,{}),children:Object(o.jsx)(v,{chart:this.state.filteredChartData,mockPaperUrl:this.props.mockPaperUrl})})})]})}),Object(o.jsx)("div",{className:"row",children:Object(o.jsxs)("div",{className:"col-12 sota-row-tags-filter",id:"tags",children:[Object(o.jsx)("span",{className:"filter",children:"Filter:"})," ",f.map((function(t){var a=e.state.tagFilter.has(t.id)?t.color:"#aaa";return Object(o.jsx)("span",{className:"badge sota-row-tags",style:{backgroundColor:a},onClick:function(){return e.toggleTagFilter(t.id)},onMouseEnter:function(){return e.highlightTag(t.id,t.color)},onMouseLeave:function(){return e.unhighlightTag(t.id)},children:t.name},t.id)})),Object(o.jsx)("div",{className:"float-right pull-right text-right",children:this.renderEditButton()})]})}),this.state.filteredTableData.length!==r.length&&Object(o.jsx)("div",{className:"row",children:Object(o.jsxs)("div",{className:"sota-filters-message",children:["Showing ",this.state.filteredTableData.length," out of"," ",r.length," rows."," ",Object(o.jsx)("a",{href:"clear-filter",onClick:this.clearFilter,children:"(clear all filters)"})]})}),this.renderMirrorUrl(),Object(o.jsx)(F,{highlight:this.props.highlight,metrics:this.state.tableMetrics,data:this.state.filteredTableData,showUsesColumn:this.state.showUsesColumn,selectedMetric:i,selectedMetricDirection:this.state.metricDirection,selectMetric:this.selectMetric,showCodeColumn:this.props.includeCode,alwaysShowPaperColumn:this.props.alwaysShowPaperColumn,showResultColumn:!s,showModelDetailsColumn:s,showTagsColumn:!0,toggleTags:this.toggleTagFilter,onDeleteRowTag:this.onDeleteRowTag,onLinkRowTag:this.onLinkRowTag})]})}},{key:"renderEdit",value:function(){var e=this,t=this.props,a=t.tabId,n=t.isFirstTab?" active":"";return Object(o.jsxs)("div",{className:"tab-pane fade show".concat(n),id:a,role:"tabpanel","aria-labelledby":"leaderboard",children:[Object(o.jsx)("div",{className:"row",children:Object(o.jsx)("div",{className:"col-md-12",children:Object(o.jsxs)("div",{className:"sota-edit-message",children:[Object(o.jsx)("b",{children:"Instructions"})," : Right-click to add/remove/reorder columns and rows, double-click to edit. When saved, rows will reorder using the leftmost metric."]})})}),Object(o.jsx)(O,{ref:this.editTableRef,metrics:this.state.tableMetrics,data:this.props.tableData,saveSpinner:this.state.saveSpinner,paperAutocompleteUrl:this.props.paperAutocompleteUrl,onSave:this.onSave,onCancel:function(){e.setState({state:"view"})}})]})}},{key:"render",value:function(){return Object(o.jsx)(d.Suspense,{fallback:Object(o.jsx)(B,{}),children:"edit"===this.state.state?this.renderEdit():this.renderView()})}},{key:"editTable",get:function(){return this.editTableRef.current}}]),a}(u.a.Component);U.defaultProps={isFirstTab:!1,sotaColor:"#21ccc7",editable:!0,includeCode:!0,alwaysShowPaperColumn:!0,isCommunity:!1};var H=U;function V(e){var t=e.name,a=e.imagePath,n=e.iconName,s=e.color;return null!==a&&"undefined"!==typeof a?Object(o.jsx)("div",{className:"card-background-image",style:{backgroundImage:"url(".concat(a,")")}}):Object(o.jsxs)("div",{className:"card-background-image",style:{backgroundColor:s,opacity:.3},children:[Object(o.jsx)("i",{className:"fad fa-".concat(n," dataset-img-icon")}),Object(o.jsx)("span",{className:"dataset-img-text",children:t})]})}function z(e){var t=e.name,a=e.fullName,n=null;return null!==a&&"undefined"!==typeof a&&""!==a&&a!==t&&(n=Object(o.jsxs)("span",{className:"full-name",children:[" (",a,")"]})),Object(o.jsxs)("span",{className:"name",children:[t,n]})}function G(e){var t=e.name,a=e.fullName,n=e.url,s=e.imagePath,r=e.iconName,i=e.description,l=e.color;return Object(o.jsx)("div",{className:"sota-dataset-wide-box",children:Object(o.jsx)("a",{href:n,children:Object(o.jsxs)("div",{className:"row justify-content-center align-items-center",children:[Object(o.jsx)("div",{className:"col-6 col-sm-2 item-image",children:V({name:t,imagePath:s,iconName:r,color:l})}),Object(o.jsxs)("div",{className:"col-sm-10",children:[z({name:t,fullName:a}),Object(o.jsx)("div",{className:"description",children:Object(o.jsx)("p",{children:i})})]})]})})})}var W=a(105),J=a.n(W);function Y(){return Object(o.jsx)("div",{className:"text-center",children:Object(o.jsx)("img",{src:"/static/spin-1s-32px.gif"})})}var X=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).showUsesAdditionalDataColumn=function(e){for(var t=0;t<e.length;t++)if(e[t].uses_additional_data)return!0;return!1},n.onConfigChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(s.a)({},a,r),n.updateData)},n.state={state:"view",highlight:e.highlight},n}return Object(i.a)(a,[{key:"selectMetric",value:function(e){this.setState({metric:e},this.updateData)}},{key:"getMetricDirection",value:function(e){return this.props.tableMetrics.find((function(t){return t.name===e})).is_loss?"metric-lowest":"metric-highest"}},{key:"convertChartData",value:function(e){return{yAxis:e.yAxis,data:{trend:Object(n.a)(Object(n.a)({},e.data.trend),{},{click:this.onClick,dataPoints:e.data.trend.dataPoints.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{x:new Date(e.x)})}))}),other:Object(n.a)(Object(n.a)({},e.data.other),{},{click:this.onClick,dataPoints:e.data.other.dataPoints.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{x:new Date(e.x)})}))})}}}},{key:"renderHighlight",value:function(){var e=this;return"view"===this.state.state&&this.state.highlight?Object(o.jsx)("div",{className:"alert alert-warning alert-dismissible fade show",role:"alert",style:{backgroundColor:"#fffba1"},children:Object(o.jsxs)("div",{style:{paddingTop:"10px"},children:['Highlighting mentions of paper "',this.state.highlight.title,'"',Object(o.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",style:{marginTop:"8px"},id:"id_highlight_close_button",onClick:function(t){return e.setState({highlight:null})},children:Object(o.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})}):""}},{key:"renderDatasetsTab",value:function(){var e,t=this.props,a=t.dataset,s=t.datasetDetails,r=t.newDatasetUrl,i=t.datasetsSearchUrl;return e="undefined"===typeof s||null===s||0==s.length?Object(o.jsxs)("div",{className:"dataset-no-canonical-badge",children:[Object(o.jsx)("i",{className:"far fa-database",style:{fontSize:"16px",position:"relative",top:"1px",color:"#777"}}),"\xa0",Object(o.jsx)("span",{className:"dataset-name",children:a})," is not associated with any dataset. Add it as a variant to one of the ",Object(o.jsx)("a",{href:i(a),children:"existing datasets"})," or ",Object(o.jsx)("a",{href:r(a),children:"create a new dataset page"}),"."]}):s.map((function(e){return Object(o.jsx)(G,Object(n.a)({},e),e.url)})),Object(o.jsx)("div",{className:"tab-pane fade",id:"datasets",role:"tabpanel","aria-labelledby":"datasets",children:Object(o.jsx)("div",{className:"row",children:Object(o.jsx)("div",{className:"col-md-12",children:e})})})}},{key:"renderDescriptionTab",value:function(){var e=this.props.description;return"undefined"===typeof e||null===e?null:Object(o.jsx)("div",{className:"tab-pane fade",id:"description",role:"tabpanel","aria-labelledby":"description",children:Object(o.jsx)("div",{className:"row",children:Object(o.jsx)("div",{className:"col-md-12",children:Object(o.jsx)(J.a,{children:e})})})})}},{key:"renderTabs",value:function(){var e=this.props,t=e.description,a=e.communityData,n=e.communityMetrics,s=e.tableData,r=e.tableMetrics,i=!0,l=!_.isEmpty(s.filter((function(e){return null!==e.evaluation_date})))&&!_.isEmpty(r),c=!_.isEmpty(a.filter((function(e){return null!==e.evaluation_date})))&&!_.isEmpty(n);"undefined"!==typeof t&&null!==t&&""!==t||(i=!1);var d="",u="",h="",b="";if(l&&(d=Object(o.jsx)("li",{className:"nav-item",children:Object(o.jsx)("a",{"data-toggle":"tab",className:"active nav-link",href:"#leaderboard",children:"Leaderboard"})})),c){var j=l?"":" active";u=Object(o.jsx)("li",{className:"nav-item nav-item-d",children:Object(o.jsx)("a",{"data-toggle":"tab",className:"nav-link".concat(j),href:"#community",children:"Community Models"})})}return h=Object(o.jsx)("li",{className:"nav-item nav-item-d",children:Object(o.jsx)("a",{"data-toggle":"tab",className:"nav-link",href:"#datasets",children:"Dataset"})}),i&&(b=Object(o.jsx)("li",{className:"nav-item",children:Object(o.jsxs)("a",{"data-toggle":"tab",className:"nav-link",href:"#description",children:[Object(o.jsx)("ion-icon",{name:"information-circle-outline"}),"Description"]})})),Object(o.jsx)("div",{className:"leaderboard-tabs row",children:Object(o.jsx)("div",{className:"col-md-12",children:Object(o.jsxs)("ul",{className:"nav nav-tabs",children:[d,u,h,b]})})})}},{key:"renderView",value:function(){var e,t,a=this.props,n=a.task,s=a.dataset,r=a.loginRequired,i=a.chartData,l=a.mockPaperUrl,c=a.tableMetrics,d=a.tableData,u=a.communityChartData,h=a.communityMetrics,b=a.communityData,j=a.paperAutocompleteUrl,p=a.hasCompetition,m=this.state.highlight,f=!_.isEmpty(d),g=!_.isEmpty(b);return f&&(e=Object(o.jsx)(H,{tabId:"leaderboard",task:n,dataset:s,loginRequired:r,chartData:i,mockPaperUrl:l,tableMetrics:c,tableData:d,paperAutocompleteUrl:j,highlight:m,hasCompetition:p,isFirstTab:!0,editable:!0})),g&&(t=Object(o.jsx)(H,{tabId:"community",task:n,dataset:s,loginRequired:r,chartData:u,mockPaperUrl:l,tableMetrics:h,tableData:b,sotaColor:"#ff7f0e",isFirstTab:!f,editable:!1,highlight:m,includeCode:!1,alwaysShowPaperColumn:!1,paperAutocompleteUrl:j,isCommunity:!0})),Object(o.jsxs)("div",{className:"tab-content",id:"benchmark-tabContent",children:[e,t,this.renderDatasetsTab(),this.renderDescriptionTab()]})}},{key:"render",value:function(){return Object(o.jsxs)("div",{children:[this.renderHighlight(),Object(o.jsx)("div",{className:"leaderboard-title",children:Object(o.jsx)("div",{className:"row",children:Object(o.jsxs)("div",{className:"col-md-12 sota-header",children:["edit"===this.state.state?Object(o.jsxs)("h1",{children:['Editing "',this.props.task," on"," ",this.props.dataset,'"']}):Object(o.jsxs)("h1",{children:[this.props.task," on ",this.props.dataset]}),this.renderTabs()]})})}),Object(o.jsx)(d.Suspense,{fallback:Object(o.jsx)(Y,{}),children:"edit"===this.state.state?this.renderEdit():this.renderView()})]})}},{key:"editTable",get:function(){return this.editTableRef.current}}]),a}(u.a.Component),Q=new(function(){function e(){Object(r.a)(this,e),this.container=null,this.table=null,this.component=null,this.sotaPageComponent=u.a.createRef()}return Object(i.a)(e,[{key:"show",value:function(e){var t=e.container,a=e.breadcrumbs,n=e.highlight,s=e.loginRequired,r=e.task,i=e.dataset,l=e.chartData,c=e.tableMetrics,d=e.tableData,u=e.communityChartData,h=e.communityMetrics,j=e.communityData,p=e.paperAutocompleteUrl,m=e.datasetsSearchUrl,f=e.newDatasetUrl,g=e.mockPaperUrl,v=e.datasetDetails,O=e.description,x=e.mirrorUrl,y=e.hasCompetition;this.container=t,this.component=Object(o.jsx)(X,{ref:this.sotaPageComponent,breadcrumbs:a,highlight:n,task:r,dataset:i,loginRequired:s,chartData:l,mockPaperUrl:g,tableMetrics:c,tableData:d,communityChartData:u,communityMetrics:h,communityData:j,paperAutocompleteUrl:p,datasetsSearchUrl:m,newDatasetUrl:f,datasetDetails:v,description:O,mirrorUrl:x,hasCompetition:y}),b.a.render(this.component,t)}},{key:"hide",value:function(){this.component&&(b.a.unmountComponentAtNode(this.container),this.component=null)}}]),e}());t.default=Q},359:function(e,t,a){"use strict";a.r(t);var n=a(21),s=a(18),r=a(5),i=a(8),l=a(12),c=a(13),o=a(15),d=a(14),u=a(0),h=a(19),b=a.n(h),j=a(1),p=a.n(j),m=a(373),f=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.filterAutomatic,a=e.onFilterAutomatic;return Object(u.jsx)(m.a,{type:"checkbox",variant:"primary-outline",checked:t,onChange:function(e){null!=a&&a(e.currentTarget.checked)},children:"Hide automatic entries"})}}]),a}(p.a.Component),g=a(200),v=a(376),O=a(69),x=a(9),y=a.n(x),w=a(65),k=a(153),N=a(74),C=a(371),_=function(e){var t=e.inProgress,a=e.size,n=e.variant,s=e.children,i=Object(N.a)(e,["inProgress","size","variant","children"]),l=t?Object(u.jsx)(C.a,{animation:"border",role:"status",variant:n,size:a,children:Object(u.jsx)("span",{className:"sr-only",children:"Loading..."})}):s;return Object(u.jsx)(w.a,Object(r.a)(Object(r.a)({variant:n,size:a},i),{},{children:l}))},S=a(171),D=function(e,t){var a=function(e){return[e.task.toString().trim(),e.dataset.toString().trim(),e.metric.toString().trim(),e.model.toString().trim(),e.value.toString().trim(),e.external.toString().trim()]},s=function(e){return{task:e[0],dataset:e[1],metric:e[2],model:e[3],value:e[4],external:e[5]}},r=function(e,t,a){"undefined"===typeof a&&(a=e.length);for(var n=0;n<a&&e[n]===t[n];)n++;return n===a?0:e[n]<t[n]?-1:1},l=e.map(a).sort(r),c=t.map(a).sort(r),o=0,d=0,u=[],h=[],b=[],j=function(e,t){for(var a=[],n=[],s=0,l=0;s<e.length&&l<t.length;){var c=e[s],o=t[l],d=r(c,o);0===d?(s++,l++):d<0?(a.push(c),s++):(n.push(o),l++)}return[a=[].concat(Object(i.a)(a),Object(i.a)(e.slice(s))),n=[].concat(Object(i.a)(n),Object(i.a)(t.slice(l)))]}(c,l),p=Object(n.a)(j,2);for(c=p[0],l=p[1];o<c.length&&d<l.length;){var m=c[o],f=l[d];o++,d++;for(var g=Object(i.a)(f.slice(0,0)),v=0;v<f.length;v++){var O=m[v],x=f[v];if(O===x)g.push(x);else{var y=4===v?S.diffChars:S.diffWords;g.push(y(O,x))}}b.push(g)}return u=[].concat(Object(i.a)(u),Object(i.a)(c.slice(o))),h=[].concat(Object(i.a)(h),Object(i.a)(l.slice(d))),{deletions:u.map(s),additions:h.map(s),modifications:b.map(s)}};function R(e){return e instanceof Date||(e=new Date(e)),new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()}function M(e){return R(e).slice(0,10)}function T(e){var t=R(e);return"".concat(t.slice(0,10)," ").concat(t.slice(11,16))}var I=a(171),E=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={open:!1},e.ref=p.a.createRef(),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){null!=window.MathJax.typeset&&null!=this.ref.current&&window.MathJax.typeset([this.ref.current])}},{key:"render",value:function(){var e=this,t=this.props,a=t.labelOpen,n=t.labelClose,s=t.children,r=this.state.open;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(w.a,{className:"show-hide",onClick:function(){return e.setState({open:!r})},"aria-expanded":r,children:r?n:a}),Object(u.jsx)(k.a,{in:r,children:Object(u.jsx)("div",{ref:this.ref,children:s})})]})}}]),a}(p.a.Component),P=function(e){return"object"!==typeof e?e:e.map((function(e,t){return e.added?null:e.removed?Object(u.jsx)("del",{children:e.value},t):Object(u.jsx)("span",{children:e.value},t)}))},A=function(e){return"object"!==typeof e?e:e.map((function(e,t){return e.added?Object(u.jsx)("ins",{children:e.value},t):e.removed?null:e.value}))},L=function(e){if("object"!==typeof e)return e;var t=P(e),a=A(e);return Object(u.jsxs)(u.Fragment,{children:[t,Object(u.jsx)("br",{}),a]})},q=function(e,t,a){var n=e.split(" ");return n.length<=t+a?e:[].concat(Object(i.a)(n.slice(0,t)),["(\u2026)"],Object(i.a)(n.slice(n.length-a))).join(" ")},F=function(e){if("object"!==typeof e)return"[NO CHANGES]";var t=Object.values(e).length-1;return e.map((function(e,a){return e.added?Object(u.jsx)("ins",{children:e.value},a):e.removed?Object(u.jsx)("del",{children:e.value},a):Object(u.jsx)("span",{children:q(e.value,0===a?0:5,a===t?0:5)},a)}))},B=function(e){if("object"!==typeof e)return e;for(var t=0,a=[];t<e.length;){for(;t<e.length&&!e[t].removed;)a.push(e[t]),t++;if(t<e.length){for(var n=t+1;n<e.length-2&&e[n].added&&""===e[n+1].value.trim()&&e[n+2].removed;)n+=3;var s=[e[t]],i=[];for(t++;t+2<n;)i.push(e[t]),i.push(Object(r.a)(Object(r.a)({},e[t+1]),{},{added:!0})),s.push(Object(r.a)(Object(r.a)({},e[t+1]),{},{removed:!0})),s.push(e[t+2]),t+=3;a.push.apply(a,s.concat(i))}}return a},U=function(e){var t=e.task,a=e.dataset,n=e.metric,s=e.value,r=e.model,i=e.external;return Object(u.jsxs)("tr",{className:"result-review-blob",children:[Object(u.jsx)("td",{children:L(s)}),Object(u.jsx)("td",{children:L(n)}),Object(u.jsx)("td",{children:L(r)}),Object(u.jsx)("td",{children:L(a)}),Object(u.jsx)("td",{children:L(t)}),Object(u.jsx)("td",{children:L(i)})]})},H=function(e){var t=e.className,a=e.header,n=e.results;if(0===n.length)return null;for(var s=[],i=0,l=function(e){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{children:"Value"}),Object(u.jsx)("th",{children:"Metric"}),Object(u.jsx)("th",{children:"Model"}),Object(u.jsx)("th",{children:"Dataset"}),Object(u.jsx)("th",{children:"Task"}),Object(u.jsx)("th",{children:"Extra Data"})]},"header-".concat(e))},c=0;c<n.length;c++){var o=n[c];0===c&&(s.push(l(i)),i++);var d=Object(u.jsx)(U,Object(r.a)({},o),c);s.push(d)}return Object(u.jsxs)("div",{className:"records-card ".concat(t),children:[Object(u.jsx)("h5",{children:a}),Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:s})})]})},V=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={versionsExpanded:!1,squashed:null,status:null,updatedStatus:null,updatedStatusDate:null},e.ignoreFieldsAll={PaperGithubRepo:new Set(["in_paper_abstract","in_paper_page1","in_paper_fulltext"])},e.recordsFromArchive=function(e){var t=e.fields,a=t.task,s=t.metrics,r=t.methodology,i=t.dataset,l=t.uses_additional_data,c=r,o=null===l?" ":l?"yes":"no";return Object.entries(s).map((function(e){var t=Object(n.a)(e,2),s=t[0],r=t[1];return{task:null!=a?a.name:"[ERROR]",dataset:null!=i?i.name:"[ERROR]",model:c,metric:s,value:r,external:o}}))},e.paperElement=function(e){return null!=e?Object(u.jsx)("a",{href:e._url,target:"_blank",children:e.title}):null},e.arxivLink=function(e){return null!=e&&e.arxiv_id?Object(u.jsx)("a",{href:"https://arxiv.org/abs/".concat(e.arxiv_id),target:"_blank",children:e.arxiv_id}):null},e.datasetElement=function(e){return null!=e?Object(u.jsx)("a",{href:e._url,target:"_blank",children:e.name}):null},e.datasetLoaderElement=function(e){if(null==e||"undefined"===typeof e)return null;var t=e.repository?Object(u.jsx)("a",{href:e.repository._url,target:"_blank",children:e.repository.full_name}):null,a=Object(u.jsx)("div",{className:"mb-2",style:{marginLeft:"10px",color:"#666"},children:y.a.isEmpty(e.frameworks)?"no frameworks":e.frameworks.sort().join(", ")});return e.url?[t," (",Object(u.jsx)("a",{href:e.url,target:"_blank",children:e.url}),")",a]:[t,a]},e.formatEditors=function(t){if(0===(t=t.filter((function(e){return null!=e&&e.username}))).length)return Object(u.jsx)("div",{});var a,n=["by ",(t=(t=y.a.uniqBy(t,"username")).map((function(t){var a="user";return t.active?t.moderator&&(a+=" moderator"):a+=" inactive",Object(u.jsx)("a",{href:"#",onClick:function(a){return e.handleUserClicked(t.model_id,a)},className:a,target:"_blank",children:t.username})})))[0]],r=Object(s.a)(t.slice(1));try{for(r.s();!(a=r.n()).done;){var i=a.value;n.push(", ",i)}}catch(l){r.e(l)}finally{r.f()}return n},e.squashResults=function(t){for(var a=y.a.groupBy(t,"model_id"),n=[],s=[],r=[],l=0,c=Object.values(a);l<c.length;l++){var o=c[l],d=e.squashObjectItems(o).users;r.push.apply(r,Object(i.a)(d)),o[0].is_baseline&&o[0].active&&n.push.apply(n,Object(i.a)(e.recordsFromArchive(o[0])));var h=o[o.length-1];h.active&&s.push.apply(s,Object(i.a)(e.recordsFromArchive(h)))}var b=D(s,n),j=b.additions,p=b.modifications,m=b.deletions;if(!(0!==j.length||0!==m.length||0!==p.length))return null;var f=t[0].paper,g=e.paperElement(f);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("span",{className:"recent-changes-header",children:["Benchmark results for ",g]}),Object(u.jsx)(H,{className:"added-results-card",results:j,header:"\u2022Added Results (+".concat(j.length,"):")}),Object(u.jsx)(H,{className:"modified-results-card",results:p,header:"\u2022Updated Results (".concat(p.length,"):")}),Object(u.jsx)(H,{className:"removed-results-card",results:m,header:"\u2022Removed Results (-".concat(m.length,"):")}),Object(u.jsx)("div",{children:e.formatEditors(r)})]})},e.squashRepos=function(t){for(var a=t[t.length-1].paper,n=e.paperElement(a),s=y.a.groupBy(t,"model_id"),r=0,l=0,c=0,o=[],d=[],h=0,b=Object.values(s);h<b.length;h++){var j=b[h],p=e.squashObjectItems(j),m=p.oldState,f=p.newState,g=p.users;if(!y.a.isEqual(m.fields.show,f.fields.show)||!y.a.isEqual(m.fields.is_official,f.fields.is_official)){d.push.apply(d,Object(i.a)(g));var v="";!1===m.fields.show&&!0===f.fields.show?(v="+",r++):!0===m.fields.show&&!1===f.fields.show?(v="\u2212",l++):v="\u2022";var O=j[j.length-1].repository,x=e.formatRepository(O),w=null!=O&&""!==(O.about||"")?Object(u.jsx)("div",{className:"description",children:O.about}):null,k=void 0;m.fields.is_official!==f.fields.is_official&&(c++,k=Object(u.jsxs)("div",{children:["\u2022Marked as ",f.fields.is_official?"official":"community"]})),o.push(Object(u.jsxs)("div",{className:"repository",children:[v,x,k,w]}))}}if(0===o.length)return null;var N=c>0?"updates of":l>0?r>0?"updates of":"removed from":"added to",C=Object(u.jsxs)("span",{className:"recent-changes-header",children:["Code ",N," paper ",n]}),_=e.formatEditors(d);return[C,Object(u.jsx)("div",{children:o}),Object(u.jsx)("div",{children:_})]},e.handleApproval=function(t,a){var n=e.props,s=n.onRequestApproved,r=n.onRequestRejected;a&&null!=s?s(t):a||null==r||r(t)},e.arxivDatasetCard=function(t){if(!t.name||!t.paper||t.is_landing_hidden)return null;var a,n;a=t.image?Object(u.jsx)("img",{src:"/media/"+t.image}):Object(u.jsx)("div",{className:"pwc-data-card-image-placeholder",style:{backgroundColor:"#62AEE4"},children:Object(u.jsx)("span",{children:t.name[0]})});var s,r=t.num_papers-1;return 1===r?n=Object(u.jsx)("div",{className:"pwc-data-name-meta",children:"1 paper also uses this dataset"}):r>1&&(n=Object(u.jsxs)("div",{className:"pwc-data-name-meta",children:[r," papers also use this dataset"]})),s=t.paper.arxiv_id?Object(u.jsxs)("div",{className:"pwc-data-name-introduced",children:["\u2605 introduced in ",e.arxivLink(t.paper)]}):Object(u.jsx)("div",{className:"pwc-data-name-introduced",children:"introduced in non-arXiv paper"}),Object(u.jsxs)("div",{className:"pwc-data-card",children:[Object(u.jsx)("div",{className:"pwc-data-card-image",children:a}),Object(u.jsxs)("div",{className:"pwc-data-card-name",children:[Object(u.jsx)("span",{className:"pwc-data-name",children:t.name}),n,s]})]})},e.formatModerationRequest=function(t){var a=t.model_name,n=t.requester,s=t.moderator,r=t.request,l=r.id,c=r.action,o=r.status,d=r.progress,h=Object(u.jsx)(_,{variant:"outline-success",title:"Approve",size:"sm",className:"button-approve",inProgress:"approving"===d,disabled:null!=d,onClick:function(){return e.handleApproval(l,!0)},children:"Approve"}),b=Object(u.jsx)(_,{variant:"outline-danger",title:"Reject",size:"sm",className:"button-reject",inProgress:"rejecting"===d,disabled:null!=d,onClick:function(){return e.handleApproval(l,!1)},children:"Reject"}),j=Object(u.jsxs)("div",{children:[b,"\xa0",h]}),p=o.charAt(0).toUpperCase()+o.slice(1),m=[p];"approved"!==o&&"rejected"!==o||m.push(" ",e.formatEditors([s]));var f=Object(u.jsx)("div",{children:m});if("PaperGithubRepo"===a){var g,v=t.paper,O=t.repository,x=""!==(O.about||"")?Object(u.jsx)("div",{className:"description",children:O.about}):null,y=e.paperElement(v),w=Object(u.jsxs)("span",{children:[p," request for code changes of paper ",y]}),k=e.formatRepository(O);switch(c){case"set_is_official":var N=r.params.is_official?"the official":"a community";g=Object(u.jsxs)("span",{children:[Object(u.jsxs)("b",{children:["mark as ",N]})," implementation"]});break;case"remove_official_repo":g=Object(u.jsxs)("span",{children:[Object(u.jsx)("b",{children:"remove the official"})," repository"]});break;default:return"Unrecognized action ".concat(c," on ").concat(a)}return Object(u.jsxs)(u.Fragment,{children:[w,Object(u.jsx)("div",{children:Object(u.jsxs)("div",{className:"repository",children:[Object(u.jsxs)("div",{children:["Request to ",g]}),"\u2022",k,x]})}),Object(u.jsxs)("div",{children:["Requested ",e.formatEditors([n])]}),"pending"===o?j:f]})}if("Dataset"===a){var C,S,D=t.request.params,R=t.fields;switch(c){case"update_moderated_fields":var M=!R.verified_name&&!R.verified_paper_id;C=Object(u.jsxs)("span",{children:[p," request to ",M?"publish":"update"," ",e.datasetElement(R)," dataset on arXiv"]});var T=e.arxivDatasetCard({name:R.verified_name,paper:R.verified_paper,image:R.verified_image,num_papers:R.cached_num_papers,is_landing_hidden:R.is_landing_hidden}),I=e.arxivDatasetCard({name:D.name,paper:D.paper,image:D.image,num_papers:R.cached_num_papers,is_landing_hidden:R.is_landing_hidden});S="approved"===o||"rejected"===o?Object(u.jsx)("div",{className:"my-4",children:T}):[Object(u.jsxs)("div",{className:"my-4",children:[T,Object(u.jsx)("span",{className:"d-md-inline d-none",children:" \u2192 "}),Object(u.jsx)("div",{className:"d-md-none my-2 text-center",style:{width:"300px"},children:"\u2193"}),I]})].concat(Object(i.a)(e.diffFieldValues("name",R.verified_name,D.name)),Object(i.a)(e.diffFieldValues("unified_paper_info",R.verified_paper,D.paper)),[Object(u.jsx)("div",{className:"recent-changes-small-imgs",children:e.diffFieldValues("image",R.verified_image,D.image)})]);break;default:return"Unrecognized action ".concat(c," on ").concat(a)}return Object(u.jsxs)(u.Fragment,{children:[C,Object(u.jsx)("div",{children:Object(u.jsx)("div",{className:"repository",children:Object(u.jsx)("div",{children:S})})}),Object(u.jsxs)("div",{children:["Requested ",e.formatEditors([n])]}),"pending"===o?j:f]})}return"Task"===a?Object(u.jsxs)(u.Fragment,{children:[p," request to update the image of ",Object(u.jsx)("a",{rel:"noreferrer",target:"_blank",href:t.origin_url,children:t.fields.name})," task.",Object(u.jsx)("p",{}),Object(u.jsx)("p",{children:Object(u.jsx)("img",{alt:"task",src:"/media/".concat(t.request.params.image),style:{maxWidth:300,maxHeight:300}})}),Object(u.jsxs)("p",{children:["Requested ",e.formatEditors([n])]}),"pending"===o?j:f]}):"PageMeta"===a?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("p",{children:[p," request to update ",Object(u.jsx)("a",{rel:"noreferrer",target:"_blank",href:t.origin_url,children:"this page"})," meta"]}),t.errors&&Object(u.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[Object(u.jsx)("h4",{className:"alert-heading",children:"Errors"}),Object(u.jsx)("pre",{children:JSON.stringify(t.errors,null,4)})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Model name:"})," ",t.request.params.model_name]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Model id:"})," ",t.request.params.model_id]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Description:"})," ",t.request.params.description?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("br",{})," ",t.request.params.description]}):Object(u.jsx)("span",{className:"badge badge-danger",children:"null"})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Image enabled:"})," ",t.request.params.image_enabled?"Yes":"No"]}),t.request.params.image_extension&&Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Image type:"})," ",t.request.params.image_extension]}),t.request.params.image_content&&Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Image:"}),Object(u.jsx)("br",{}),Object(u.jsx)("img",{alt:"meta",src:"data:image/png;base64, "+t.request.params.image_content,style:{maxWidth:300,maxHeight:300}})]}),null===t.request.params.image_url&&Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Image:"})," ",Object(u.jsx)("span",{className:"badge badge-danger",children:"null"})]}),Object(u.jsxs)("div",{children:["Requested ",e.formatEditors([n])]}),"pending"===o?j:f]}):"Unrecognized action ".concat(c," on ").concat(a)},e.getLink=function(e){return null===e||"undefined"===typeof e?null:Object(u.jsx)("a",{href:e._url,target:"_blank",children:e.name})},e.getPaperLink=function(e){return null===e||"undefined"===typeof e?null:Object(u.jsx)("a",{href:e._url,target:"_blank",children:e.title})},e.getEvaluationTableRowLink=function(t){return null===t||"undefined"===typeof t?null:Object(u.jsxs)("span",{children:[Object(u.jsx)("a",{href:t.evaluationtable._url,target:"_blank",children:t.evaluationtable.slug}),Object(u.jsx)("br",{}),Object(u.jsxs)("span",{className:"recent-changes-subtitle",children:["Paper: ",e.getPaperLink(t.paper),Object(u.jsx)("br",{}),"Model: ",t.fields.evaluationtablerow.methodology]})]})},e.getMethodLink=function(e){if(null===e)return Object(u.jsx)("a",{children:"[HARD DELETED]"});var t=e.full_name!==e.name&&null!=e.full_name?"".concat(e.full_name," (").concat(e.name,")"):e.name;return Object(u.jsx)("a",{href:e._url,target:"_blank",children:t})},e.getDatasetLink=function(e){if(null===e)return Object(u.jsx)("a",{children:"[HARD DELETED]"});var t=e.name;return null!=e.full_name&&""!==e.full_name&&e.full_name!==e.name&&(t="".concat(e.name," (").concat(e.full_name,")")),Object(u.jsx)("a",{href:e._url,target:"_blank",children:t})},e.getCollectionLink=function(e){return null===e?Object(u.jsx)("a",{children:"[HARD DELETED]"}):Object(u.jsx)("a",{href:e._url,target:"_blank",children:e.name})},e.squashObjectItems=function(e){var t,a;return e[0].is_baseline?(t=e[0],a=e.slice(1)):(t={fields:{}},a=e),{oldState:t,newState:e[e.length-1],users:a.map((function(e){return e.user}))}},e.diffSimpleTextValues=function(e,t,a,n){var s=null==a||""==a||y.a.isEqual(a,{}),r=I.diffWords(a||"",n||""),i=P(r),l=A(r),c=s?"set":['changed from "',i,'"'];return Object(u.jsxs)("h5",{children:["\u2022",t," ",c,' to "',l,'"']},e)},e.diffFieldValues=function(t,a,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=[],c=null==a||""==a||y.a.isEqual(a,{}),o=null==n||""==n||y.a.isEqual(n,{}),d={title:"Title",name:"Name",full_name:"Full name",url:"URL",url_abs:"URL of abstract ",url_pdf:"URL",abstract:"Abstract"};if((!c||!o)&&!y.a.isEqual(a,n))if(d.hasOwnProperty(t)){var h=d[t];l.push(e.diffSimpleTextValues(t,h,a,n))}else switch(t){case"area_id":var b,j=e.getLink(r.area),p=e.getLink(i.area);b=null===a?Object(u.jsxs)("h5",{children:["\u2022Assigned to ",p]}):null===n?Object(u.jsxs)("h5",{children:["\u2022Removed from ",j]}):Object(u.jsxs)("h5",{children:["\u2022Moved from ",j," to ",p]}),l.push(b);break;case"authors":var m=c?"":a.join(", "),f=o?"":n.join(", ");l.push(e.diffSimpleTextValues(t,"Authors",m,f));break;case"unified_paper_info":var g,v=e.paperElement(a),O=e.paperElement(n);g=c?Object(u.jsxs)("h5",{children:["\u2022Introduced-by paper set to ",O]}):o?Object(u.jsxs)("h5",{children:["\u2022Removed ",v," as introduced-by paper"]}):Object(u.jsxs)("h5",{children:["\u2022Introduced-by paper changed from ",Object(u.jsx)("del",{children:v})," to ",Object(u.jsx)("ins",{children:O}),";"]}),l.push(g);break;case"introduced_date":var x=c?"set":["changed from ",a];l.push(Object(u.jsxs)("h5",{children:["\u2022Introduction date ",x," to ",n]}));break;case"is_landing_hidden":var w=n?"hidden":"published";l.push(Object(u.jsxs)("h5",{children:["\u2022Landing page has been ",w]}));break;case"description":case"footer":var k=B(I.diffWords(a||"",n||"")),N="description"===t?"Description":"Footer",C="description"===t?s.description_html:s.footer_html,_=c?"added":"updated";l.push(Object(u.jsxs)("div",{children:[Object(u.jsxs)("h5",{children:["\u2022",N," ",_]}),F(k)]})),l.push(Object(u.jsx)(E,{labelOpen:"Show updated",labelClose:"Hide updated",children:Object(u.jsx)("div",{dangerouslySetInnerHTML:{__html:C}})}));break;case"image":var S=c?"added":"changed";l.push(Object(u.jsxs)("h5",{children:["\u2022Image ",S]}));var D=[];c||(D.push(Object(u.jsx)("img",{src:"/media/"+a},"old")),D.push(" ",Object(u.jsx)("ion-icon",{name:"arrow-forward-outline"})," ")),D.push(Object(u.jsx)("img",{src:"/media/"+n},"new")),l.push(Object(u.jsx)("div",{className:"entry-image",children:D}))}return l},e.diffObjectItems=function(t,a,n){var s,r=t.oldState,l=t.newState,c=t.users,o=[];for(var d in l.fields){var h=r.fields[d]||null,b=l.fields[d];o.push.apply(o,Object(i.a)(e.diffFieldValues(d,h,b,l.fields,r,l)))}if(0===o.length&&!y.a.get(l,"is_updated",!1))return[];var j=n(l.fields);s=y.a.isEqual(r.fields,{})?Object(u.jsxs)("span",{className:"recent-changes-header",children:["New ",a," ",j]}):Object(u.jsxs)("span",{className:"recent-changes-header",children:["Changes to ",a," ",j]});var p=Object(u.jsx)("div",{children:e.formatEditors(c)});return[s].concat(o,[p])},e.diffMethods=function(t){return e.diffObjectItems(t,"method",e.getMethodLink)},e.diffPapers=function(t){return e.diffObjectItems(t,"paper",e.paperElement)},e.diffTasks=function(t){return e.diffObjectItems(t,"task",e.getLink)},e.diffDatasets=function(t){return e.diffObjectItems(t,"dataset",e.getDatasetLink)},e.diffCollections=function(t){return e.diffObjectItems(t,"collection",e.getCollectionLink)},e.diffTags=function(t){return e.diffObjectItems(t,"tag",e.getLink)},e.squashMethodCollections=function(t){var a=e.squashObjectItems(t);return e.diffObjectItems(a,"method collection",e.getLink)},e.squashTaskTags=function(t){return e.squashManyToMany(t,"task",(function(e){return e>1?"Subtasks":"Subtask"}),(function(t){return Object(u.jsxs)(u.Fragment,{children:[e.getLink(t.fields.tag)," under ",e.getLink(t.fields.area)," area"]})}),(function(t){return e.getLink(t.fields.task)}))},e.squashPaperTasks=function(t){return e.squashManyToMany(t,"paper",(function(e){return e>1?"Tasks":"Task"}),(function(t){return e.paperElement(t.paper)}),(function(t){return e.getLink(t.fields.task)}))},e.squashTaskDataset=function(t){return e.squashManyToMany(t,"dataset",(function(e){return e>1?"Tasks":"Task"}),(function(t){return e.datasetElement(t.fields.dataset)}),(function(t){return e.getLink(t.fields.task)}))},e.squashPaperDatasets=function(t){return e.squashManyToMany(t,"paper",(function(e){return e>1?"Datasets":"Dataset"}),(function(t){return e.paperElement(t.paper)}),(function(t){return e.datasetElement(t.fields.dataset)}))},e.squashPaperMethods=function(t){return e.squashManyToMany(t,"paper",(function(e){return e>1?"Methods":"Method"}),(function(t){return e.paperElement(t.paper)}),(function(t){return e.getLink(t.method)}))},e.squashMethodCollectionMembers=function(t){return e.squashManyToMany(t,"collection",(function(e){return e>1?"Methods":"Method"}),(function(t){return e.getLink(t.collection)}),(function(t){return e.getMethodLink(t.method)}))},e.squashDatasetCollectionMembers=function(t){return e.squashManyToMany(t,"dataset",(function(e){return e>1?"Categories":"Category"}),(function(t){return e.getDatasetLink(t.fields.dataset)}),(function(t){return e.getLink(t.collection)}))},e.squashCollectionItem=function(t){return e.squashManyToMany(t,"collection",(function(e){return e>1?"Items":"Item"}),(function(t){return e.getCollectionLink(t.collection)}),(function(t){return y.a.get(t,"paper")?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("ion-icon",{name:"document-outline",style:{fontSize:"13px"}}),e.paperElement(t.paper)]}):y.a.get(t,"fields.dataset")?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("ion-icon",{name:"server-outline",style:{fontSize:"13px"}}),e.getDatasetLink(t.fields.dataset)]}):y.a.get(t,"method")?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("ion-icon",{name:"school-outline",style:{fontSize:"13px"}}),e.getMethodLink(t.method)]}):void 0}))},e.squashDatasetVariants=function(t){return e.squashManyToMany(t,"dataset",(function(e){return e>1?"Dataset variants":"Dataset variant"}),(function(t){return e.getDatasetLink(t.main)}),(function(t){return e.getDatasetLink(t.variant)}))},e.squashDatasetLoaders=function(t){return e.squashManyToMany(t,"dataset",(function(e){return e>1?"Dataset loaders":"Dataset loader"}),(function(t){return e.getDatasetLink(t.fields.dataset)}),(function(t){return e.datasetLoaderElement(t.fields)}))},e.squashMethodDependencies=function(t){return e.squashManyToMany(t,"method",(function(e){return e>1?"Dependencies":"Dependency"}),(function(t){return e.getLink(t.method)}),(function(t){return e.getMethodLink(t.dependency)}))},e.squashEvaluationTableRowTag=function(t){return console.log(t),e.squashManyToMany(t,"evaluationtable",(function(e){return e>1?"Tags":"Tag"}),(function(t){return e.getEvaluationTableRowLink(t)}),(function(t){return e.getLink(t.fields.tag)}))},e.squashManyToMany=function(t,a,n,s,r){for(var l=[],c=y.a.groupBy(t,"model_id"),o=0,d=0,h=[],b=0,j=Object.values(c);b<j.length;b++){var p=j[b],m=e.squashObjectItems(p).users;h.push.apply(h,Object(i.a)(m));var f=void 0,g=void 0;if(p[0].is_baseline?(f=p[0].fields).active=p[0].active:f=1===p[0].model_version?{active:!1}:{active:null},(g=p[p.length-1].fields).active=p[p.length-1].active,f.active!==g.active){var v=void 0;g.active?(o++,v="+"):(d++,v="\u2212");var O=r(p[p.length-1]);l.push(Object(u.jsxs)("div",{className:"recent-change-many-to-many-action",children:[v,O]}))}}if(0===l.length)return null;var x=s(t[t.length-1]),w=n(o+d),k=o>0?d>0?"updates of":"added to":"removed from",N=Object(u.jsxs)("span",{className:"recent-changes-header",children:[w," ",k," ",a," ",x]}),C=Object(u.jsx)("div",{children:e.formatEditors(h)});return[N].concat(l,[C])},e.squash=function(t){if(0===t.length)return[];var a=t[0].model_name,n=y.a.sortBy(t,"model_version");switch(a){case"EvaluationTableRow":return e.squashResults(n);case"PaperGithubRepo":return e.squashRepos(n);case"Method":return e.diffMethods(e.squashObjectItems(n));case"MethodCollection":return e.squashMethodCollections(n);case"MethodCollectionMember":return e.squashMethodCollectionMembers(n);case"MethodDependency":return e.squashMethodDependencies(n);case"PaperMethod":return e.squashPaperMethods(n);case"PaperTask":return e.squashPaperTasks(n);case"PaperDataset":return e.squashPaperDatasets(n);case"Paper":return e.diffPapers(e.squashObjectItems(n));case"Task":return e.diffTasks(e.squashObjectItems(n));case"TaskTags":return e.squashTaskTags(n);case"Dataset":return e.diffDatasets(e.squashObjectItems(n));case"TaskDataset":return e.squashTaskDataset(n);case"DatasetLoader":return e.squashDatasetLoaders(n);case"DatasetCollectionMember":return e.squashDatasetCollectionMembers(n);case"DatasetVariant":return e.squashDatasetVariants(n);case"Collection":return e.diffCollections(e.squashObjectItems(n));case"CollectionItem":return e.squashCollectionItem(n);case"Tag":return e.diffTags(e.squashObjectItems(n));case"EvaluationTableRowTag":return e.squashEvaluationTableRowTag(n);default:var s=e.squashObjectItems(n).users;return Object(u.jsxs)("span",{children:["Unrecognized updates to ",a," by ",e.formatEditors(s)]})}},e.renderItemVersion=function(t,a){var n,s,r,i,l,c,o,d,h;for(var b in null===a&&(a=t),t.fields){var j=t.fields[b],p=y.a.get(a.fields,b,null),m=y.a.isEqual(p,j)?"":"updated-field";switch(b){case"name":n=Object(u.jsx)("span",{className:m,children:j});break;case"full_name":s=j?Object(u.jsxs)("span",{className:m,children:["(",j,")"]}):Object(u.jsx)("span",{children:"\xa0"});break;case"url":Object(u.jsx)("h5",{className:m,children:Object(u.jsx)("a",{href:j,children:j})});break;case"introduced_date":Object(u.jsx)("h5",{className:m,children:j});break;case"unified_paper_info":d=Object(u.jsxs)("h5",{className:m,children:["Introduced by: ",e.paperElement(j)]});break;case"is_landing_hidden":r=Object(u.jsxs)("h5",{className:m,children:["Landing page: ",j?"hidden":"published"]});break;case"description":break;case"description_html":i=Object(u.jsxs)("div",{className:m,children:[Object(u.jsx)("h5",{children:"Description:"}),Object(u.jsx)("div",{dangerouslySetInnerHTML:{__html:j}})]});break;case"footer":break;case"footer_html":h=Object(u.jsxs)("div",{className:m,children:[Object(u.jsx)("h5",{children:"Footer:"}),Object(u.jsx)("div",{dangerouslySetInnerHTML:{__html:j}})]});break;case"image":l=Object(u.jsxs)("div",{className:m,children:["Image:",Object(u.jsx)("div",{className:"entry-image",children:j&&Object(u.jsx)("img",{src:"/media/"+j})})]});break;case"thumbnail":c=Object(u.jsxs)("div",{className:m,children:["Thumbnail:",Object(u.jsx)("div",{className:"entry-image thumbnail",children:j&&Object(u.jsx)("img",{src:"/media/"+j})})]});break;case"icon":o=Object(u.jsxs)("div",{className:m,children:["Icon:",Object(u.jsx)("div",{className:"entry-image thumbnail",children:j&&Object(u.jsx)("img",{src:"/media/"+j})})]})}}return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"row",children:Object(u.jsxs)("div",{className:"col-12",children:[t.model_name,": ",n," ",s]})}),Object(u.jsxs)("div",{className:"row",children:[Object(u.jsxs)("div",{className:"col-3",children:[l," ",c," ",o," ",r," ",d]}),Object(u.jsxs)("div",{className:"col-9",children:[i,h]})]})]})},e.handleUserClicked=function(t,a){a.preventDefault(),e.props.onUserClicked&&e.props.onUserClicked(t)},e.toggleVersions=function(t){var a=e.state.versionsExpanded;e.setState({versionsExpanded:!a})},e.handleRevertClicked=function(t,a,n,s){var r=e.props.onRevert;r&&r(t,a,n,s)},e.renderVersions=function(t){var n=e.state.versionsExpanded,s=null!=t[0].request,r=t[0].model_name;if(s||!a.RevertibleModels.includes(r))return null;var i=[];return n&&function(){for(var a=y.a.sortBy(t,"model_version"),n=a[a.length-1].model_version,s=null,r=function(t){var r=a[t],l=T(r.date),c=t===a.length-1,o=y.a.get(r,"revert.progress",null),d=void 0;if(c)d="Current version";else if(null!==o)switch(o){case"reverting":d="Reverting";break;case"refresh":d="New changes detected. Review below and try again";break;case"reverted":d="Reverted";break;case"error":d="Error"}else d="Revert to this version";var h=Object(u.jsxs)(_,{variant:"outline-primary",title:d,size:"sm",className:"button-revert",inProgress:"reverting"===o,disabled:c||null!=o&&"refresh"!==o,onClick:function(){return e.handleRevertClicked(r.model_name,r.model_id,r.model_version,n)},children:[Object(u.jsx)("i",{className:"fas fa-history"}),"\xa0",d]}),b=void 0;null!==r.user&&r.user.username&&(b=Object(u.jsxs)("span",{children:[" ",e.formatEditors([r.user])]})),i.push(Object(u.jsxs)("div",{className:"item-version",children:[Object(u.jsxs)("div",{children:[Object(u.jsxs)("span",{className:"recent-changes-header",children:["[",l,"]"]}),"\xa0",Object(u.jsxs)("span",{children:["(version ",r.model_version,b,")"]}),h]}),Object(u.jsx)("div",{className:"clearfix"}),e.renderItemVersion(r,s)]})),s=r},l=0;l<a.length;l++)r(l)}(),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("button",{className:"btn btn-outline-primary btn-sm button-versions",onClick:e.toggleVersions,children:"Show versions"}),Object(u.jsx)("div",{className:"versions",children:i})]})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){b.a.defaults.headers.common["X-CSRFToken"]=CSRF_TOKEN}},{key:"formatRepository",value:function(e){var t=null;return null!==e&&(t=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"name d-inline-block",children:Object(u.jsx)("a",{href:e._url,target:"_blank",children:e.full_name})}),Object(u.jsxs)("span",{style:{width:"4rem",display:"inline-block"},children:[Object(u.jsx)("ion-icon",{name:"star",style:{position:"relative",top:"2px"}}),e.stars]})]})),t}},{key:"changeStatus",value:function(e){e!==this.getStatus()&&(0,this.props.changeEntriesStatus)(this.props.entries,e)}},{key:"getStatus",value:function(){var e=this.props.entries,t=function(e){return e.recent_changes?e.recent_changes.status:null},a=t(e[e.length-1]);if(a&&"new"!==a)return a;for(var n=e.length-2;n>=0;n--){var s=t(e[n]);if(s&&"new"!==s)return"warning"===s?"warning":"new"}return"new"}},{key:"getUpdatedStatus",value:function(){var e=this.props.entries,t=e[e.length-1];return t.recent_changes?t.recent_changes.updated_status:null}},{key:"componentDidUpdate",value:function(e,t,a){if(e!==this.props){var n=this.props.entries;if(0===n.length)this.setState({squashed:null,status:null,updatedStatus:null,updatedStatusDate:null});else{var s,r=null!=n[0].request;s=r?this.formatModerationRequest(n[0]):this.squash(n);var i=r?"request":this.getStatus(),l=r?"request":this.getUpdatedStatus();null!==s&&0!==s.length||(i=null,l=null),this.setState({squashed:s,status:i,updatedStatus:l})}}t.status!==this.state.status&&this.props.onStatusChanged&&this.props.onStatusChanged(t.status,this.state.status)}},{key:"componentDidMount",value:function(){this.props.onStatusChanged&&this.props.onStatusChanged(null,this.state.status),this.componentDidUpdate({},this.state)}},{key:"componentWillUnmount",value:function(){this.props.onStatusChanged&&this.props.onStatusChanged(this.state.status,null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.entries,n=t.debugMode;if(0===a.length)return Object(u.jsx)("div",{});var s=null!=a[0].request,r=this.state,i=r.status,l=r.updatedStatus,c=r.squashed;if(null===c||0===c.length){if(!n||s)return Object(u.jsx)("div",{});i=this.getStatus(),l=this.getUpdatedStatus(),c=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("span",{className:"recent-changes-header",children:["DEBUG: empty group (id: ",a[a.length-1].recent_changes.id,")"]}),Object(u.jsx)("div",{children:this.squash([a[a.length-1]])})]})}var o=a[0].model_name,d=null;if(s)switch(a[0].request.status){case"pending":d="help-circle-outline";break;case"approved":d="checkmark-circle-outline";break;case"rejected":d="close-circle-outline";break;case"obsolete":d="ellipse-outline"}else switch(o){case"PaperGithubRepo":d="git-pull-request-outline";break;case"EvaluationTableRow":d="bar-chart";break;case"Method":case"MethodCollection":case"MethodDependency":case"MethodCollectionMember":case"PaperMethod":d="school-outline";break;case"Paper":d="document-outline";break;case"Task":case"PaperTask":case"TaskTags":d="cog-outline";break;case"Dataset":case"DatasetCollectionMember":case"DatasetVariant":case"PaperDataset":case"DatasetLoader":d="server-outline";break;case"Collection":case"CollectionItem":d="list-outline"}var h=null!==d?Object(u.jsx)("ion-icon",{name:d,style:{position:"relative",top:"2px",paddingRight:"5px"}}):null,b=function(e){return R(e).slice(11,16)}(a[a.length-1].date),j=null!==l&&i!==l?"item-updated-status":"",p=!s&&!a[a.length-1].hasOwnProperty("is_updated");return Object(u.jsxs)("div",{className:"item item-".concat(i," ").concat(j),children:[Object(u.jsx)("span",{className:"icon",children:h}),Object(u.jsxs)("span",{className:"recent-changes-header",children:["[",b,"]"]})," ",c,this.renderVersions(a),p&&Object(u.jsxs)("p",{className:"buttons",children:[Object(u.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return e.changeStatus("new")},className:"badge badge-".concat("new"===i?"info":"secondary"),children:"new"})," ",Object(u.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return e.changeStatus("ok")},className:"badge badge-".concat("ok"===i?"success":"secondary"),children:"ok"})," ",Object(u.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return e.changeStatus("warning")},className:"badge badge-".concat("warning"===i?"warning":"secondary"),children:"warning"})," "]}),p&&null!==l&&i!==l&&Object(u.jsxs)("div",{children:["The most recent status is ",l]})]})}}]),a}(p.a.Component);V.RevertibleModels=["Task","Dataset","Method","MethodCollection","Collection"];var z=V,G=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={hasError:!1,stacktrace:null},n}return Object(c.a)(a,[{key:"render",value:function(){return this.state.hasError?Object(u.jsxs)("div",{className:"item",style:{backgroundColor:"#fff0f0"},children:[Object(u.jsx)("span",{className:"recent-changes-header",style:{color:"red"},children:"Unhandled Recent Changes UI exception"}),Object(u.jsx)("h5",{children:"Stacktrace:"}),Object(u.jsx)("pre",{children:this.state.stacktrace.stack.toString()}),Object(u.jsx)("h5",{children:"Changes:"}),Object(u.jsx)("div",{children:JSON.stringify(this.props.entries)})]}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,stacktrace:e}}}]),a}(p.a.Component),W=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={statusesCounts:{}},e.groupEntries=function(e,t){var a;switch(e){case"EvaluationTableRow":a=function(e){return null!==e.fields.paper_id?[!0,e.fields.paper_id]:[!1,e.fields.evaluation_table_id]};break;case"PaperGithubRepo":case"PaperTask":case"PaperMethod":case"PaperDataset":a=function(e){return e.fields.paper_id};break;case"MethodCollectionMember":case"CollectionItem":a=function(e){return e.fields.collection_id};break;case"DatasetCollectionMember":case"TaskDataset":case"DatasetLoader":a=function(e){return e.fields.dataset_id};break;case"MethodDependency":a=function(e){return e.fields.method_id};break;case"EvaluationTableRowTag":a=function(e){return e.fields.evaluation_table_row_id};break;default:a="model_id"}var n=y.a.groupBy(t,a);return y.a.map(n,(function(t,a){var n=y.a.reject(t,"is_updated");return{date:n.length?n[n.length-1].date:t[t.length-1].date,key:"".concat(e,"-").concat(a),entries:t}}))},e.handleChildStatusChanged=function(t,a){e.setState((function(e){var n=Object(r.a)({},e.statusesCounts);return null!==t&&(n[t]=n[t]-1),null!==a&&(n[a]=(n[a]||0)+1),Object(r.a)(Object(r.a)({},e),{},{statusesCounts:n})}))},e}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){y.a.isEqual(t.statusesCounts,this.state.statusesCounts)||this.props.onStatusChanged&&this.props.onStatusChanged(this.state.statusesCounts)}},{key:"render",value:function(){for(var e=this,t=this.props,a=t.entries,s=t.isFetching,r=y.a.groupBy(a,"model_name"),l=[],c=0,o=Object.entries(r);c<o.length;c++){var d,h=Object(n.a)(o[c],2),b=h[0],j=h[1],p=this.groupEntries(b,j);(d=l).push.apply(d,Object(i.a)(p))}l=y.a.orderBy(l,"date","desc");for(var m=function(t){var a=t.key,n=t.entries;return Object(u.jsx)(G,{entries:n,children:Object(u.jsx)(z,{groupId:a,entries:n,onUserClicked:e.props.onUserClicked,onRevert:e.props.onRevert,fetchRecentChanges:e.props.fetchRecentChanges,pageFilter:e.props.pageFilter,changeEntriesStatus:e.props.changeEntriesStatus,onStatusChanged:e.handleChildStatusChanged,debugMode:e.props.debugMode},a)})},f=[],g=0;g<l.length-1;g++){f.push(m(l[g]));var v=M(l[g+1].date);v!=M(l[g].date)&&f.push(Object(u.jsx)("div",{className:"date-separator",children:v},v))}return 0!==l.length&&f.push(m(l[l.length-1])),Object(u.jsx)("div",{style:{opacity:s?.3:1},children:f.length?f:Object(u.jsx)("p",{children:s?"Loading\u2026":"No changes to show."})})}}]),a}(p.a.Component),J=a(66),Y=a.n(J),$=function(e,t,a){if(null==a||!t in e)return null;var n=y.a.get(e[t],a,null);return null===n?null:Object(r.a)(Object(r.a)({},n),n.fields)},X=function(e,t){var a,i=[],l=Object(s.a)(e);try{for(l.s();!(a=l.n()).done;){var c=a.value;if(c=Object(r.a)(Object(r.a)({},c),{},{fields:Object(r.a)({},c.fields)}),y.a.has(c,"request.params")){var o=Object(r.a)({},c.request.params);"paper_id"in o&&(o.paper=$(t,"Paper",o.paper_id)),c.request=Object(r.a)(Object(r.a)({},c.request),{},{params:o})}if("user_id"in c&&(c.user=$(t,"User",c.user_id)),"requester_id"in c&&(c.requester=$(t,"User",c.requester_id)),"moderator_id"in c&&(c.moderator=$(t,"User",c.moderator_id)),"paper_id"in c.fields&&(c.paper=$(t,"Paper",c.fields.paper_id)),"verified_paper_id"in c.fields&&(c.fields.verified_paper=$(t,"Paper",c.fields.verified_paper_id)),"githubrepo_id"in c.fields&&(c.repository=$(t,"GithubRepo",c.fields.githubrepo_id)),"task_id"in c.fields&&(c.fields.task=$(t,"Task",c.fields.task_id)),"area_id"in c.fields&&(c.fields.area=$(t,"Area",c.fields.area_id)),"tag_id"in c.fields&&("task_id"in c.fields?c.fields.tag=$(t,"Task",c.fields.tag_id):c.fields.tag=$(t,"Tag",c.fields.tag_id)),"evaluation_table_row_id"in c.fields&&(c.fields.evaluationtablerow=$(t,"EvaluationTableRow",c.fields.evaluation_table_row_id),"evaluation_table_id"in c.fields&&(c.evaluationtable=$(t,"EvaluationTable",c.fields.evaluation_table_id))),"dataset_id"in c.fields&&(c.fields.dataset=$(t,"Dataset",c.fields.dataset_id)),"method_id"in c.fields&&(c.method=$(t,"Method",c.fields.method_id)),"dependency_id"in c.fields&&(c.dependency=$(t,"Method",c.fields.dependency_id)),"collection_id"in c.fields&&("DatasetCollectionMember"===c.model_name?c.collection=$(t,"DatasetCollection",c.fields.collection_id):"MethodCollectionMember"===c.model_name?c.collection=$(t,"MethodCollection",c.fields.collection_id):"CollectionItem"===c.model_name&&(c.collection=$(t,"Collection",c.fields.collection_id))),"DatasetVariant"===c.model_name?(c.main=$(t,"Dataset",c.fields.main_id),c.variant=$(t,"Dataset",c.fields.variant_id)):"DatasetLoader"===c.model_name&&(c.fields.repository=$(t,"GithubRepo",c.fields.repo_id)),"metrics"in c.fields){var d=y.a.map(c.fields.metrics,(function(e,a){return[$(t,"Metric",a),e]}));d=y.a.filter(d,(function(e){var t=Object(n.a)(e,2),a=t[0];t[1];return null!=a})),d=y.a.map(d,(function(e){var t=Object(n.a)(e,2),a=t[0],s=t[1];return[a.name,s]})),c.fields.metrics=Object.fromEntries(d)}i.push(c)}}catch(u){l.e(u)}finally{l.f()}return i},Q=function(e,t){var a,n={},l=new Set([].concat(Object(i.a)(Object.keys(e)),Object(i.a)(Object.keys(t)))),c=Object(s.a)(l);try{for(c.s();!(a=c.n()).done;){var o=a.value;n[o]=Object(r.a)(Object(r.a)({},y.a.get(e,o,{})),y.a.get(t,o,{}))}}catch(d){c.e(d)}finally{c.f()}return n},K=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={queue:[],isFetching:!0},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onUserClicked,a=e.onRequestApproved,n=e.onRequestRejected,s=e.queue;if(e.isFetching)return Object(u.jsx)(C.a,{animation:"border",role:"status",variant:"primary",children:Object(u.jsx)("span",{className:"sr-only",children:"Loading..."})});if(0===s.length)return Object(u.jsx)("div",{className:"pb-3",children:"\ud83c\udf89 Moderation Queue is empty"});var r=y.a.map(s,(function(e){return Object(u.jsx)(z,{entries:[e],onUserClicked:t,onRequestRejected:n,onRequestApproved:a},e.request.id)}));return Object(u.jsx)("div",{children:r})}}]),a}(p.a.Component),Z=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={archiveRecords:[],denormalizedRecords:[],queue:[],denormalizedQueue:[],relatedRecords:{},last_id:null,fetched_id:null,isFetchingQueue:!0,isFetchingRecords:!1,detailsIsOpen:!1,userDetailsId:null,isBlocking:!1,blockingStatus:null,hasMorePages:null,filterAutomatic:!1,filter:null,statusesCounts:{},stats:null,debugMode:!1},e.recentChangesRequestId=0,e.updateRecords=function(t){var a=e.state,n=a.archiveRecords,s=a.queue,r=a.relatedRecords,i=Q(r,t),l=X(n,i),c=X(s,i);e.setState({denormalizedRecords:l,denormalizedQueue:c,relatedRecords:i})},e.changeEntriesStatus=function(t,a){e.recentChangesRequestId++;var n=t[t.length-1];n.recent_changes.status=a,e.updateRecords({}),b.a.patch("/api/internal/recent-changes/".concat(n.recent_changes.id,"/"),{status:a}).then((function(t){var a=t.data.stats;e.setState({stats:a})}))},e.fetchModerationQueue=function(){e.setState({isFetchingQueue:!0});b.a.get("/api/v0/moderation/queue/",{params:{filter_status:"pending",deduplicate:!0}}).then((function(t){var a=t.data,n=a.queue,s=a.related;e.setState({queue:n}),e.updateRecords(s)})).finally((function(){return e.setState({isFetchingQueue:!1})}))},e.fetchRecentChanges=function(){var t=e.props.page,a=e.state.filter;e.setState({isFetchingRecords:!0});var n={page:t,filter_status:a},s=++e.recentChangesRequestId;b.a.get("/api/v0/recent_changes/",{params:n}).then((function(t){if(s===e.recentChangesRequestId){var a=t.data,n=a.page.has_next_page,r=a.changes,i=a.related,l=a.stats;e.setState({archiveRecords:r,hasMorePages:n,stats:l}),e.updateRecords(i)}})).finally((function(){return e.setState({isFetchingRecords:!1})}))},e.openDetails=function(t){e.setState({detailsIsOpen:!0,userDetailsId:t})},e.closeDetails=function(){e.setState({detailsIsOpen:!1,blockingStatus:null})},e.onHashChanged=function(){var t=/^#?(\d*)$/.exec(location.hash);if(null!==t){var a=t[1];e.state.last_id!==a&&e.setState({last_id:a})}},e.blockUser=function(t,a){var n={user_id:t,block:a};e.setState({isBlocking:!0,blockingStatus:null}),b.a.post("/api/v0/moderation/users/block/",n).then((function(t){var a=t.data.related;e.updateRecords(a)})).catch((function(t){e.setState({blockingStatus:t.response.data.error})})).finally((function(){return e.setState({isBlocking:!1})}))},e.updateRequestProgress=function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=e.state,l=s.queue,c=s.relatedRecords,o=y.a.findIndex(l,{request:{id:t}});if(-1!==o){var d=Object(i.a)(l),u=l[o];d[o]=Object(r.a)(Object(r.a)({},u),{},{errors:n,request:Object(r.a)(Object(r.a)({},u.request),{},{progress:a})}),e.setState({queue:d,denormalizedQueue:X(d,c)})}},e.updateRevertProgress=function(t,a,n,s){var l=e.state,c=l.archiveRecords,o=l.relatedRecords,d={model_name:t,model_id:a,model_version:n},u=y.a.findIndex(c,d);if(-1!==u){var h=Object(i.a)(c),b=c[u];h[u]=Object(r.a)(Object(r.a)({},b),{},{revert:{progress:s}});var j=X(h,o);e.setState({archiveRecords:h,denormalizedRecords:j})}},e.handleRequestApproval=function(t,a){var n={request_id:t,approve:a};e.updateRequestProgress(t,a?"approving":"rejecting"),b.a.post("/api/v0/moderation/queue/",n).then((function(t){var a=t.data,n=a.queue,s=a.related,r=e.state.queue,l=[].concat(Object(i.a)(n),Object(i.a)(r));l=y.a.uniqBy(l,"request.id"),l=y.a.orderBy(l,"request.id","desc"),e.setState({queue:l}),e.updateRecords(s)})).catch((function(a){var n=a.response.data;e.updateRequestProgress(t,null,n)}))},e.handleRevert=function(t,a,n,r){var l={model_name:t,model_id:a,model_version:n,current_model_version:r};e.updateRevertProgress(t,a,n,"reverting"),b.a.post("/api/v0/moderation/revert/",l).then((function(r){var l,c=r.data,o=c.changes,d=c.related,u=e.state.archiveRecords,h=Object(s.a)(o);try{for(h.s();!(l=h.n()).done;){l.value.is_updated=!0}}catch(b){h.e(b)}finally{h.f()}e.setState({archiveRecords:[].concat(Object(i.a)(u),Object(i.a)(o))}),e.updateRecords(d),e.updateRevertProgress(t,a,n,"reverted")})).catch((function(r){if(r.response&&409===r.response.status){var l,c=r.response.data,o=c.changes,d=c.related,u=e.state.archiveRecords,h=Object(s.a)(o);try{for(h.s();!(l=h.n()).done;){l.value.is_updated=!0}}catch(b){h.e(b)}finally{h.f()}e.setState({archiveRecords:[].concat(Object(i.a)(u),Object(i.a)(o))}),e.updateRecords(d),e.updateRevertProgress(t,a,n,"refresh")}else e.updateRevertProgress(t,a,n,"error")}))},e.formatUserDetails=function(t){if(null===t)return null;var a=e.state.relatedRecords.User[t];if(null===a)return null;a=Object(r.a)(Object(r.a)({},a),a.fields);var n,s=e.state,i=s.isBlocking,l=s.blockingStatus;if(a.moderator)n=Object(u.jsx)("div",{children:"This user is a moderator"});else{var c=i?Object(u.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):null;n=Object(u.jsxs)("button",{className:"btn btn-outline-danger button-block",onClick:function(){return e.blockUser(a.model_id,a.active)},children:[c,i?"":a.active?"Block":"Unblock"]})}var o=Object(u.jsx)("div",{children:l});return Object(u.jsxs)("div",{className:"user-details-modal",children:[Object(u.jsxs)("div",{children:["Username: ",a.username]}),Object(u.jsxs)("div",{children:["Email: ",Object(u.jsx)("a",{href:"mailto:".concat(a.email),children:a.email})]}),Object(u.jsxs)("div",{children:["Active: ",a.active?"yes":"no"]}),Object(u.jsxs)("div",{children:["Joined: ",T(a.joined)]}),n,o]})},e.notify=function(e){"granted"===Notification.permission&&new Notification("Papers with Code",{icon:"/static/logo.png",body:e})},e.handleUserClicked=function(t){e.openDetails(t)},e.getPagination=function(){var t=e.props.page;null==t&&(t=1);var a,n,s=e.state,r=s.denormalizedRecords,i=s.hasMorePages;if(0===r.length)a="\u2026",n=!0;else{var l=y.a.orderBy(r,["model_id","date"],["asc","desc"]),c=y.a.map(y.a.uniqBy(l,"model_id"),"date");a=M(new Date(y.a.max(c))),n=!1}return[n,Object(u.jsx)(g.a,{className:"justify-content-center",children:Object(u.jsxs)(v.a,{className:"text-center",children:[Object(u.jsxs)(v.a.First,{href:"/recent_changes/1",disabled:t<=1,children:[Object(u.jsx)("span",{"aria-hidden":"true",children:"\xab"}),"Newest"]}),Object(u.jsxs)(v.a.Item,{href:t>1?"/recent_changes/".concat(t-1):null,disabled:t<=1,children:[Object(u.jsx)("span",{"aria-hidden":"true",children:"\u2039"}),"Newer"]}),Object(u.jsx)(v.a.Item,{children:a}),Object(u.jsxs)(v.a.Item,{href:i?"/recent_changes/".concat(t+1):null,disabled:!i,children:["Older",Object(u.jsx)("span",{"aria-hidden":"true",children:"\u203a"})]})]})})]},e.renderEntries=function(){var t,a=e.state,n=a.denormalizedRecords,s=a.filterAutomatic,r=a.isFetchingRecords;if(s){var l=y.a.groupBy(n,(function(e){return"".concat(e.model_name,"-").concat(e.model_id)}));t=[];for(var c=0,o=Object.values(l);c<o.length;c++){var d,h=o[c];if(!y.a.every(h,(function(e){return null==e.user_id})))(d=t).push.apply(d,Object(i.a)(h))}}else t=n;return Object(u.jsx)(W,{entries:t,onUserClicked:e.handleUserClicked,onRevert:e.handleRevert,fetchRecentChanges:e.fetchRecentChanges,pageFilter:e.state.filter,changeEntriesStatus:e.changeEntriesStatus,setFilter:e.setFilter,onStatusChanged:e.handleEntriesStatusChanged,isFetching:r,debugMode:e.state.debugMode})},e.handleFilterAutomatic=function(t){e.setState({filterAutomatic:t})},e.setFilter=function(t){e.setState({filter:t})},e.handleEntriesStatusChanged=function(t){e.setState({statusesCounts:t})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){Y.a.setAppElement("body"),b.a.defaults.headers.common["X-CSRFToken"]=this.props.csrfToken;var e="true"===localStorage.getItem("filterAutomatic");e!==this.state.filterAutomatic&&this.setState({filterAutomatic:e});var t=localStorage.getItem("filter");t!==this.state.filter&&["all","to-review","warnings","ok"].includes(t)&&this.setState({filter:t}),this.fetchModerationQueue(),window.addEventListener("hashchange",this.onHashChanged,!1),null!=new URLSearchParams(window.location.search).get("debug")&&this.setState({debugMode:!0})}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.state,s=n.filterAutomatic,r=n.filter,i=this.props.page,l=t.filterAutomatic,c=t.filter;s!==l&&localStorage.setItem("filterAutomatic",s),r!==c&&(localStorage.setItem("filter",r),null!=c&&1!==i?(this.setState({isFetchingRecords:!0}),window.location.pathname="/recent_changes/1"):this.fetchRecentChanges())}},{key:"renderFilters",value:function(){var e=this,t=this.state,a=t.filter,n=t.stats,s=null!==n?n.new:0,r=null!==n?n.warnings:0,i=function(e){return e?Object(u.jsx)("span",{className:"badge badge-pill badge-light",children:e}):null};return Object(u.jsx)(g.a,{children:Object(u.jsx)(O.a,{xs:12,children:Object(u.jsxs)("ul",{className:"nav nav-tabs",children:[Object(u.jsx)("li",{onClick:function(){return e.setFilter("all")},className:"nav-item",children:Object(u.jsx)("a",{className:"nav-link  ".concat("all"===a?"active":""),children:"all"})})," ",Object(u.jsx)("li",{onClick:function(){return e.setFilter("to-review")},className:"nav-item",children:Object(u.jsxs)("a",{className:"nav-link ".concat("to-review"===a?"active":""),children:["to review ",i(s+r)]})})," ",Object(u.jsx)("li",{onClick:function(){return e.setFilter("warnings")},className:"nav-item",children:Object(u.jsxs)("a",{className:"nav-link ".concat("warnings"===a?"active":""),children:["warnings ",i(r)]})}),Object(u.jsx)("li",{onClick:function(){return e.setFilter("ok")},className:"nav-item",children:Object(u.jsx)("a",{className:"nav-link ".concat("ok"===a?"active":""),children:"ok"})})]})})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.filterAutomatic,s=t.denormalizedQueue,r=t.isFetchingQueue,i=(t.filter,this.getPagination()),l=Object(n.a)(i,2),c=l[0],o=l[1];return Object(u.jsxs)("div",{className:"mb-4 w-100 recent-changes-list",children:[Object(u.jsx)(g.a,{className:"title md-3",children:Object(u.jsx)(O.a,{xs:12,children:Object(u.jsx)("h1",{className:"md-0",children:"Recent Changes"})})}),o,Object(u.jsx)(g.a,{className:"md-3",children:Object(u.jsx)(O.a,{xs:4,children:Object(u.jsx)(f,{filterAutomatic:a,onFilterAutomatic:this.handleFilterAutomatic})})}),Object(u.jsx)(K,{onUserClicked:this.handleUserClicked,onRequestRejected:function(t){return e.handleRequestApproval(t,!1)},onRequestApproved:function(t){return e.handleRequestApproval(t,!0)},isFetching:r,queue:s}),this.renderFilters(),this.renderEntries(),!c&&o,this.renderUserModal()]})}},{key:"renderUserModal",value:function(){var e=this.state,t=e.userDetailsId,a=e.detailsIsOpen;return Object(u.jsx)(Y.a,{className:"Modal__Bootstrap modal-dialog recent-changes-user-dialog",isOpen:a,shouldCloseOnOverlayClick:!0,onRequestClose:this.closeDetails,children:Object(u.jsxs)("div",{className:"modal-content",children:[Object(u.jsxs)("div",{className:"modal-header",children:[Object(u.jsx)("h4",{className:"modal-title",children:"User Details"}),Object(u.jsxs)("button",{type:"button",className:"close",onClick:this.closeDetails,children:[Object(u.jsx)("span",{"aria-hidden":"true",children:"\xd7"}),Object(u.jsx)("span",{className:"sr-only",children:"Close"})]})]}),Object(u.jsx)("div",{className:"modal-body",children:this.formatUserDetails(t)}),Object(u.jsx)("div",{className:"modal-footer",children:Object(u.jsx)("button",{className:"btn btn-primary",onClick:this.closeDetails,children:"Close"})})]})})}}]),a}(p.a.Component);t.default=Z},360:function(e,t,a){"use strict";a.r(t);var n=a(12),s=a(13),r=a(15),i=a(14),l=a(18),c=a(0),o=a(1),d=a.n(o),u=a(17),h=a.n(u),b=a(26),j=a(73),p=a(67),m=a.n(p),f=a(56),g=a(7),v=function(e){return e},O=function(e){return Object(c.jsx)("span",{children:e})},x=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;Object(n.a)(this,a),(s=t.call(this,e)).resetHighlightInBlob=function(){s.props.setHighlightInBlob(null,null,null)},s.handleChangeAllBlobs=function(e,t){if(e.preventDefault(),"metric"===s.props.highlightInBlob.name){var a="suggestMetric"+t;s.setState(Object(b.a)({},a,[]))}else if("task"===s.props.highlightInBlob.name){var n="suggestTask"+t;s.setState(Object(b.a)({},n,[]))}else if("dataset"===s.props.highlightInBlob.name){var r="suggestDataset"+t;s.setState(Object(b.a)({},r,[]))}s.props.handleChangeAllBlobs(t),s.resetHighlightInBlob()},s.viewReviewBlobs=function(){var e=[Object(c.jsx)("div",{ref:"ref-filler"},"ref-filler")],t={};s.props.tableData.map((function(e,a){var n=e.metadata.table;n in t?t[n]++:t[n]=1}));var a=[];if(s.props.tableData.map((function(n,r){var i=n.model,l=n.task,o=n.dataset,d=n.metric,u=n.value,h=n.metadata,j=s.props.highlightInBlob,p=h.table+"-"+h.index[0]+"-"+h.index[1],x=s.state["suggestTask"+r],y=s.state["suggestDataset"+r],w=s.state["suggestMetric"+r],k={placeholder:"",value:l,onChange:function(e,t){var a=t.newValue;t.method;s.props.handleChangeNameIdxValue(e,"task",r,a)},onBlur:function(e,t){t.highlightedSuggestion;s.resetHighlightInBlob()}},N={placeholder:"",value:o,onChange:function(e,t){var a=t.newValue;t.method;s.props.handleChangeNameIdxValue(e,"dataset",r,a)},onBlur:function(e,t){t.highlightedSuggestion;s.resetHighlightInBlob()}},C={placeholder:"",value:d,onChange:function(e,t){var a=t.newValue;t.method;s.props.handleChangeNameIdxValue(e,"metric",r,a)},onBlur:function(e,t){t.highlightedSuggestion;s.resetHighlightInBlob()}},_="review-blob";r==s.props.reviewHlRow&&(_+=" review-highlight");var S=Object(c.jsx)("span",{className:g({"blob-changeall":!0,"blob-changeall-show":"model"===j.name&&j.idx===r&&t[h.table]>1}),children:Object(c.jsx)("button",{onMouseDown:function(e){return s.handleChangeAllBlobs(e,r)},onClick:function(e){return e.preventDefault()},children:"Change all"})}),D=Object(c.jsx)("span",{className:g({"blob-changeall":!0,"blob-changeall-show":"task"===j.name&&j.idx===r&&t[h.table]>1}),children:Object(c.jsx)("button",{onMouseDown:function(e){return s.handleChangeAllBlobs(e,r)},onClick:function(e){return e.preventDefault()},children:"Change all"})}),R=Object(c.jsx)("span",{className:g({"blob-changeall":!0,"blob-changeall-show":"dataset"===j.name&&j.idx===r&&t[h.table]>1}),children:Object(c.jsx)("button",{onMouseDown:function(e){return s.handleChangeAllBlobs(e,r)},onClick:function(e){return e.preventDefault()},children:"Change all"})}),M=Object(c.jsx)("span",{className:g({"blob-changeall":!0,"blob-changeall-show":"metric"===j.name&&j.idx===r&&t[h.table]>1}),children:Object(c.jsx)("button",{onMouseDown:function(e){return s.handleChangeAllBlobs(e,r)},onClick:function(e){return e.preventDefault()},children:"Change all"})}),T="";!1===h.validity.task&&(T="New");var I="";!1===h.validity.dataset&&(I="New");var E="";!1===h.validity.tdm&&(E="New"),!1===h.validity.tdm&&!1===h.validity.td&&(T="New",I="New");var P=s.props.existingMetrics(l,o).join(", ");""!==P&&(P="Existing metrics: "+P);var A=Object(c.jsx)("span",{className:g({"blob-new":!0,"blob-new-show":""!==E}),"data-tip":P,children:E}),L=Object(c.jsx)("span",{className:g({"blob-new":!0,"blob-new-show":""!==T}),children:T}),q=Object(c.jsx)("span",{className:g({"blob-new":!0,"blob-new-show":""!==I}),children:I}),F=!1,B=Object(c.jsx)("div",{className:"blob-left-border-yellow"});h.table<0?(B=Object(c.jsx)("div",{className:"blob-left-border-gray"}),F=!0):"is_approved"in h&&!0===h.is_approved&&(B=Object(c.jsx)("div",{className:"blob-left-border-green"})),p===s.state.dataRefHl&&(_+=" review-highlight"),s.props.evaluationtablerowHl!==h.evaluationtablerow_id||s.props.unsavedChanges||(_+=" review-pulse");var U="",H=l.toLowerCase()+"||"+o.toLowerCase();if(H in s.props.hash.table){var V=s.props.hash.table[H];U=Object(c.jsx)("span",{className:"table-outlink",children:Object(c.jsx)("a",{href:V.url,target:"_blank",children:Object(c.jsx)("i",{className:"fas fa-external-link-alt"})})})}var z="",G=l.toLowerCase();if(G in s.props.hash.task_url){var W=s.props.hash.task_url[G];z=Object(c.jsx)("span",{className:"table-outlink",children:Object(c.jsx)("a",{href:W,target:"_blank",children:Object(c.jsx)("i",{className:"fas fa-external-link-alt"})})})}var J=Object(c.jsxs)("div",{className:_,ref:"blob-"+p+"-"+r,"data-col-id":p,onMouseEnter:function(e){return s.reviewCellHover(p)},onMouseLeave:function(e){return s.reviewCellHover(null)},children:[B,Object(c.jsxs)("div",{className:"blob-block blob-first",children:[Object(c.jsx)("div",{className:"blob-header",children:"Value"}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)("input",{type:"text",id:"in_value_"+r,value:u,"data-col-id":p,onChange:s.handleChange,className:"blob-input-value"})})]}),Object(c.jsxs)("div",{className:"blob-block",children:[Object(c.jsxs)("div",{className:"blob-header",children:["Metric ",A," ",M]}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)(m.a,{id:"ac_metric_"+r,suggestions:w,onSuggestionsFetchRequested:function(e){var t="suggestMetric"+r;s.filterSuggestions("metrics",e.value,t),s.props.setHighlightInBlob("metric",h.table,r)},onSuggestionsClearRequested:function(){var e="suggestMetric"+r;s.setState(Object(b.a)({},e,[]))},getSuggestionValue:v,renderSuggestion:O,inputProps:C})})]}),Object(c.jsxs)("div",{className:g({"blob-block":!0}),children:[Object(c.jsxs)("div",{className:"blob-header",children:["Model name ",S]}),Object(c.jsx)("div",{className:"blob-input blob-model",children:Object(c.jsx)("input",{type:"text",id:"in_model_"+r,value:i,onFocus:function(e){return s.props.setHighlightInBlob("model",h.table,r)},onBlur:function(e){return s.resetHighlightInBlob()},onChange:s.handleChange})})]}),Object(c.jsxs)("div",{className:"blob-block",children:[Object(c.jsxs)("div",{className:"blob-header",children:["Dataset ",U,q," ",R]}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)(m.a,{id:"ac_dataset_"+r,suggestions:y,onSuggestionsFetchRequested:function(e){var t="suggestDataset"+r;s.filterSuggestions("datasets",e.value,t),s.props.setHighlightInBlob("dataset",h.table,r)},onSuggestionsClearRequested:function(){var e="suggestDataset"+r;s.setState(Object(b.a)({},e,[]))},getSuggestionValue:v,renderSuggestion:O,inputProps:N})})]}),Object(c.jsxs)("div",{className:"blob-block",children:[Object(c.jsxs)("div",{className:"blob-header",children:["Task ",z,L," ",D]}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)(m.a,{id:"ac_task_"+r,suggestions:x,onSuggestionsFetchRequested:function(e){var t="suggestTask"+r;s.filterSuggestions("tasks",e.value,t),s.props.setHighlightInBlob("task",h.table,r)},onSuggestionsClearRequested:function(){var e="suggestTask"+r;s.setState(Object(b.a)({},e,[]))},getSuggestionValue:v,renderSuggestion:O,inputProps:k})})]}),Object(c.jsx)("div",{className:"blob-block blob-no-left-padding",children:Object(c.jsx)("div",{className:"blob-x",children:Object(c.jsx)("i",{className:"fas fa-times-circle","data-idx":r,onClick:s.props.handleRemoveBlob})})}),Object(c.jsx)(f.a,{})]},"blobkey-"+p+"-"+r);F?a.push(J):e.push(J)})),s.props.referencesData.map((function(t,a){if(0!==Object.keys(t).length){var n,r=0,i=[],o=Object(l.a)(t.data);try{for(o.s();!(n=o.n()).done;){var d,u=n.value,h=Object(l.a)(u);try{for(h.s();!(d=h.n()).done;){var b=d.value;"verified"in b&&("review"in b.verified?"add"===b.verified.review&&r++:"verified"in b.verified&&r++,"evaluationtablerow_id"in b.verified&&i.push(b.verified.evaluationtablerow_id))}}catch(m){h.e(m)}finally{h.f()}}}catch(m){o.e(m)}finally{o.f()}var j="review-blob";i.indexOf(s.props.evaluationtablerowHl)>=0&&!s.props.unsavedChanges&&(j+=" review-pulse");var p=Object(c.jsxs)("div",{className:j,ref:"references-"+a,"data-idx":a,children:[Object(c.jsx)("div",{className:"blob-left-border-blue"}),Object(c.jsxs)("div",{className:"blob-block blob-first",children:[Object(c.jsx)("div",{className:"blob-header",children:"Parsed references"}),Object(c.jsxs)("div",{className:"blob-input blob-input-references",children:[Object(c.jsx)("button",{"data-idx":a,onClick:s.handleEditParseReferences,children:"Edit"}),"\xa0",r," values imported."]})]}),Object(c.jsx)("div",{className:"blob-block blob-no-left-padding",children:Object(c.jsx)("div",{className:"blob-x",children:Object(c.jsx)("i",{className:"fas fa-times-circle","data-idx":a,onClick:s.props.handleRemoveReferencesBlob})})}),Object(c.jsx)(f.a,{})]},"referenceskey-"+a);e.push(p)}})),a.length>0){var n=Object(c.jsxs)("div",{className:"review-blob",ref:"gray-0","data-idx":0,children:[Object(c.jsx)("div",{className:"blob-left-border-gray"}),Object(c.jsxs)("div",{className:"blob-block blob-first",children:[Object(c.jsx)("div",{className:"blob-header",children:"Unmatched results"}),Object(c.jsxs)("div",{className:"blob-input blob-input-gray",children:[Object(c.jsx)("button",{"data-idx":0,onClick:s.handleGrayClick,children:"Edit"}),"\xa0",a.length," results not in paper tables."]})]}),Object(c.jsx)(f.a,{})]},"referenceskey-0");e.push(n)}return e},s.handleEditParseReferences=function(e){e.preventDefault();var t=parseInt(e.target.getAttribute("data-idx"));s.props.openModal(s.props.referencesData[t])},s.handleGrayClick=function(e){e.preventDefault(),s.props.openGrayBlobsModal()},s.handleChange=function(e){var t=e.target,a=t.id.split("_"),n=a[1],r=parseInt(a[2]),i=t.value;Object(b.a)({},n,i);s.props.handleChangeNameIdxValue(e,n,r,i)},s.filterSuggestions=function(e,t,a){var n=s.props.autosuggests[e],r=[],i=t.toLowerCase();n.map((function(e,t){e.toLowerCase().includes(i)&&r.push(e)})),r.sort((function(e,t){return e.length-t.length})),r.length>10&&(r=r.slice(0,10)),s.setState(Object(b.a)({},a,r))},s.onSuggestionsFetchRequested=function(e){var t=e.value;s.setState({suggestions:getSuggestions(t)})},s.onSuggestionsClearRequested=function(){s.setState({suggestions:[]})},s.state={dataRefHl:null};for(var r=0;r<1e3;r++)s.state["suggestTask"+r]=[],s.state["suggestDataset"+r]=[],s.state["suggestMetric"+r]=[];return s.handleChange=s.handleChange.bind(Object(j.a)(s)),s}return Object(s.a)(a,[{key:"reviewCellHover",value:function(e){this.setState({dataRefHl:e}),this.props.reviewCellHover(e)}},{key:"renderView",value:function(){return Object(c.jsx)("div",{className:"review-blobs",children:this.viewReviewBlobs()})}},{key:"render",value:function(){return Object(c.jsx)("div",{className:"review-container",children:this.renderView()})}},{key:"componentDidMount",value:function(){this.props.updateBlobRefs(this.refs)}},{key:"componentDidUpdate",value:function(){this.props.layoutBlobs()}}]),a}(d.a.Component),y=a(8),w=a(7),k=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).handleParseReferenceOnClick=function(e,t){e.preventDefault(),s.props.handleParseReferenceOnClick(t)},s}return Object(s.a)(a,[{key:"generateRows",value:function(e,t){var a=this,n=[],s=[],r=[],i=[],o=[],d=/(?:[+-]?(?:(?:\d{1,3}(?:,\d{3})+|\d+)(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)/g;this.props.tableData.map((function(e,t){var n=e.metadata,i=n.table+"-"+n.index[0]+"-"+n.index[1];"is_approved"in n&&!0===n.is_approved?s.push(i):r.push(i),a.props.evaluationtablerowHl===n.evaluationtablerow_id&&o.push(i)}));for(var u=0;u<this.props.referencesData.length;u++){var h=this.props.referencesData[u];if(0!==Object.keys(h).length)for(var b=0;b<h.data.length;b++)for(var j=h.data[b],p=0;p<j.length;p++){var m=u+"-"+b+"-"+p,f=j[p],g=!1;"verified"in f&&("review"in f.verified?"add"===f.verified.review&&(g=!0):"verified"in f.verified&&(g=!0),"evaluationtablerow_id"in f.verified&&f.verified.evaluationtablerow_id===this.props.evaluationtablerowHl&&o.push(m)),g&&i.push(m)}}var v,O=0,x=Object(l.a)(t.data);try{for(x.s();!(v=x.n()).done;){var w,k=v.value,N=[],C=0,_=Object(l.a)(k);try{var S=function(){var n=w.value,l="".concat(e,"-").concat(O,"-").concat(C),u=t.formatted_data[O][C],h=null;if(-1!==u.indexOf("span-cb")){for(var b=[],j=k.length,p=C;p<j&&-1===t.formatted_data[O][p].indexOf("span-ce");)b.push.apply(b,Object(y.a)(t.formatted_data[O][p].split(" "))),p++;p<j&&b.push.apply(b,Object(y.a)(t.formatted_data[O][p].split(" "))),h=p-C+1,u=Object(y.a)(new Set(b)).join(" ")}else if(-1!==u.indexOf("span-ci")||-1!==u.indexOf("span-ce"))return C++,"continue";var m="arxiv-cell";s.indexOf(l)>-1&&(m="highlight-green"),r.indexOf(l)>-1&&(m="highlight-yellow"),i.indexOf(l)>-1&&(m="highlight-blue"),l===a.props.arxivHlId&&(m+=" highlight-hover-green"),o.indexOf(l)>-1&&!a.props.unsavedChanges&&(i.indexOf(l)>-1?m+=" review-pulse-blue":m+=" review-pulse-green"),"proposals"in n&&(m+=" arxiv-addable");var f=function(e){a.props.arxivCellClick(e,l,"td"+l)},g=n.value,v=((g||"").match(d)||[]).length;s.filter((function(e){return e===l})).length+r.filter((function(e){return e===l})).length+i.filter((function(e){return e===l})).length>=v&&(f=null);var x=n.html;g.startsWith("\\")&&(g="",x=""),N.push(Object(c.jsx)("td",{className:u,"data-col-id":l,ref:"ref-"+l,colSpan:h,children:Object(c.jsx)("span",{className:m,ref:"td"+l,"data-col-id":l,onClick:f,onMouseEnter:function(e){return a.props.arxivCellHover(l,"td"+l)},onMouseLeave:function(e){return a.props.arxivCellHover(null)},children:"undefined"===typeof n.html||""===n.html?g:Object(c.jsx)("span",{dangerouslySetInnerHTML:{__html:x}})})},l)),C++};for(_.s();!(w=_.n()).done;)S()}catch(R){_.e(R)}finally{_.f()}var D="".concat(e,"-").concat(O);n.push(Object(c.jsx)("tr",{className:"","data-row-id":D,children:N},O)),O++}}catch(R){x.e(R)}finally{x.f()}return n}},{key:"generateTables",value:function(){var e=this,t=[];if(0===this.props.arxivTables.length)return Object(c.jsx)("div",{className:"alert alert-info",children:"No tables found in the paper."});var a,n=Object(l.a)(this.props.arxivTables);try{var s=function(){var n=a.value;t.push(Object(c.jsx)("b",{dangerouslySetInnerHTML:{__html:n.title}},"table-title-".concat(n.id)));var s=!e.props.arxivParseReferences[n.id]&&!n.hasReferences,r=!e.props.arxivParseReferences[n.id];t.push(Object(c.jsx)("div",{className:"parse-references",children:Object(c.jsx)("button",{disabled:r,className:w({hide:s}),onClick:function(t){e.handleParseReferenceOnClick(t,n.id)},children:"Parse references"})},"div-ref"+n.id)),t.push(Object(c.jsx)("table",{className:"table",children:Object(c.jsx)("tbody",{children:e.generateRows(n.id,n.zipped_data)})},n.id))};for(n.s();!(a=n.n()).done;)s()}catch(r){n.e(r)}finally{n.f()}return t}},{key:"render",value:function(){return Object(c.jsx)("div",{className:"arxiv-table tableWrapper",children:this.generateTables()})}},{key:"componentDidMount",value:function(){this.props.updateArxivRefs(this.refs)}}]),a}(d.a.Component),N=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).handleHelpClicked=function(e){e.preventDefault(),s.props.onHelp()},s.handleSaveClicked=function(e){e.preventDefault(),s.props.setSaving(!0),s.props.onSave(s.props.tableData,s.props.referencesData,s.props.unsavedChanges,s.props.handleResultsSaved,s.props.handleSaveError)},s}return Object(s.a)(a,[{key:"render",value:function(){var e=null;this.props.savingError?e=Object(c.jsx)("span",{className:"saving-error",children:"There was an error during saving, please retry"}):this.props.unsavedChanges?e=Object(c.jsx)("span",{className:"unsaved-changes",children:"Unsaved changes"}):this.props.saved&&(e=Object(c.jsx)("span",{className:"saved-changes",children:"All changes saved"}));var t="Save";document.getElementById("annotate-next-link")&&(t="Save & Next");var a=Object(c.jsx)("i",{className:"fas fa-save"});this.props.saving&&(a=Object(c.jsx)("img",{src:"/static/spin-1s-24px-green.gif"}));var n="save-review-button";return this.props.isUserLoggedIn||(t="Login/Register to save edits",a=Object(c.jsx)("i",{className:"fas fa-lock-alt"}),n="login-review-button"),Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:"text-left w-25 d-inline-block",children:Object(c.jsxs)("button",{className:"help-button",onClick:this.handleHelpClicked,children:[Object(c.jsx)("i",{className:"fas fa-question-circle"}),"\xa0 Help"]})}),Object(c.jsxs)("div",{className:"text-right w-75 d-inline-block",children:[e,Object(c.jsxs)("button",{className:n,onClick:this.handleSaveClicked,children:[a,"\xa0 ",t]})]})]})}}]),a}(d.a.Component),C=a(264),_=a(7),S=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){e.node.contains(t.target)||e.props.proposals.length>0&&e.closeProposals()},e.closeProposals=function(){e.props.arxivCellClick(null,null,null)},e.addNewAnnotation=function(t){t.preventDefault();var a=parseInt(t.target.getAttribute("data-idx"));e.props.addNewAnnotation(e.props.proposals[a]),e.closeProposals()},e.addWithEmptyProposal=function(t,a){e.props.addNewAnnotation({model:"",task:"",value:t,dataset:"",metric:"",metadata:a}),e.closeProposals()},e}return Object(s.a)(a,[{key:"componentWillMount",value:function(){document.addEventListener("mousedown",this.handleClick,!1)}},{key:"componentWillUnMount",value:function(){document.removeEventListener("mousedown",this.handleClick,!1)}},{key:"render",value:function(){var e=this,t="",a={};if(this.props.proposals.length>0){var n=h.a.findDOMNode(this.props.proposalsRef).getBoundingClientRect(),s=n.top+window.scrollY,r=n.right+window.scrollX,i=window.document.body.offsetHeight;s+250>i&&(s-=s+250-i),a={position:"absolute",top:s,left:r,border:"2px solid #04CD00"};var l=this.props.proposals,o=[],d="",u={},b=1,j=C("#00C52B"),p={};l.map((function(t,a){d=t.value,u=t.metadata,b=t.confidence,p={backgroundColor:j.lighten(1-b),borderColor:j.lighten(1-b)},o.push(Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:Object(c.jsx)("button",{className:_({"add-annotation-button":!0,"add-annotation-button-10":b>.9,"add-annotation-button-05":b<=.9&&b>.3,"add-annotation-button-00":b<=.3}),"data-idx":a,onClick:e.addNewAnnotation,style:p,children:"->"})}),Object(c.jsx)("td",{children:t.value}),Object(c.jsx)("td",{children:t.metric}),Object(c.jsx)("td",{children:t.model}),Object(c.jsx)("td",{children:t.dataset}),Object(c.jsx)("td",{children:t.task})]},"proposal-"+a))})),t=Object(c.jsxs)("div",{className:"arxiv-proposals-container",children:[Object(c.jsx)("div",{className:"arxiv-proposals-caption",children:"Annotate as:"}),Object(c.jsxs)("table",{children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{}),Object(c.jsx)("th",{children:"Value"}),Object(c.jsx)("th",{children:"Metric"}),Object(c.jsx)("th",{children:"Model"}),Object(c.jsx)("th",{children:"Dataset"}),Object(c.jsx)("th",{children:"Task"})]})}),Object(c.jsx)("tbody",{children:o})]}),Object(c.jsxs)("div",{className:"arxiv-proposals-footer",children:["None of these are right?\xa0",Object(c.jsx)("a",{href:"#",onClick:function(t){t.preventDefault(),e.addWithEmptyProposal(parseFloat(d),u)},children:"Click here to add a custom annotation"})]})]})}return Object(c.jsx)("div",{className:"arxiv-add-wrap",style:a,ref:function(t){return e.node=t},children:t})}}]),a}(d.a.Component),D=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).handleModelChange=function(e){var t=e.target.getAttribute("data-col-id").split("-"),a=parseInt(t[1]),n=parseInt(t[2]),r=e.target.value,i=s.state.modalData;"editable"in i.data[a][n]&&(i.data[a][n].editable.value=r),s.setState({modalData:i})},s.handleCellClick=function(e){var t=e.target.parentNode.getAttribute("data-col-id").split("-"),a=parseInt(t[1]),n=parseInt(t[2]),r=s.state.modalData;"verified"in r.data[a][n]&&("review"in r.data[a][n].verified?"add"===r.data[a][n].verified.review?r.data[a][n].verified.review="remove":r.data[a][n].verified.review="add":"verified"in r.data[a][n].verified?r.data[a][n].verified.review="remove":r.data[a][n].verified.review="add"),s.setState({modalData:r})},s.handleSaveClicked=function(e){s.props.handleAcceptParsedReferences(s.state.modalData),s.props.closeModal()},s.state={modalData:s.props.modalData},s}return Object(s.a)(a,[{key:"generateRows",value:function(){var e=[],t=this.state.modalData,a=[],n=[];this.props.tableData.map((function(e,s){var r=e.metadata;if(r.table===t.tableId){var i="modal-"+r.index[0]+"-"+r.index[1];"is_approved"in r&&!0===r.is_approved?a.push(i):n.push(i)}}));var s,r=0,i="modal",o=Object(l.a)(t.data);try{for(o.s();!(s=o.n()).done;){var d,u=s.value,h=[],b=0,j=!1,p=Object(l.a)(u);try{for(p.s();!(d=p.n()).done;){var m=d.value,f="".concat(i,"-").concat(r,"-").concat(b),g=t.formatted_data[r][b],v="arxiv-cell",O=null;if(-1!==g.indexOf("span-cb")){for(var x=[],w=u.length,k=b;k<w&&-1===t.formatted_data[r][k].indexOf("span-ce");)x.push.apply(x,Object(y.a)(t.formatted_data[r][k].split(" "))),k++;k<w&&x.push.apply(x,Object(y.a)(t.formatted_data[r][k].split(" "))),O=k-b+1,g=Object(y.a)(new Set(x)).join(" ")}else if(-1!==g.indexOf("span-ci")||-1!==g.indexOf("span-ce")){b++;continue}"verified"in m&&"verified"in m.verified?"review"in m.verified&&"remove"===m.verified.review?v+=" arxiv-addable-ref":v="highlight-blue":"verified"in m&&"review"in m.verified&&"add"===m.verified.review?v="highlight-blue":a.indexOf(f)>-1?v="highlight-green":n.indexOf(f)>-1?v="highlight-yellow":j&&"verified"in m&&(v+=" arxiv-addable-ref");var N="";if("verified"in m&&"otherValues"in m.verified&&m.verified.otherValues.length>0){N="NOTE other values found in leadearboard:";var C,_=Object(l.a)(m.verified.otherValues);try{for(_.s();!(C=_.n()).done;){var S=C.value;N+="<br/>"+S.metric+": "+S.value}}catch(E){_.e(E)}finally{_.f()}v+=" red-border",console.log(N)}"fixed"in m&&(N="Task: "+m.fixed.task+"<br/>Dataset: "+m.fixed.dataset+"<br/>Metric: "+m.fixed.metric);var D="";if("editable"in m){j=!0;var R=m.value;"value"in m.editable&&(R=m.editable.value);var M="";if("pwcSlug"in m.editable){var T="/paper/"+m.editable.pwcSlug;M=Object(c.jsxs)("span",{children:["\xa0\xa0",Object(c.jsx)("a",{href:T,target:"_blank",children:Object(c.jsx)("i",{className:"fas fa-external-link-alt"})})]})}D=Object(c.jsxs)("span",{children:[Object(c.jsx)("input",{type:"text",value:R,"data-col-id":f,onChange:this.handleModelChange,className:"arxiv-ref-input-value"}),M]})}else D=Object(c.jsx)("span",{className:v,ref:"td"+f,"data-col-id":f,onClick:this.handleCellClick,"data-tip":N,children:"undefined"===typeof m.html||""===m.html?m.value:Object(c.jsx)("span",{"data-col-id":f,dangerouslySetInnerHTML:{__html:m.html}})});h.push(Object(c.jsx)("td",{className:g,"data-col-id":f,ref:"ref-"+f,colSpan:O,children:D},f)),b++}}catch(E){p.e(E)}finally{p.f()}var I="".concat(i,"-").concat(r);e.push(Object(c.jsx)("tr",{className:"","data-row-id":I,children:h},r)),r++}}catch(E){o.e(E)}finally{o.f()}return e}},{key:"render",value:function(){return Object(c.jsxs)("div",{className:"modal-content parse-references-modal",children:[Object(c.jsxs)("div",{className:"modal-header",children:[Object(c.jsx)("h4",{className:"modal-title",children:"Import results for referenced papers"}),Object(c.jsxs)("button",{type:"button",className:"close",onClick:this.props.closeModal,children:[Object(c.jsx)("span",{"aria-hidden":"true",children:"\xd7"}),Object(c.jsx)("span",{className:"sr-only",children:"Close"})]})]}),Object(c.jsx)("div",{className:"modal-body",children:Object(c.jsx)("div",{className:"arxiv-table tableWrapper",children:Object(c.jsx)("table",{className:"table",children:Object(c.jsx)("tbody",{children:this.generateRows()})})})}),Object(c.jsx)("div",{className:"modal-footer",children:Object(c.jsx)("button",{type:"button",onClick:this.handleSaveClicked,children:"Accept"})}),Object(c.jsx)(f.a,{html:!0})]})}}]),a}(d.a.Component),R=a(19),M=a.n(R),T=a(66),I=a.n(T),E=a(7),P=function(e){return e},A=function(e){return Object(c.jsx)("span",{children:e})},L=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;Object(n.a)(this,a),(s=t.call(this,e)).filterSuggestions=function(e,t,a){var n=s.props.autosuggests[e],r=[],i=t.toLowerCase();n.map((function(e,t){e.toLowerCase().includes(i)&&r.push(e)})),r.sort((function(e,t){return e.length-t.length})),r.length>10&&(r=r.slice(0,10)),s.setState(Object(b.a)({},a,r))},s.onSuggestionsFetchRequested=function(e){var t=e.value;s.setState({suggestions:getSuggestions(t)})},s.onSuggestionsClearRequested=function(){s.setState({suggestions:[]})},s.handleChange=function(e){var t=e.target,a=t.id.split("_"),n=a[1],r=parseInt(a[2]),i=t.value;s.handleChangeNameIdxValue(e,n,r,i)},s.handleChangeNameIdxValue=function(e,t,a,n){var r=s.state.tableData;r[a][t]=n,r=s.props.recalculateTableDataValidity(r,s.props.hash),s.setState({tableData:r})},s.handleRemoveBlob=function(e){var t=parseInt(e.target.getAttribute("data-idx")),a=s.state.tableData;a.splice(t,1),s.setState({tableData:a})},s.handleSaveClicked=function(){s.props.setNewTable(s.state.tableData),s.props.closeGrayBlobsModal()},s.state={suggestions:[],tableData:JSON.parse(JSON.stringify(s.props.tableData))};for(var r=0;r<1e3;r++)s.state["suggestTask"+r]=[],s.state["suggestDataset"+r]=[],s.state["suggestMetric"+r]=[];return s}return Object(s.a)(a,[{key:"generateRows",value:function(){var e=this,t=[];return this.state.tableData.map((function(a,n){var s=a.model,r=a.task,i=a.dataset,l=a.metric,o=a.value,d=a.metadata;if(d.table<0){var u=d.table+"-"+d.index[0]+"-"+d.index[1],h=e.state["suggestTask"+n],j=e.state["suggestDataset"+n],p=e.state["suggestMetric"+n],g={placeholder:"",value:r,onChange:function(t,a){var s=a.newValue;a.method;e.handleChangeNameIdxValue(t,"task",n,s)}},v={placeholder:"",value:i,onChange:function(t,a){var s=a.newValue;a.method;e.handleChangeNameIdxValue(t,"dataset",n,s)}},O={placeholder:"",value:l,onChange:function(t,a){var s=a.newValue;a.method;e.handleChangeNameIdxValue(t,"metric",n,s)}},x="";!1===d.validity.task&&(x="New");var y="";!1===d.validity.dataset&&(y="New");var w="";!1===d.validity.tdm&&(w="New"),!1===d.validity.tdm&&!1===d.validity.td&&(x="New",y="New");var k=e.props.existingMetrics(r,i).join(", ");""!==k&&(k="Existing metrics: "+k);var N=Object(c.jsx)("span",{className:E({"blob-new":!0,"blob-new-show":""!==w}),"data-tip":k,children:w}),C=Object(c.jsx)("span",{className:E({"blob-new":!0,"blob-new-show":""!==x}),children:x}),_=Object(c.jsx)("span",{className:E({"blob-new":!0,"blob-new-show":""!==y}),children:y}),S=Object(c.jsx)("div",{className:"blob-left-border-gray"}),D="",R=r.toLowerCase()+"||"+i.toLowerCase();if(R in e.props.hash.table){var M=e.props.hash.table[R];D=Object(c.jsx)("span",{className:"table-outlink",children:Object(c.jsx)("a",{href:M.url,target:"_blank",children:Object(c.jsx)("i",{className:"fas fa-external-link-alt"})})})}var T="",I=r.toLowerCase();if(I in e.props.hash.task_url){var L=e.props.hash.task_url[I];T=Object(c.jsx)("span",{className:"table-outlink",children:Object(c.jsx)("a",{href:L,target:"_blank",children:Object(c.jsx)("i",{className:"fas fa-external-link-alt"})})})}var q=Object(c.jsxs)("div",{className:"review-blob",ref:"blob-"+u+"-"+n,"data-col-id":u,children:[S,Object(c.jsxs)("div",{className:"blob-block blob-first",children:[Object(c.jsx)("div",{className:"blob-header",children:"Value"}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)("input",{type:"text",id:"in_value_"+n,value:o,"data-col-id":u,onChange:e.handleChange,className:"blob-input-value"})})]}),Object(c.jsxs)("div",{className:"blob-block",children:[Object(c.jsxs)("div",{className:"blob-header",children:["Metric ",N]}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)(m.a,{id:"ac_metric_"+n,suggestions:p,onSuggestionsFetchRequested:function(t){var a="suggestMetric"+n;e.filterSuggestions("metrics",t.value,a)},onSuggestionsClearRequested:function(){var t="suggestMetric"+n;e.setState(Object(b.a)({},t,[]))},getSuggestionValue:P,renderSuggestion:A,inputProps:O})})]}),Object(c.jsxs)("div",{className:E({"blob-block":!0}),children:[Object(c.jsx)("div",{className:"blob-header",children:"Model name"}),Object(c.jsx)("div",{className:"blob-input blob-model",children:Object(c.jsx)("input",{type:"text",id:"in_model_"+n,value:s,onChange:e.handleChange})})]}),Object(c.jsxs)("div",{className:"blob-block",children:[Object(c.jsxs)("div",{className:"blob-header",children:["Dataset ",D,_]}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)(m.a,{id:"ac_dataset_"+n,suggestions:j,onSuggestionsFetchRequested:function(t){var a="suggestDataset"+n;e.filterSuggestions("datasets",t.value,a)},onSuggestionsClearRequested:function(){var t="suggestDataset"+n;e.setState(Object(b.a)({},t,[]))},getSuggestionValue:P,renderSuggestion:A,inputProps:v})})]}),Object(c.jsxs)("div",{className:"blob-block",children:[Object(c.jsxs)("div",{className:"blob-header",children:["Task ",T,C]}),Object(c.jsx)("div",{className:"blob-input",children:Object(c.jsx)(m.a,{id:"ac_task_"+n,suggestions:h,onSuggestionsFetchRequested:function(t){var a="suggestTask"+n;e.filterSuggestions("tasks",t.value,a)},onSuggestionsClearRequested:function(){var t="suggestTask"+n;e.setState(Object(b.a)({},t,[]))},getSuggestionValue:P,renderSuggestion:A,inputProps:g})})]}),Object(c.jsx)("div",{className:"blob-block blob-no-left-padding",children:Object(c.jsx)("div",{className:"blob-x",children:Object(c.jsx)("i",{className:"fas fa-times-circle","data-idx":n,onClick:e.handleRemoveBlob})})}),Object(c.jsx)(f.a,{})]},"blobkey-"+u+"-"+n);t.push(q)}})),t}},{key:"render",value:function(){return Object(c.jsxs)("div",{className:"modal-content-gray gray-blobs-modal",children:[Object(c.jsxs)("div",{className:"modal-header",children:[Object(c.jsx)("h4",{className:"modal-title",children:"Additional results not present in paper's tables"}),Object(c.jsxs)("button",{type:"button",className:"close",onClick:this.props.closeModal,children:[Object(c.jsx)("span",{"aria-hidden":"true",children:"\xd7"}),Object(c.jsx)("span",{className:"sr-only",children:"Close"})]})]}),Object(c.jsx)("div",{className:"modal-body",children:Object(c.jsx)("div",{className:"manual-review",children:this.generateRows()})}),Object(c.jsx)("div",{className:"modal-footer",children:Object(c.jsx)("button",{type:"button",onClick:this.handleSaveClicked,children:"Accept"})})]})}}]),a}(d.a.Component),q=a(68),F=function(e,t){var a=e.task.toLowerCase(),n=e.dataset.toLowerCase(),s=a+"||"+n+"||"+e.metric.toLowerCase(),r=a+"||"+n;return{task:a in t.task,dataset:n in t.dataset,td:r in t.td,tdm:s in t.tdm}},B=function(e,t){for(var a=0;a<e.length;a++)e[a].metadata.validity=F(e[a],t);return e},U=function(e){return e.sort((function(e,t){return 1e4*(e.metadata.table-t.metadata.table)+100*(parseInt(e.metadata.index[0])-parseInt(t.metadata.index[0]))+(parseInt(e.metadata.index[1])-parseInt(t.metadata.index[1]))})),e},H=function(e,t,a){var n=new Array(e.length).fill(!1);return e.map((function(e,s){var r=e.metadata.table;r>=0&&t[r].hasReferences&&!("data"in a[r])&&(n[r]=!0)})),n},V=function(e,t){if(e.length!==t.length)return!0;for(var a=0;a<e.length;a++){for(var n=e[a],s=t[a],r=0,i=["model","task","dataset","value","metric"];r<i.length;r++){var l=i[r];if(n[l]!==s[l])return!0}if(n.metadata.table>=0){if(n.metadata.table!==s.metadata.table)return!0;if(n.metadata.index[0]!==s.metadata.index[0]&&n.metadata.index[1]!==s.metadata.index[1])return!0}}return!1},z=document.getElementById("sota-review-table-wrap");void 0!==z&&I.a.setAppElement(z);var G=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;Object(n.a)(this,a),(s=t.call(this,e)).openModal=function(e){s.setState({modalData:e,modalIsOpen:!0})},s.closeModal=function(){s.setState({modalData:{},modalIsOpen:!1})},s.openGrayBlobsModal=function(e){s.setState({grayBlobsModalIsOpen:!0})},s.closeGrayBlobsModal=function(){s.setState({grayBlobsModalIsOpen:!1})},s.openHelp=function(){s.setState({helpIsOpen:!0})},s.closeHelp=function(){s.setState({helpIsOpen:!1})},s.handleModalCloseRequest=function(){s.setState({modalIsOpen:!1})},s.exitEdit=function(){s.setState({appState:"view"})},s.startEdit=function(){s.setState({appState:"edit"})},s.reviewCellHover=function(e){s.setState({arxivHlId:e})},s.arxivCellClick=function(e,t,a){if(null===t)s.setState({proposals:[],proposalRef:null});else{var n=t.split("-"),r=n[0],i=n[1],l=n[2],c=s.state.arxivTables[r].zipped_data.data[i][l];"proposals"in c&&(e.metaKey?s.addNewAnnotation(c.proposals[0],t):s.setState({proposals:c.proposals,proposalsRef:s.state.arxivRefs[a]}))}},s.arxivCellHover=function(e,t){null===e?s.setState({reviewHlRow:null}):s.state.tableData.map((function(t,a){var n=t.metadata;n.table+"-"+n.index[0]+"-"+n.index[1]===e&&s.setState({reviewHlRow:a})}))},s.getNonOverlappingSpace=function(e,t,a){for(var n=!0;n;){n=!1;var s,r=Object(l.a)(e);try{for(r.s();!(s=r.n()).done;){var i=s.value;if(t>=i.top&&t<=i.bottom||a<=i.bottom&&a>=i.top){n=!0;var c=i.bottom-t+15;t+=c,a+=c}}}catch(o){r.e(o)}finally{r.f()}}return{top:t,bottom:a}},s.layoutBlobs=function(){var e=-1;if(null!=s.state.arxivRefs&&null!=s.state.blobRefs){var t=[];if("gray-0"in s.state.blobRefs){var a={top:186-window.scrollY}.top+window.scrollY-86,n=s.state.blobRefs["gray-0"],r=a+n.getBoundingClientRect().height,i=s.getNonOverlappingSpace(t,a,r);t.push({top:i.top,bottom:i.bottom}),n.setAttribute("style","position:absolute;top:"+i.top+"px")}s.state.referencesData.map((function(a,n){var r=a.tableId;if(void 0!==r){var i=r+"-0-0",c=h.a.findDOMNode(s.state.arxivRefs["ref-"+i]),o={top:186-window.scrollY};null!==c&&(o=c.getBoundingClientRect());var d=o.top+window.scrollY-86,u=s.state.blobRefs["references-"+r],b=d+u.getBoundingClientRect().height,j=s.getNonOverlappingSpace(t,d,b);t.push({top:j.top,bottom:j.bottom}),u.setAttribute("style","position:absolute;top:"+j.top+"px");var p,m=[],f=Object(l.a)(a.data);try{for(f.s();!(p=f.n()).done;){var g,v=p.value,O=Object(l.a)(v);try{for(O.s();!(g=O.n()).done;){var x=g.value;"verified"in x&&"evaluationtablerow_id"in x.verified&&m.push(x.verified.evaluationtablerow_id)}}catch(y){O.e(y)}finally{O.f()}}}catch(y){f.e(y)}finally{f.f()}m.indexOf(s.props.evaluationtablerowHl)>=0&&(e<0||d<e)&&(e=d)}}));var c={};for(var o in s.state.blobRefs)if("ref-filler"!==o){var d=o.replace("blob-","").replace(/-\d*$/,"");c[d]=c[d]||[],c[d].push(s.state.blobRefs[o])}var u,b={},j=Object(l.a)(s.state.tableData);try{for(j.s();!(u=j.n()).done;){var p=u.value.metadata,m=p.table+"-"+p.index[0]+"-"+p.index[1];if(!(m in b)&&!(p.table<0)){b[m]=!0;var f=h.a.findDOMNode(s.state.arxivRefs["ref-"+m]),g={top:186-window.scrollY};null!==f&&(g=f.getBoundingClientRect());var v,O=Object(l.a)(c[m]);try{for(O.s();!(v=O.n()).done;){var x=v.value,y=g.top+window.scrollY-86,w=y+x.getBoundingClientRect().height,k=s.getNonOverlappingSpace(t,y,w);t.push({top:k.top,bottom:k.bottom}),x.setAttribute("style","position:absolute;top:"+k.top+"px"),s.props.evaluationtablerowHl===p.evaluationtablerow_id&&(e<0||y<e)&&(e=y)}}catch(N){O.e(N)}finally{O.f()}}}}catch(N){j.e(N)}finally{j.f()}}e>0&&s.state.initialLayout&&(s.setState({initialLayout:!1}),q.animateScroll.scrollTo(e))},s.updateArxivRefs=function(e){s.setState({arxivRefs:e})},s.updateBlobRefs=function(e){s.setState({blobRefs:e})},s.addNewAnnotation=function(e,t){var a=JSON.parse(JSON.stringify(s.state.tableData));void 0===t&&(t=s.state.proposalsRef.getAttribute("data-col-id"));var n=t.split("-"),r=n[0],i=n[1],l=n[2],c={model:e.model,task:e.task,dataset:e.dataset,metric:e.metric,value:parseFloat(e.value),metadata:{table:parseInt(r),index:[i,l]}};c.metadata.validity=F(c,s.hash),a.push(c),a=U(a);var o=s.state.referencesData;o[r]={},s.setState({tableData:a,unsavedChanges:!0,referencesData:o,arxivParseReferences:H(a,s.state.arxivTables,o)}),s.setHighlightInBlob(null,null,null)},s.handleChangeAllBlobs=function(e){for(var t=s.state.tableData,a=s.state.highlightInBlob,n=t[e][a.name],r=0;r<t.length;r++)r!==e&&t[r].metadata.table===a.table&&(t[r][a.name]=n);t=B(t,s.hash),s.setState({tableData:t,arxivParseReferences:H(t,s.state.arxivTables,s.state.referencesData)})},s.setHighlightInBlob=function(e,t,a){s.state.highlightInBlob.idx!==a&&s.state.highlightInBlob.name!==e&&s.setState({highlightInBlob:{name:e,table:t,idx:a}})},s.handleParseReferenceOnClick=function(e){var t=[];s.state.tableData.map((function(a,n){a.metadata.table==e&&t.push(a)})),M.a.post(s.props.parseReferencesUrl,{tableId:e,annotations:t}).then((function(e){console.log(e.data),s.openModal(e.data)})).catch((function(e){console.log(e)}))},s.handleAcceptParsedReferences=function(e){var t=s.state.referencesData;t[e.tableId]=e,s.setState({referencesData:t,arxivParseReferences:H(s.state.tableData,s.state.arxivTables,t)})},s.setNewTable=function(e){s.setState({tableData:e,unsavedChanges:V(e,s.state.originalTableData)})},s.setUnsavedChanges=function(e){s.setState({unsavedChanges:e})},s.handleChangeNameIdxValue=function(e,t,a,n){var r=s.state.tableData;if(r[a][t]=n,!1===s.state.unsavedChanges&&n!==s.state.originalTableData[a][t]&&s.setState({unsavedChanges:!0}),r=B(r,s.hash),"model"!==t){var i=r[a].metadata.table,l=s.state.referencesData;l[i]={},s.setState({referencesData:l,arxivParseReferences:H(r,s.state.arxivTables,l)})}else s.setState({tableData:r});s.setHighlightInBlob(t,r[a].metadata.table,a)},s.handleRemoveBlob=function(e){var t=parseInt(e.target.getAttribute("data-idx")),a=s.state.tableData,n=a[t].metadata.table;a.splice(t,1);var r=s.state.referencesData;r[n]={},s.setState({tableData:a,referencesData:r,unsavedChanges:!0,arxivParseReferences:H(a,s.state.arxivTables,r),arxivHlId:null}),s.setHighlightInBlob(null,null,null)},s.handleRemoveReferencesBlob=function(e){var t=parseInt(e.target.getAttribute("data-idx")),a=s.state.referencesData;a[t]={},s.setState({referencesData:a,unsavedChanges:!0,arxivParseReferences:H(s.state.tableData,s.state.arxivTables,a)}),s.setHighlightInBlob(null,null,null)},s.handleResultsSaved=function(e,t,a){if(s.props.isUserLoggedIn){console.log("saved and references updated"),s.setState({saved:!0,unsavedChanges:!1,saving:!1,savingError:!1,referencesData:a});var n=document.getElementById("annotate-next-link");n&&window.location.replace(n.href)}else s.setState({redirectToLogin:!0}),window.location.replace(s.props.loginUrl)},s.handleSaveError=function(){console.error("unable to save results"),s.setState({saving:!1,savingError:!0})},s.existingMetrics=function(e,t){var a=e.toLowerCase()+"||"+t.toLowerCase();return a in s.hash.existing?s.hash.existing[a]:[]},s.setSaving=function(e){s.setState({saving:e})},s.autosuggests=e.autosuggests;var r={},i={},c={},o={},d={},u={};s.autosuggests.tdm.map((function(e,t){var a=e.task.toLowerCase()+"||"+e.dataset.toLowerCase()+"||"+e.metric.toLowerCase();r[a]=!0;var n=e.task.toLowerCase()+"||"+e.dataset.toLowerCase();i[n]=!0,n in d||(d[n]=[]),d[n].push(e.metric)})),s.autosuggests.tasks.map((function(e,t){c[e.toLowerCase()]=!0})),s.autosuggests.datasets.map((function(e,t){o[e.toLowerCase()]=!0})),s.autosuggests.tables.map((function(e,t){var a=e.task.toLowerCase()+"||"+e.dataset.toLowerCase();u[a]=e})),s.hash={tdm:r,td:i,task:c,dataset:o,existing:d,table:u,task_url:s.autosuggests.task_url};var b=U(e.extractedResults);b=B(b,s.hash);var j=function(e){var t,a=[],n=Object(l.a)(e);try{for(n.s();!(t=n.n()).done;){var s,r=t.value,i=r.zipped_data,c=!1,o=0,d=Object(l.a)(i.data);try{for(d.s();!(s=d.n()).done;){var u,h=s.value,b=0,j=Object(l.a)(h);try{for(j.s();!(u=j.n()).done;){var p=u.value;if("references"in p){var m,f=Object(l.a)(p.references);try{for(f.s();!(m=f.n()).done;)!("pwcSlug"in m.value)||0!==o&&0!==b||(c=!0)}catch(g){f.e(g)}finally{f.f()}}b++}}catch(g){j.e(g)}finally{j.f()}o++}}catch(g){d.e(g)}finally{d.f()}r.hasReferences=c,a.push(r)}}catch(g){n.e(g)}finally{n.f()}return a}(e.arxivTables),p=H(b,j,s.props.referencesData);s.state={appState:"edit",reviewHlRow:null,arxivHlId:null,arxivTables:j,arxivParseReferences:p,tableData:b,arxivRefs:null,blobRefs:null,unsavedChanges:s.props.unsavedChanged,originalTableData:JSON.parse(JSON.stringify(b)),proposals:[],proposalsRef:null,saved:!1,highlightInBlob:{name:null,table:null,idx:null},saving:!1,savingError:!1,modalIsOpen:!1,helpIsOpen:!1,modalData:{},referencesData:s.props.referencesData,grayBlobsExpanded:!1,grayBlobsModalIsOpen:!1,redirectToLogin:!1,evaluationtablerowHl:s.props.evaluationtablerowHl,initialLayout:!0},s.tableContainer=e.tableContainer,s.arxivContainer=e.arxivContainer,s.footerContainer=e.footerContainer,s.arxivAddContainer=e.arxivAddContainer,s.arxivModalContainer=e.arxivModalContainer,s.grayBlobsModalContainer=e.grayBlobsModalContainer,s.isUserLoggedIn=e.isUserLoggedIn;var m=document.getElementById("review-help-content");return s.helpContent=void 0!==m?m.innerHTML:"",s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.beforeunload.bind(this)),q.Events.scrollEvent.register("begin",(function(e,t){console.log("begin",arguments)})),q.Events.scrollEvent.register("end",(function(e,t){console.log("end",arguments)})),q.scrollSpy.update(),this.renderChildren()}},{key:"renderChildren",value:function(){h.a.render(Object(c.jsx)(k,{arxivHlId:this.state.arxivHlId,arxivCellHover:this.arxivCellHover,arxivCellClick:this.arxivCellClick,updateArxivRefs:this.updateArxivRefs,tableData:this.state.tableData,arxivTables:this.state.arxivTables,arxivParseReferences:this.state.arxivParseReferences,handleParseReferenceOnClick:this.handleParseReferenceOnClick,referencesData:this.state.referencesData,evaluationtablerowHl:this.state.evaluationtablerowHl,unsavedChanges:this.state.unsavedChanges}),this.arxivContainer),h.a.render(Object(c.jsx)(x,{reviewHlRow:this.state.reviewHlRow,appState:this.state.appState,reviewCellHover:this.reviewCellHover,tableData:this.state.tableData,originalTableData:this.state.originalTableData,updateBlobRefs:this.updateBlobRefs,autocomplete:this.props.autocomplete,onSave:this.props.onSave,unsavedChanges:this.state.unsavedChanges,handleChangeNameIdxValue:this.handleChangeNameIdxValue,handleRemoveBlob:this.handleRemoveBlob,layoutBlobs:this.layoutBlobs,highlightInBlob:this.state.highlightInBlob,setHighlightInBlob:this.setHighlightInBlob,handleChangeAllBlobs:this.handleChangeAllBlobs,autosuggests:this.autosuggests,hash:this.hash,existingMetrics:this.existingMetrics,referencesData:this.state.referencesData,openModal:this.openModal,handleRemoveReferencesBlob:this.handleRemoveReferencesBlob,openGrayBlobsModal:this.openGrayBlobsModal,evaluationtablerowHl:this.state.evaluationtablerowHl}),this.tableContainer),h.a.render(Object(c.jsx)(N,{onSave:this.props.onSave,onHelp:this.openHelp,tableData:this.state.tableData,unsavedChanges:this.state.unsavedChanges,savingError:this.state.savingError,handleResultsSaved:this.handleResultsSaved,handleSaveError:this.handleSaveError,saved:this.state.saved,saving:this.state.saving,setSaving:this.setSaving,referencesData:this.state.referencesData,isUserLoggedIn:this.props.isUserLoggedIn,loginUrl:this.props.loginUrl}),this.footerContainer),h.a.render(Object(c.jsx)(S,{proposals:this.state.proposals,proposalsRef:this.state.proposalsRef,arxivCellClick:this.arxivCellClick,addNewAnnotation:this.addNewAnnotation}),this.arxivAddContainer),h.a.render(Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(I.a,{className:"Modal__Bootstrap modal-dialog",closeTimeoutMS:150,isOpen:this.state.modalIsOpen,onRequestClose:this.handleModalCloseRequest,shouldCloseOnOverlayClick:!1,children:Object(c.jsx)(D,{modalData:this.state.modalData,closeModal:this.closeModal,tableData:this.state.tableData,handleAcceptParsedReferences:this.handleAcceptParsedReferences})}),Object(c.jsx)(I.a,{className:"Modal__Bootstrap modal-dialog extraction-help-dialog",closeTimeoutMS:150,isOpen:this.state.helpIsOpen,shouldCloseOnOverlayClick:!0,onRequestClose:this.closeHelp,children:Object(c.jsxs)("div",{className:"modal-content",children:[Object(c.jsxs)("div",{className:"modal-header",children:[Object(c.jsx)("h4",{className:"modal-title",children:"Help"}),Object(c.jsxs)("button",{type:"button",className:"close",onClick:this.closeHelp,children:[Object(c.jsx)("span",{"aria-hidden":"true",children:"\xd7"}),Object(c.jsx)("span",{className:"sr-only",children:"Close"})]})]}),Object(c.jsx)("div",{className:"modal-body",dangerouslySetInnerHTML:{__html:this.helpContent}})]})})]}),this.arxivModalContainer),h.a.render(Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(I.a,{className:"Modal__Bootstrap modal-dialog",closeTimeoutMS:150,isOpen:this.state.grayBlobsModalIsOpen,onRequestClose:this.closeGrayBlobsModal,shouldCloseOnOverlayClick:!1,children:Object(c.jsx)(L,{closeModal:this.closeGrayBlobsModal,tableData:this.state.tableData,handleChangeNameIdxValue:this.handleChangeNameIdxValue,autocomplete:this.props.autocomplete,handleRemoveBlob:this.handleRemoveBlob,autosuggests:this.autosuggests,hash:this.hash,existingMetrics:this.existingMetrics,recalculateTableDataValidity:B,closeGrayBlobsModal:this.closeGrayBlobsModal,setNewTable:this.setNewTable})})}),this.grayBlobsModalContainer)}},{key:"componentDidUpdate",value:function(){this.renderChildren()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.beforeunload.bind(this)),q.Events.scrollEvent.remove("begin"),q.Events.scrollEvent.remove("end")}},{key:"beforeunload",value:function(e){this.state.unsavedChanges&&!this.state.redirectToLogin&&(e.preventDefault(),e.returnValue=!0)}},{key:"render",value:function(){return null}}]),a}(d.a.Component),W=new(function(){function e(){Object(n.a)(this,e),this.container=null}return Object(s.a)(e,[{key:"show",value:function(e){e.appContainer;var t=e.taskAutocompleteUrl,a=e.datasetAutocompleteUrl,n=e.metricAutocompleteUrl,s=e.onSave,r=e.arxivTables,i=e.extractedResults,l=e.arxivContainer,o=e.tableContainer,d=e.footerContainer,u=e.arxivAddContainer,b=e.autosuggests,j=e.parseReferencesUrl,p=e.arxivModalContainer,m=e.referencesData,f=e.isUserLoggedIn,g=e.loginUrl,v=e.grayBlobsModalContainer,O=e.unsavedChanged,x=e.evaluationtablerowHl;this.container=o,this.arxivContainer=l,this.footerContainer=d,this.arxivAddContainer=u,this.arxivModalContainer=p,this.grayBlobsModalContainer=v;var y={taskAutocompleteUrl:t,datasetAutocompleteUrl:a,metricAutocompleteUrl:n};this.component=Object(c.jsx)(G,{arxivTables:r,extractedResults:i,arxivContainer:l,footerContainer:d,tableContainer:o,arxivAddContainer:u,autocomplete:y,autosuggests:b,onSave:s,parseReferencesUrl:j,arxivModalContainer:p,referencesData:m,isUserLoggedIn:f,loginUrl:g,grayBlobsModalContainer:v,unsavedChanged:O,evaluationtablerowHl:x}),h.a.render(this.component,document.createElement("div"))}}]),e}());t.default=W},361:function(e,t,a){"use strict";a.r(t);var n=a(8),s=a(5),r=a(12),i=a(13),l=a(15),c=a(14),o=a(0),d=a(19),u=a.n(d),h=a(9),b=a(167),j=a(1),p=a.n(j),m=a(200),f=a(371),g=a(69);function v(e){if(!e)return!1;var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}p.a.Component;var O=a(18),x=a(37),y=a(372),w=a(375),k=a(65),N=a(168),C=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))).sortingOptions={"github-stars":{slug:"github-stars",value:"best_papergithubrepo__githubrepo__stars",label:"Github Stars",defaultDirection:"desc"},"published-date":{slug:"published-date",value:"published",label:"Published Date",defaultDirection:"desc"},title:{slug:"title",value:"title",label:"Title",defaultDirection:"asc"}},e.defaultOptions=[{label:"All tasks \u279c",value:"tasksList"},{label:"All authors \u279c",value:"authorsList"}],e.state={order:{field:Object.values(e.sortingOptions)[0],direction:"desc"},tasksList:[],authorsList:[],loaded:!1,inputString:"",defaultOptions:e.defaultOptions,filters:[],maxMenuHeight:500},e.hasSearchString=!1,e.loadEntities=function(t){var a=e.props.proceedingSlug;return u.a.get("/api/v0/".concat(t),{params:{proceeding_slug:a}}).then((function(e){return e.data}))},e.loadOptions=Object(h.debounce)((function(t,a){var n=e.state,s=n.tasksList,r=n.authorsList,i=t.toLowerCase(),l=e.findEntities(s,i),c=e.findEntities(r,i),o=e.hasSearchString?[]:[{label:t,value:t,type:"search-string"}];l.length&&o.push({label:"Tasks",options:l}),c.length&&o.push({label:"Authors",options:c}),a(o)}),200),e.onFiltersChange=function(t,a){if(!a.option||"authorsList"!==a.option.value&&"tasksList"!==a.option.value){e.setState({filters:t});var n={search:null,tasks:[],authors:[]};t=t||[];var s,r=Object(O.a)(t);try{for(r.s();!(s=r.n()).done;){var i=s.value;"search-string"===i.type?n.search=i.value:"task"===i.type?n.tasks.push(i.value):"author"===i.type&&n.authors.push(i.value)}}catch(l){r.e(l)}finally{r.f()}e.hasSearchString=null!==n.search,e.props.onFiltersChange&&e.props.onFiltersChange(n)}else e.setState({defaultOptions:e.state[a.option.value]})},e.onInputChange=function(t){e.setState({defaultOptions:e.defaultOptions})},e.onOrderFieldChange=function(t){if(t!==e.state.order.field.slug){var a=e.sortingOptions[t];e.setState({order:{field:a,direction:a.defaultDirection}},e.onOrderChange)}},e.onOrderDirectionChange=function(){var t=e.state.order;e.setState({order:{field:t.field,direction:"asc"===t.direction?"desc":"asc"}},e.onOrderChange)},e.onOrderChange=function(){if(e.props.onOrderChange){var t=e.state.order,a="asc"===t.direction?"":"-";a+=t.field.value,e.props.onOrderChange(a)}},e.colourStyles={multiValue:function(e,t){var a=t.data.type,n="#cce5ff";return"task"===a?n="#d4edda":"author"===a&&(n="#f8d7da"),Object(s.a)(Object(s.a)({},e),{},{backgroundColor:n})},multiValueLabel:function(e,t){var a=t.data.type,n="#004085";return"task"===a?n="#155724":"author"===a&&(n="#721c24"),Object(s.a)(Object(s.a)({},e),{},{color:n})},option:function(e,t){var a=t.data.value;return"tasksList"!==a&&"authorsList"!==a||(e=Object(s.a)(Object(s.a)({},e),{},{fontWeight:"bold"})),e}},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;Promise.all([this.loadEntities("tasks"),this.loadEntities("authors")]).then((function(t){var a=t[0],n=t[1];function s(e){return e.toLowerCase().replace(/[^a-zA-Z]/g," ").split(" ").filter((function(e){return e}))}e.setState({tasksList:a.map((function(e){return{value:e.id,type:"task",label:e.name,searchField:s(e.name)}})),authorsList:n.map((function(e){return{value:e.id,type:"author",label:e.full_name,searchField:s(e.full_name)}})),loaded:!0})}))}},{key:"findEntities",value:function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,s=[],r=Object(O.a)(e);try{for(r.s();!(a=r.n()).done;){var i=a.value;if(Object(h.some)(i.searchField,(function(e){return e.startsWith(t)}))&&(s.push(i),0===--n))break}}catch(l){r.e(l)}finally{r.f()}return s}},{key:"render",value:function(){return Object(o.jsxs)(x.a,{className:"omnisearch",inline:!0,onSubmit:function(e){return e.preventDefault()},children:[Object(o.jsx)(N.a,{value:this.state.filters,isDisabled:!this.state.loaded,className:"flex-grow-1 mr-md-3 mb-3 mb-md-0",placeholder:"Filter by task, author or keyword",isMulti:!0,closeMenuOnSelect:!1,maxMenuHeight:this.state.maxMenuHeight,defaultOptions:this.state.defaultOptions,loadOptions:this.loadOptions,onChange:this.onFiltersChange,onInputChange:this.onInputChange,styles:this.colourStyles,classNamePrefix:"omnisearch"}),Object(o.jsxs)(y.a,{className:"omnisearch__order-selector mt-0",children:[Object(o.jsxs)(w.a,{className:"mt-0 flex-grow-1 btn-group",onSelect:this.onOrderFieldChange,children:[Object(o.jsxs)(w.a.Toggle,{id:"order-field-selector",variant:"light",className:"pr-4 my-0",children:[this.state.order.field.label,Object(o.jsx)("i",{className:"fa fa-chevron-down"})]}),Object(o.jsx)(w.a.Menu,{children:Object.values(this.sortingOptions).map((function(e){return Object(o.jsx)(w.a.Item,{eventKey:e.slug,children:e.label},e.slug)}))})]}),Object(o.jsx)(k.a,{className:"omnisearch__order-selector__direction my-0",variant:"light",onClick:this.onOrderDirectionChange,children:Object(o.jsx)("i",{className:"sort-arrow fas ".concat("asc"===this.state.order.direction?"fa-arrow-alt-up":"fa-arrow-alt-down")})})]})]})}}]),a}(p.a.Component);C.defaultProps={proceedingSlug:null,onOrderChange:null,onFiltersChange:null};function _(e){if(!e)return!1;var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}var S=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(r.a)(this,a);for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];return(e=t.call.apply(t,[this].concat(l))).requestId=0,e.loadingMore=!1,e.loadMoreRef=p.a.createRef(),e.state={loading:!0,loadMoreLoading:!1,itemsCount:0,lastDate:"3000-01-01",items:[],authorFullName:"",authorThumbnail:"",authorLink:""},e.updateAuthorItems=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.data.map((function(e){var t=new Date(e.published),a=t.getDate(),n=t.toLocaleString("default",{month:"short"}),r=t.getFullYear(),i="".concat(a," ").concat(n," ").concat(r);return Object(s.a)(Object(s.a)({},e),{},{publishedDateString:i})})),l=t.meta,c=l.itemsCount,o=l.lastDate;o=o.substring(0,10),e.setState({loading:!1,loadMoreLoading:!1,items:r?[].concat(Object(n.a)(a),Object(n.a)(i)):Object(n.a)(i),itemsCount:c,lastDate:o},e.handleScroll)},e.fetchItems=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.props.authorId,n=e.state,s=n.items,r=n.lastDate;e.setState({loading:!t,loadMoreLoading:t},(function(){var n=++e.requestId;u.a.get("/api/v0/author_items/",{params:{author_id:a,last_date:r}}).then((function(a){n===e.requestId&&e.updateAuthorItems(a.data,s,t)}))}))},e.updateAuthorInfo=function(t){e.setState({authorFullName:t.full_name,authorThumbnail:t.thumbnail,authorLink:t.link})},e.fetchAuthor=function(){var t=e.props.authorId;u.a.get("/api/v0/authors/",{params:{author_id:t}}).then((function(t){e.updateAuthorInfo(t.data)}))},e.handleScroll=Object(h.throttle)((function(t){var a=e.state,n=a.itemsCount,s=a.items,r=a.loadMoreLoading;_(e.loadMoreRef.current)&&n>s.length&&!r&&e.setState({loadMoreLoading:!0},(function(){return e.fetchItems(!0)}))}),200),e}return Object(i.a)(a,[{key:"codeButton",value:function(e){if(1==e.has_code){var t="";return e.official_stars>=0&&(t=Object(o.jsxs)("span",{className:"official-stars",children:[Object(o.jsx)("span",{style:{fontSize:"11px"},children:"("}),Object(o.jsx)("ion-icon",{name:"star"}),e.official_stars,Object(o.jsx)("span",{style:{fontSize:"11px"},children:")"})]})),Object(o.jsxs)("a",{href:e.link+"#code",className:"badge badge-code",children:[Object(o.jsx)("ion-icon",{name:"logo-github",role:"img",className:"md hydrated","aria-label":"logo github"})," Code ",t]})}}},{key:"resultsButton",value:function(e){if(1==e.has_evaluation_table_rows)return Object(o.jsxs)("a",{href:e.link+"#evaluation",className:"badge badge-results",children:[Object(o.jsx)("ion-icon",{name:"barcode-outline"})," Results"]})}},{key:"otherAuthors",value:function(e,t){if(e.length>1){if(e[0].full_name==t)return e.length<2?void 0:2==e.length?Object(o.jsxs)("span",{className:"additional",children:["with ",Object(o.jsx)("a",{href:e[1].link,children:e[1].full_name})]}):Object(o.jsxs)("span",{className:"additional",children:["with ",Object(o.jsx)("a",{href:e[1].link,children:e[1].full_name})," and ",Object(o.jsxs)("a",{"data-toggle":"modal","data-target":"#exampleModal",children:[e.length-2," others"]})]});return e.length<2?void 0:2==e.length?Object(o.jsxs)("span",{className:"additional",children:["with ",Object(o.jsx)("a",{href:"",children:t})]}):Object(o.jsxs)("span",{className:"additional",children:["with ",Object(o.jsx)("a",{href:"",children:t})," and ",Object(o.jsxs)("a",{"data-toggle":"modal","data-target":"#exampleModal",children:[e.length-2," others"]})]})}}},{key:"intersperse",value:function(e,t){return 0===e.length?[]:e.slice(1).reduce((function(e,a,n){return e.concat([t,a])}),[e[0]])}},{key:"componentDidMount",value:function(){var e=JSON.parse(document.getElementById("author-info-json").textContent),t=JSON.parse(document.getElementById("author-items-json").textContent);this.updateAuthorInfo(e),this.updateAuthorItems(t),window.addEventListener("scroll",this.handleScroll)}},{key:"componentDidUpdate",value:function(){window.MathJax&&window.MathJax.typeset&&window.MathJax.typeset()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll)}},{key:"authorNameLink",value:function(e){return e.link,this.state.authorLink,e.full_name}},{key:"render",value:function(){var e=this,t=this.state,a=t.items,n=t.loading,s=(t.loadMoreLoading,t.itemsCount),r=t.authorFullName,i=t.authorLink,l=t.authorThumbnail;return Object(o.jsxs)("div",{className:"author-page mb-4 w-100",children:[Object(o.jsxs)("div",{style:{position:"relative",minHeight:200},children:[n&&Object(o.jsx)("div",{className:"text-center",style:{backgroundColor:"rgba(255, 255, 255, 0.75)",zIndex:1,width:"100%",height:"100%",position:"absolute",top:0,left:0},children:Object(o.jsx)(f.a,{animation:"border",variant:"primary",style:{marginTop:75,width:"4rem",height:"4rem",borderWidth:"0.4em"}})}),a.map((function(t){return Object(o.jsxs)("div",{className:"status-update",children:[Object(o.jsx)("div",{className:"modal author-modal",id:"exampleModal",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(o.jsx)("div",{className:"modal-dialog author-dialog",role:"document",children:Object(o.jsx)("div",{className:"modal-content author-pop-up",children:e.intersperse(t.authors.map((function(e){return Object(o.jsxs)("div",{className:"row author-row",children:[Object(o.jsx)("div",{className:"col-lg-3",children:Object(o.jsx)("img",{src:e.author_thumbnail})}),Object(o.jsx)("div",{className:"col-lg-9 author-name",children:Object(o.jsx)("a",{href:e.link,children:e.full_name},e.id)})]})})))})})}),Object(o.jsxs)("div",{className:"row status-header center-mobile",children:[Object(o.jsx)("div",{className:"col-lg-1 status-header-image",children:Object(o.jsx)("a",{href:i,children:Object(o.jsx)("img",{src:l})})}),Object(o.jsxs)("div",{className:"col-lg-11 status-header-description",children:[Object(o.jsx)("a",{href:i,children:r})," ",Object(o.jsx)("div",{className:"additional",children:"published a paper"})," ",Object(o.jsx)("br",{}),Object(o.jsx)("div",{className:"text-muted",children:t.publishedDateString})]})]}),Object(o.jsxs)("div",{className:"row status-paper",children:[Object(o.jsx)("div",{className:"col-lg-4 status-paper-image",children:Object(o.jsx)("a",{href:t.link,children:Object(o.jsx)("img",{src:t.thumbnail})})}),Object(o.jsxs)("div",{className:"col-lg-8 status-paper-description",children:[Object(o.jsx)("h1",{children:Object(o.jsx)("a",{href:t.link,children:t.title})}),Object(o.jsx)("div",{className:"author-span",children:Object(o.jsx)(o.Fragment,{children:e.intersperse(t.authors.map((function(t){return Object(o.jsx)("a",{href:t.link,children:e.authorNameLink(t)},t.id)}))," \u2022 ")})}),Object(o.jsxs)("div",{className:"artefact-links",children:[Object(o.jsxs)("a",{href:t.link,className:"badge badge-paper",children:[Object(o.jsx)("ion-icon",{name:"document",role:"img",className:"md hydrated","aria-label":"document"})," Paper"]}),e.codeButton(t),e.resultsButton(t)]})]})]})]},t.id)}))]}),s>a.length&&Object(o.jsx)(m.a,{className:"justify-content-center",ref:this.loadMoreRef,children:Object(o.jsx)(f.a,{animation:"border",variant:"primary"})})]})}}]),a}(p.a.Component);t.default=S},362:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(1),r=a(17),i=a.n(r),l=a(44),c=(a(208),a(209),a(76)),o=a.n(c),d=a(107),u=a(26),h=a(5),b=a(21),j=a(8),p=a(22),m=[{path:"/conference/:slug",loader:function(){return Promise.all([a.e(0),a.e(2),a.e(5)]).then(a.bind(null,577))}},{path:"/newsletter",loader:function(){return Promise.all([a.e(0),a.e(2),a.e(10)]).then(a.bind(null,579))}},{path:"/newsletter/create",loader:function(){return Promise.all([a.e(0),a.e(3),a.e(8)]).then(a.bind(null,574))}},{path:"/newsletter/:id/edit",loader:function(){return Promise.all([a.e(0),a.e(3),a.e(9)]).then(a.bind(null,575))}},{path:"/example",loader:function(){return a.e(6).then(a.bind(null,576))}}];function f(){return Object(n.jsx)(p.c,{children:m.map((function(e){return Object(n.jsx)(p.a,{exact:!0,path:e.path,component:g.bind(null,e.loader)},e.path)}))})}function g(e){var t=Object(p.h)(),a=Object(j.a)(new URLSearchParams(Object(p.g)().search)).reduce((function(e,t){var a=Object(b.a)(t,2),n=a[0],s=a[1];return Object(h.a)(Object(h.a)({},e),{},Object(u.a)({},n,s))}),{}),r=Object(s.useState)(),i=Object(b.a)(r,2),l=i[0],c=i[1],m=Object(s.useState)(),f=Object(b.a)(m,2),g=f[0],v=f[1];return Object(s.useEffect)((function(){Object(d.a)(o.a.mark((function n(){var s;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e();case 2:if(s=n.sent.default,c((function(){return s})),n.t0=v,!s.getInitialProps){n.next=11;break}return n.next=8,s.getInitialProps({params:t,query:a});case 8:n.t1=n.sent,n.next=12;break;case 11:n.t1={};case 12:n.t2=n.t1,(0,n.t0)(n.t2);case 14:case"end":return n.stop()}}),n)})))()}),[]),l&&g?Object(n.jsx)(l,Object(h.a)({},g)):null}window.run_after_frontend_loaded=window.run_after_frontend_loaded||[],window.run_after_frontend_loaded.push((function(){var e=document.getElementById("root");e&&i.a.render(Object(n.jsx)(l.a,{children:Object(n.jsx)(f,{})}),e)}))}},[[362,11,13]]]);